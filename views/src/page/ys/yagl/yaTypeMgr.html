<!DOCTYPE html>
<html  class="iframe-h">
<head>
    <meta charset="UTF-8">
    <title>议案类型管理</title>
    <meta content="webkit" name="renderer"/>
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link class="favicon" href="./../../images/ico/favicon.ico" rel="shortcut icon" type="image/x-icon">
    <link class="favicon" href="./../../images/ico/favicon.ico" rel="icon" type="image/x-icon">
    <link class="favicon" href="./../../images/ico/favicon.ico" rel="bookmark" type="image/x-icon">
    <link rel="stylesheet" href="../../../js/layui/css/layui.css"/>
    <link href="../../../css/public.css?v1.01" rel="stylesheet"/>
    <link href="../../../js/lib/font-awesome/css/font-awesome.css" rel="stylesheet"/>
    <script src="../../../js/lib/jquery.1.12.3.js"></script>
    <style>
        .layui-table{
            width: 100%!important;
        }
        .adapt{
            margin-left:20%;
        }
    </style>
</head>
<!-- 已关联事项目录清单 新增/编辑 -->
<div class="bindItemListLayer hide">
        <div style="padding: 20px;overflow: hidden">
            <form style="margin-top: 20px;" action="" class="layui-form layui-form-pane">
                <div class="layui-row layui-col-space10">
                    <div class="layui-col-md12">
                        <div class="layui-form-item">
                            <label class="layui-form-label">目录名称</label>
                            <div class="layui-input-block">
                                <input type="text" name="index1" class="layui-input" placeholder="请输入">
                            </div>
                        </div>
                    </div>
                    <div class="layui-col-md12">
                        <div class="layui-form-item">
                                <label class="layui-form-label">清单名称</label>
                                <div class="layui-input-block">
                                    <input type="text" name="index2" required  lay-verify="required" placeholder="请输入" autocomplete="off" class="layui-input">
                                </div>
                        </div>
                    </div>
                <!-- <div class="layui-col-md12">
                    <div class="layui-form-item">
                        <label class="layui-form-label">序号</label>
                        <div class="layui-input-block">
                            <input type="text" name="title" required  lay-verify="required" placeholder="请输入序号" autocomplete="off" class="layui-input">
                        </div>
                    </div>
                </div> -->
                </div>
                <div class="layui-form-item adapt">
                            <div class="layui-input-block">
                                <button class="layui-btn" lay-submit lay-filter="formAdd">保存</button>
                                <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                                <!-- <button class="layui-btn layui-btn-primary" id="formClose">关闭</button> -->
                            </div>
                </div>
            </form>
        </div>
</div>
<!-- 议案类别新增/编辑弹窗 -->
<div class="yalbLayer hide">
        <div style="padding: 20px;overflow: hidden">
            <form style="margin-top: 20px;" action="" class="layui-form layui-form-pane">
                <div class="layui-row layui-col-space10">
                    <div class="layui-col-md12">
                        <div class="layui-form-item">
                            <label class="layui-form-label">类别名称</label>
                            <div class="layui-input-block">
                                <input type="text" name="index1" class="layui-input" placeholder="请输入名称">
                            </div>
                        </div>
                    </div>
                    <div class="layui-col-md12">
                            <div class="layui-form-item">
                                <label class="layui-form-label">是否启用</label>
                                <div class="layui-input-block">
                                    <select name="index3" id="suJobCode">
                                        <option value="">请选择</option>
                                        <option value="禁用">禁用</option>
                                        <option value="启用">启用</option>
                                    </select>
                                </div>
                            </div>
                    </div>
                    <div class="layui-col-md12">
                        <div class="layui-form-item">
                                <label class="layui-form-label">类别编码</label>
                                <div class="layui-input-block">
                                    <input type="text" name="index2" required  lay-verify="required" placeholder="请输入编码" autocomplete="off" class="layui-input">
                                </div>
                        </div>
                    </div>
                <!-- <div class="layui-col-md12">
                    <div class="layui-form-item">
                        <label class="layui-form-label">序号</label>
                        <div class="layui-input-block">
                            <input type="text" name="title" required  lay-verify="required" placeholder="请输入序号" autocomplete="off" class="layui-input">
                        </div>
                    </div>
                </div> -->
                </div>
                <div class="layui-form-item adapt">
                            <div class="layui-input-block">
                                <button class="layui-btn" lay-submit lay-filter="formAdd">保存</button>
                                <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                            </div>
                </div>
            </form>
        </div>
</div>
<!--议案类别管理-->
<body class="iframe-h">

<div class="content-wrap">
    <div class="layui-row layui-col-space15">
        <div class="layui-col-xs2 layui-col-sm2 layui-col-md2">

            <div class="layui-card" style="height:900px;">
                <div class="layui-card-header layui-card-header-custom"><span><i></i>议案类别树</span><div class="columnSide"><i class="fa fa-toggle-left"></i></div></div>
                <div class="layui-card-body">
                    <input type="text" placeholder="请输入关键字进行查询" autocomplete="off" class="layui-input eleTree-search">
                    <div class="eleTree ele4" id="leftTree"  lay-filter="leftTree"></div>
                </div>
            </div>
        </div>
        <div class="layui-col-xs10 layui-col-sm10 layui-col-md10">
            <div class="layui-card">
                <div class="layui-card-header layui-card-header-custom"><span><i></i>议案类别列表</span></div>
                <div class="layui-card-body">
                    <form action="" class="layui-form layui-form-pane">
                        <div class="layui-row layui-col-space10">

                            <div class="layui-col-xs4">
                                <div class="layui-form-item">
                                    <label class="layui-form-label">类别名称</label>
                                    <div class="layui-input-block">
                                        <input type="text" name="title" required  lay-verify="required" placeholder="请输入名称" autocomplete="off" class="layui-input">
                                    </div>
                                </div>
                            </div>
                            <div class="layui-col-xs4">
                                <div class="layui-form-item">
                                    <label class="layui-form-label">类别编码</label>
                                    <div class="layui-input-block">
                                        <input type="text" name="title" required  lay-verify="required" placeholder="请输入名称" autocomplete="off" class="layui-input">
                                    </div>
                                </div>
                            </div>
                            <div class="toggle-area layui-col-space10">
                                <div class="layui-col-xs4">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label">启用状态</label>
                                        <div class="layui-input-block">
                                            <!-- <input checked name="suSex" title="启用" type="radio" value="1">
                                            <input name="suSex" title="禁止" type="radio" value="0"> -->
                                            <select name="suSex" id="suSex_find">
                                                <option value="">请选择</option>
                                                <option value="0">禁用</option>
                                                <option value="1">启用</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-col-xs4">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label">创建时间</label>
                                        <div class="layui-input-block">
                                            <input class="layui-input" id="date1" type="text">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- <div class=" " style="text-align:center;margin-bottom: 5px;padding-left: 20px;">
                                <button class="layui-btn" lay-submit lay-filter="formSearch"><i class="fa fa-search"></i>查询</button>
                                <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                                <a class="toggle-btn">
                                    <span>展开</span>
                                    <i class="fa fa-angle-up"></i>
                                </a>
                            </div> -->
                            <div class=""
                                 style="text-align: center; margin-bottom: 5px;position: absolute;width: 33%;right: 0;bottom: 8px;">
                                <div class="layui-input-inline" style="padding-left: 20px">
                                    <button name="searchSubmit" class="layui-btn  " lay-submit="" lay-filter="formSearch" >查询</button>
                                    <button name="reset" lay-filter="reset" type="reset" class="layui-btn layui-btn-primary  ">重置</button>
                                    <a class="toggle-btn">
                                    <span>展开</span><i class="fa fa-angle-up"></i></a>
                                </div>
                            </div>
                            <!-- <div class="" style="text-align: left;margin-bottom: 5px">
                                    <div class="layui-input-inline" style="padding-left: 20px">
                                        <button name="searchSubmit" class="layui-btn  " lay-submit="" lay-filter="searchSubmit"><i class="fa fa-search"></i>查询</button>
                                        <button name="reset" lay-filter="reset" type="reset" class="layui-btn layui-btn-primary  ">重置</button>
                                        <a class="toggle-btn">
                                                <span>展开</span>
                                                <i class="fa fa-angle-up"></i>
                                            </a>
                                    </div>
                            </div> -->
                        </div>
                    </form>
                </div>
            </div>
            <div class="layui-card" >
                <div class="layui-card-body" style="padding-top: 0">

                    <table id="table1" lay-filter="table1"></table>
                    <script type="text/html" id="tableToolBar">
                        <div class="layui-btn-container">
                            <button class="layui-btn layui-btn-sm" lay-event="add1">
                                <i class="layui-icon">&#xe608;</i>新增
                            </button>
                            <button class="layui-btn layui-btn-sm layui-btn-danger" lay-event="delete">
                                <i class="layui-icon">&#xe640;</i> 删除
                            </button>
                        </div>
                    </script>

                    <script type="text/html" id="tableOper">
                        <a class="layui-btn layui-btn-xs" lay-event="edit1">编辑</a>
                        <a class="layui-btn layui-btn-xs layui-btn-danger" lay-event="singleDel">删除</a>
                        <a class="layui-btn layui-btn-xs" lay-event="edit3">关联事项清单</a>
                        <a class="layui-btn layui-btn-xs" lay-event="edit4">查看事项清单</a>
                    </script>

                </div>

            </div>
        </div>
    </div>
</div>
<script type="text/html" class="layer1">
    <div class="layui-row layui-col-space15">
        <div class="layui-col-xs2 layui-col-sm2 layui-col-md2">

            <div class="layui-card" style="height: 500px">
                <div class="layui-card-header layui-card-header-custom"><span><i></i>事项目录清单</span></div>
                <div class="layui-card-body" style="width: 100%">
                    <div class="eleTree ele4" id="leftTree1"  lay-filter="leftTree"></div>
                </div>
            </div>
        </div>
        <div class="layui-col-xs10 layui-col-sm10 layui-col-md10">
            <div class="layui-card" style="margin-top: 10px">
                <div class="layui-card-header layui-card-header-custom">
                    <span><i></i>已关联事项目录清单</span>
                </div>
                <div class="layui-card-body" style="width: 100%">
                    <table id="table2" lay-filter="table2" style="width: 100%!important"></table>
                </div>
                <div class="layui-col-md8 " style="text-align: left;margin-left: 10px">
                    <button class="layui-btn">保存</button>
                </div>
            </div>
        </div>
    </div>
</script>
<script type="text/html" id="tableToolBarBindDirList">
    <div class="layui-btn-container">
        <button class="layui-btn layui-btn-sm" lay-event="add_bindDirList">
            <i class="layui-icon">&#xe608;</i>新增
        </button>
        <button class="layui-btn layui-btn-sm layui-btn-danger" lay-event="delete_bindDirList">
            <i class="layui-icon">&#xe640;</i> 删除
        </button>
    </div>
</script>
<script type="text/html" id="tableOperBindDirList">
    <a class="layui-btn layui-btn-xs layui-btn-danger" lay-event="singleDel_bindDirList">删除</a>
</script>
<script src="./../../../../src/js/layui/layui.js"></script>
<script src="../../../js/lib/echarts-4.1.0.min.js" charset="utf-8"></script>
<script src="../../../js/lib/echartTheme.js" charset="utf-8"></script>
<script>
    layui.config({
        base: '../../../../src/js/',
        version: new Date().getTime()
    }).extend({
        custom:'common/custom'
    }).use(['layer','eleTree','table','form','laytpl','element','custom','laydate'],function () {
        var table=layui.table;
        var form=layui.form;
        var common=layui.common;
        var element = layui.element;
        var tree = layui.eleTree;
        var laydate = layui.laydate;

        laydate.render({
            elem: '#date1' //指定元素
            ,trigger: 'click'
        });
        common.toggleArea($('.toggle-btn'),$('.toggle-area'));
        element.init();
        var baseUrl='../../../../';

        common.themeSet();
        var eleTreeId=tree.render({
            elem: '#leftTree',
            data: [{'name':'投资管理1'},{'name':'投资管理2'}],
            showCheckbox: false,
            lazy: true,
            load: function(data,callback) {
                callback([{'name':'投资计划'},{'name':'投资立项'}])
            }
        });
        $(".eleTree-search").on("change",function() {
            eleTreeId.search($(this).val());
        });
        var resData=[
        {
                    "index1":'HUIYI-1',
                    "index2":'code1',
                    "index3":'禁用',//禁用
                    "index4":"2019-03-12 00:00:00",
                    "index5":"否"
                },
                {
                    "index1":'HUIYI-2',
                    "index2":'code2',
                    "index3":'启用',//启用
                    "index4":"2019-03-12 00:00:00",
                    "index5":"是"
                }
        ];
        table.render(common.tableInitParams({
            elem: '#table1',
            height:'full-170',
            data:resData,
            // method:'post',
            toolbar:'#tableToolBar',
            cols: [
                [
                    {type:'checkbox'},
                    {type:'numbers',title:'序号',align:'center'},
                    {field: 'index1', title: '类别名称', sort: true},
                    {field: 'index2', title: '类别编码', sort: true},
                    {field: 'index3', title: '启用状态', sort: true,template: function(rowData){
                        if(rowData['index3'] == '1'){
                            return '<span class="layui-badge" style="background-color:#66c33a">启用</span>'
                        }else{
                            return '<span class="layui-badge" style="background-color:#f56c6c">禁用</span>'
                        }
                     }
                    },
                    // {field: 'index5', title: '是否关联事项清单', sort: true,template: function(rowData){
                    //     debugger
                    //     return rowData['index5'] === '1'?'是':'否';
                    //  }
                    // },
                    {field: 'index4', title: '创建时间',minWidth:180, sort: true},
                    {field: 'index5', title: '是否关联事项清单',minWidth:180, sort: true},
                    {field: '', title: '操作', width: 350, toolbar:'#tableOper',fixed: 'right'},
                ]
            ]
        }));

        //table监听事件
        table.on('toolbar(table1)',function (obj) {
            var checkStatus = table.checkStatus(obj.config.id);
            switch(obj.event){

                case 'add1':
                    layer.open({
                        offset: '10px',
                        title:'新增',
                        maxmin: false,
                        type: 1,//页面层
                        area: ['580px'],//高度自适应
                        shadeClose: false,
                        content:$('.yalbLayer').html(),
                        success:function(obj){
                            form.render();
                            form.on('submit(formAdd)', function (obj) {
                                layer.msg('演示 已新增');
                                return false;
                                var params = obj.field;
                                var layerLoader =common.layerLoader();
                                common.fetchPost('flowEngine/engine/TemplateAction?method=createTemplate&tableName=FLOW_MODEL_TEMPLATE&orgId=' + currentEnterpriseId,
                                    params, function (data) {
                                    layer.close(layerLoader);
                                    //表格重载
                                    if(data.success){
                                        eventHandle.tableReload();
                                        layer.msg('新增成功')
                                        layer.close(mainMenu);
                                    }else{
                                        layer.msg(data.resultMessage);
                                    }

                                }, function () {
                                    layer.close(layerLoader);
                                    layer.msg('新增失败');//失败后提示
                                    // layer.close(layer.index);
                                });
                                return false;
                            });
                        }
                    });
                    break;
                    case 'delete':
                    //点击删除按钮
                    if(checkStatus.data.length>0){
                        layer.confirm('确定删除选中列?', {icon: 3, title:'提示',offset: '150px'}, function(index){
                            layer.msg('演示 已删除');
                            return false;
                            var smIdArr=[];

                            for(var i=0;i<checkStatus.data.length;i++){
                                smIdArr.push(checkStatus.data[i]['spIds'])
                            }
                            var layerLoader =common.layerLoader();
                            common.fetchPost('sysmgr/sysPath/deleteSysPathByIds?spIds='+smIdArr.join(','),null,function () {
                                layer.close(layerLoader);
                                eventHandle.tableReload();
                                layer.msg('删除成功');
                            },function () {
                                layer.close(layerLoader);
                            });

                            layer.close(index);
                        });
                    }else{
                        layer.msg('请选择删除列')
                    }
                    break;
            }
        });


        table.on('tool(table1)',function (obj) {
            var data = obj.data;
            switch(obj.event){
                case 'edit1':
                var index_edit=layer.open({
                        offset: '10px',
                        title:'编辑',
                        maxmin: false,
                        type: 1,//页面层
                        area: ['580px'],//高度自适应
                        // area: ['580px'],//高度自适应
                        content: $('.yalbLayer').html(),//加载该区域的html
                        success:function (obj) {
                            //初始化表格
                            form.render();
                            $(obj.selector).find('input[name=index1]').val(data.index1);
                            $(obj.selector).find('input[name=index2]').val(data.index2);
                            $(obj.selector).find('input[name=index3]').val(data.index2);
                            // form.render('select');

                            form.on('submit(formAdd)', function (obj) {
                                layer.msg('已编辑');
                                return false;
                                var params = {
                                    ggSort: obj.field.ggSort,
                                    smCode: obj.field.smCode,
                                    smIcon: obj.field.smIcon,
                                    smId: data.smId,
                                    smLinkType: obj.field.smLinkType,
                                    smName: obj.field.smName,
                                    smPid: data.smPid,
                                    smPidAll: data.smPidAll,
                                    smType: obj.field.smType,
                                    smUrl: obj.field.smUrl,
                                    smRemark: obj.field.smRemark,
                                };
                                var layerLoader =common.layerLoader();
                                common.fetchPost('sysmgr/menu/saveSysMenu', params, function (res) {
                                    layer.close(layerLoader);
                                    if(res.success){
                                        layer.close(index_edit);
                                        eventHandle.treeReload();
                                        eventHandle.tableReload(currentTableId);
                                        eventHandle.reloadMenu2Redis();//异步重新加载菜单与权限关系至Redis。
                                    }
                                }, function () {
                                    layer.msg('修改失败');//失败后提示
                                    layer.close(layerLoader);
                                    layer.close(index_edit);
                                });
                                return false;
                            });
                        }
                    });
                    break;
                    case 'singleDel':
                layer.confirm('确定删除?', {icon: 3, title: '提示', offset: '150px'}, function (index) {
                    layer.msg('已删除');
                    return false
                var layerLoader = common.layerLoader();
                common.fetchDelete('sysmgr/commonIndicator/commonIndicator/'+data.ccfId,function () {
                    layer.close(layerLoader);
                    eventHandle.tableReload();
                    layer.msg('删除成功');
                }, function () {
                    layer.close(layerLoader);
                });
                layer.close(index);
            });
                break;
                case 'edit3':
                    var layere=layer.open({
                        offset: '1px',
                        title:'详情',
                        maxmin: false,
                        type: 1,//页面层
                        area: ['600px','380px'],//高度自适应
                        shadeClose: false,
                        content:$('.layer1').html(),
                        success:function(obj){

                            tree.render({
                                elem: $(obj.selector).find('#leftTree1'),
                                data: [{'name': '中国有色集团'}, {'name': '集团'}],
                                showCheckbox: true,
                                lazy: true,
                                done:function(data){

                                },
                                load: function(data,callback) {
                                    callback([{'name':'二级1'},{'name':'二级2'}])
                                }
                            });

                            table.render(common.tableInitParams({
                                elem: $(obj.selector).find('#table2'),
                                height:'350',
                                data:[
                                    {
                                        "index1":'HUIYI-1',
                                        "index2":'code1',
                                        "index3":'0',//禁用
                                        "index4":"2019-03-12 00:00:00"
                                    },
                                    {
                                        "index1":'HUIYI-2',
                                        "index2":'code2',
                                        "index3":'1',//启用
                                        "index4":"2019-03-12 00:00:00"
                                    }
                                ],
                                method:'post',
                                toolbar:'#tableToolBarBindDirList',
                                cols: [
                                    [
                                        {type:'checkbox'},
                                        {type:'numbers',title:'序号'},
                                        {field: 'index1', title: '目录名称', sort: true},
                                        {field: 'index2', title: '清单名称', sort: true},
                                        {field: '', title: '操作', toolbar:'#tableOperBindDirList',fixed: 'right'},
                                    ]
                                ]
                            }));
                        }
                    });
                    layer.full(layere);
                    break;
                case 'edit4':
                    var layere=layer.open({
                        offset: '1px',
                        title:'详情',
                        maxmin: false,
                        type: 1,//页面层
                        area: ['600px','380px'],//高度自适应
                        shadeClose: false,
                        content:$('.layer1').html(),
                        success:function(obj){

                            tree.render({
                                elem: $(obj.selector).find('#leftTree1'),
                                data: [{'name': '中国有色集团'}, {'name': '集团'}],
                                showCheckbox: true,
                                lazy: true,
                                done:function(data){

                                },
                                load: function(data,callback) {
                                    callback([{'name':'二级1'},{'name':'二级2'}])
                                }
                            });

                            table.render(common.tableInitParams({
                                elem: $(obj.selector).find('#table2'),
                                height:'350',
                                data:[
                                    {
                                        "index1":'HUIYI-1',
                                        "index2":'code1',
                                        "index3":'0',//禁用
                                        "index4":"2019-03-12 00:00:00"
                                    },
                                    {
                                        "index1":'HUIYI-2',
                                        "index2":'code2',
                                        "index3":'1',//启用
                                        "index4":"2019-03-12 00:00:00"
                                    }
                                ],
                                method:'post',
                                toolbar:'#tableToolBarBindDirList',
                                cols: [
                                    [
                                        {type:'checkbox'},
                                        {type:'numbers',title:'序号'},
                                        {field: 'index1', title: '目录名称', sort: true},
                                        {field: 'index2', title: '清单名称', sort: true},
                                        {field: '', title: '操作', toolbar:'#tableOperBindDirList',fixed: 'right'},
                                    ]
                                ]
                            }));
                        }
                    });
                    layer.full(layere);
                    break;
            }
        });
          //table监听事件
          table.on('tool(table2)',function (obj) {
            var data = obj.data;
            switch(obj.event){
                case 'edit1':
                var index_edit=layer.open({
                        offset: '10px',
                        title:'编辑',
                        maxmin: false,
                        type: 1,//页面层
                        area: ['580px'],//高度自适应
                        // area: ['580px'],//高度自适应
                        content: $('.yalbLayer').html(),//加载该区域的html
                        success:function (obj) {
                            //初始化表格
                            form.render();
                            $(obj.selector).find('input[name=index1]').val(data.index1);
                            $(obj.selector).find('input[name=index2]').val(data.index2);
                            $(obj.selector).find('input[name=index3]').val(data.index2);
                            // form.render('select');

                            form.on('submit(formAdd)', function (obj) {
                                layer.msg('已编辑');
                                return false;
                                var params = {
                                    ggSort: obj.field.ggSort,
                                    smCode: obj.field.smCode,
                                    smIcon: obj.field.smIcon,
                                    smId: data.smId,
                                    smLinkType: obj.field.smLinkType,
                                    smName: obj.field.smName,
                                    smPid: data.smPid,
                                    smPidAll: data.smPidAll,
                                    smType: obj.field.smType,
                                    smUrl: obj.field.smUrl,
                                    smRemark: obj.field.smRemark,
                                };
                                var layerLoader =common.layerLoader();
                                common.fetchPost('sysmgr/menu/saveSysMenu', params, function (res) {
                                    layer.close(layerLoader);
                                    if(res.success){
                                        layer.close(index_edit);
                                        eventHandle.treeReload();
                                        eventHandle.tableReload(currentTableId);
                                        eventHandle.reloadMenu2Redis();//异步重新加载菜单与权限关系至Redis。
                                    }
                                }, function () {
                                    layer.msg('修改失败');//失败后提示
                                    layer.close(layerLoader);
                                    layer.close(index_edit);
                                });
                                return false;
                            });
                        }
                    });
                    break;
                    case 'singleDel_bindDirList':
                layer.confirm('确定删除?', {icon: 3, title: '提示', offset: '150px'}, function (index) {
                    layer.msg('演示 已删除');
                    return false
                var layerLoader = common.layerLoader();
                common.fetchDelete('sysmgr/commonIndicator/commonIndicator/'+data.ccfId,function () {
                    layer.close(layerLoader);
                    eventHandle.tableReload();
                    layer.msg('删除成功');
                }, function () {
                    layer.close(layerLoader);
                });
                layer.close(index);
            });
                break;
                case 'edit3':
                    var layere=layer.open({
                        offset: '1px',
                        title:'详情',
                        maxmin: false,
                        type: 1,//页面层
                        area: ['600px','380px'],//高度自适应
                        shadeClose: false,
                        content:$('.layer1').html(),
                        success:function(obj){

                            tree.render({
                                elem: $(obj.selector).find('#leftTree1'),
                                data: [{'name': '中国有色集团'}, {'name': '集团'}],
                                showCheckbox: true,
                                lazy: true,
                                done:function(data){

                                },
                                load: function(data,callback) {
                                    callback([{'name':'二级1'},{'name':'二级2'}])
                                }
                            });

                            table.render(common.tableInitParams({
                                elem: $(obj.selector).find('#table2'),
                                height:'350',
                                data:[
                                    {
                                        "index1":'HUIYI-1',
                                        "index2":'code1',
                                        "index3":'0',//禁用
                                        "index4":"2019-03-12 00:00:00"
                                    },
                                    {
                                        "index1":'HUIYI-2',
                                        "index2":'code2',
                                        "index3":'1',//启用
                                        "index4":"2019-03-12 00:00:00"
                                    }
                                ],
                                method:'post',
                                toolbar:'#tableToolBarBindDirList',
                                cols: [
                                    [
                                        {type:'checkbox'},
                                        {type:'numbers',title:'序号'},
                                        {field: 'index1', title: '目录名称', sort: true},
                                        {field: 'index2', title: '清单名称', sort: true},
                                        {field: '', title: '操作', toolbar:'#tableOperBindDirList',fixed: 'right'},
                                    ]
                                ]
                            }));
                        }
                    });
                    layer.full(layere);
                    break;
            }
        });
          table.on('toolbar(table2)',function (obj) {
            var checkStatus = table.checkStatus(obj.config.id);
            switch(obj.event){

                case 'add_bindDirList':
                    layer.open({
                        offset: '10px',
                        title:'新增',
                        maxmin: false,
                        type: 1,//页面层
                        area: ['580px'],//高度自适应
                        shadeClose: false,
                        content:$('.bindItemListLayer').html(),
                        success:function(obj){
                            form.render();
                            form.on('submit(formAdd)', function (obj) {
                                layer.msg('演示 已新增');
                                return false;
                                var params = obj.field;
                                var layerLoader =common.layerLoader();
                                common.fetchPost('flowEngine/engine/TemplateAction?method=createTemplate&tableName=FLOW_MODEL_TEMPLATE&orgId=' + currentEnterpriseId,
                                    params, function (data) {
                                    layer.close(layerLoader);
                                    //表格重载
                                    if(data.success){
                                        eventHandle.tableReload();
                                        layer.msg('新增成功')
                                        layer.close(mainMenu);
                                    }else{
                                        layer.msg(data.resultMessage);
                                    }

                                }, function () {
                                    layer.close(layerLoader);
                                    layer.msg('新增失败');//失败后提示
                                    // layer.close(layer.index);
                                });
                                return false;
                            });
                        }
                    });
                    break;
                    case 'delete_bindDirList':
                    //点击删除按钮
                    if(checkStatus.data.length>0){
                        layer.confirm('确定删除选中列?', {icon: 3, title:'提示',offset: '150px'}, function(index){
                            layer.msg('演示 已删除');
                            return false;
                            var smIdArr=[];

                            for(var i=0;i<checkStatus.data.length;i++){
                                smIdArr.push(checkStatus.data[i]['spIds'])
                            }
                            var layerLoader =common.layerLoader();
                            common.fetchPost('sysmgr/sysPath/deleteSysPathByIds?spIds='+smIdArr.join(','),null,function () {
                                layer.close(layerLoader);
                                eventHandle.tableReload();
                                layer.msg('删除成功');
                            },function () {
                                layer.close(layerLoader);
                            });

                            layer.close(index);
                        });
                    }else{
                        layer.msg('请选择删除列')
                    }
                    break;
            }
        });
         //查询
        form.on('submit(formSearch)', function (obj) {
            layer.msg('演示 已查询');
            return false;
            //表格重载
            table.reload('table1', {
                url: baseUrl + 'sysmgr/contentApply/queryContentApplyPage/',
                method: 'post',
                page: {
                    curr: 1
                },
                where: {
                    caApplyType : obj.field.caApplyType,
                    caApplyContent : obj.field.caApplyContent,
                    ggAuditType : obj.field.ggAuditType,
                    caApplyUnitname : obj.field.caApplyUnitname
                },
            });
            return false;
        });
        common.columnSide();

    });

</script>

<!--[if lt IE 9]>
<script src="../../../js/lib/html5.min.js"></script>
<script src="../../../js/lib/respond.js"></script>
<![endif]-->
</body>
</html>
