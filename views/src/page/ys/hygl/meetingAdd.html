<!DOCTYPE html>
<html class="iframe-h">

<head>
    <meta charset="UTF-8">
    <title>会议管理-新增</title>
    <meta content="webkit" name="renderer" />
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link class="favicon" href="./../../../../src/images/ico/favicon.ico" rel="shortcut icon"
        type="image/x-icon">
    <link class="favicon" href="./../../../../src/images/ico/favicon.ico" rel="icon" type="image/x-icon">
    <link class="favicon" href="./../../../../src/images/ico/favicon.ico" rel="bookmark" type="image/x-icon">
    <link rel="stylesheet" href="./../../../../src/js/layui/css/layui.css" />
    <link href="./../../../../src/css/public.css?v1.01" rel="stylesheet" />
    <link href="./../../../../src/js/lib/font-awesome/css/font-awesome.css" rel="stylesheet" />
    <script src="./../../../../src/js/lib/jquery.1.12.3.js"></script>
    <style>
        body {
            background: #f8f8f8;
        }

        .load-btn,
        .check-btn,
        .right-btn {
            position: absolute;
            top: 0;
            right: 0;
            border-radius: 3px;
        }

        /* .layui-layer-btn0{
            position: relative;
            top: -12px;
        } */
        .right70 {
            right: 70px;
        }

        .relative {
            position: relative;
        }

        .padRt64 {
            padding-right: 64px;
        }

        li {
            cursor: pointer;
        }

        .zsBga {
            color: purple;
            vertical-align: 1px;
            opacity: 0.5;
        }

        .hytitle {
            font-size: 16px;
        }

        .hyinput {
            border: 1px solid transparent !important;
            border-bottom-color: red !important;
        }

        .layui-unselect {
            border-color: #f56c6c;
            border-top-style: none;
            border-right-style: none;
            border-left-style: none;
        }

        .layui-form-select .layui-edge {
            border-top-color: #f56c6c;
        }

        a.layui-layer-ico.layui-layer-max {
            display: none;
        }

        a.layui-layer-ico.layui-layer-max.layui-layer-maxmin {
            display: inline-block !important;
        }

        th>div {
            text-align: center;
        }

        .layui-table-body,
        .layui-table-body .layui-none {
            border-bottom: 1px solid #e6e6e6;
        }

        .layui-colla-content {
            padding: 0;
        }

        .reasonDiv {
            border: 1px solid #999;
            padding-left: 10px;
            border-top: none;
        }

        .reasonDiv>div {
            line-height: 36px;
        }

        /* .editView{
            display: none;
        } */


        /* 防止下拉框下拉值被遮盖*/
        .layui-table-view[lay-id="bjTable"] tbody tr td:nth-of-type(7)  .layui-table-cell {
            overflow: visible !important;
        }

        #bjTable .layui-table-box {
            overflow: visible !important;
        }


        /* 调整高度 */
        td .layui-form-select {
            margin-top: -10px !important;
            margin-left: -15px !important;
            margin-right: -15px !important;
        }

        .layui-form-selected dl {
            /* position: absolute; */
            z-index: 999999 !important;
            /* top: -10px; */
        }

        /* .moduleBox td {
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        } */
    </style>

</head>
<!-- 新增出席股东 -->
<script type="text/html" class="changeShareholderLayer hide">
    <div style="padding: 15px 20px">
        <div class="layui-row layui-col-space15">
            <input type="hidden" id="newShareholderName" value="">
            <input type="hidden" id="newShareholderId" value="">
            <div class="layui-col-xs12 layui-col-sm12 layui-col-md12">
                <!-- layui tree-->
                <div class="layui-card">
                    <div class="layui-card-body">
                        <ul id="changeShareholderTree" lay-filter="changeShareholderTree" class="eleTree"
                            style="overflow: hidden;"></ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</script>
<!--审议情况-编辑-->
<script type="text/html" id="edit-syForm">
    <div  class="edit-syForm">
        <div class="layui-card-body">
            <form class="layui-form form-theme3" name="edit-syForm">
                <div class="layui-card">
                    <div class="layui-card-header layui-card-header-custom">
                    <span><i></i>审议信息
                        <b class="zsBga"></b>
                    </span>
                    </div>
                    <div class="layui-card-body">
                        <div class="layui-row layui-col-space15">
                            <div class="layui-col-md12">
                                <div class="layui-form-item">
                                    <label class="layui-form-label"><b class="red">*</b>议题名称</label>
                                    <div class="layui-input-block" style="padding-right:80px;position:relative">
                                        <input type="text" lay-verify="subjectName" name="subjectName" placeholder="请输入" autocomplete="off"  class="layui-input hyinput" readonly>
                                        <button class="layui-btn" type="button" id="yaView" style="position:absolute;right:0;top:5px;"><i class="fa fa-search" aria-hidden="true"></i> 详情
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <input type="hidden" name="subjectId">
                            <input type="hidden" readonly name="subjectCode" placeholder="请输入" autocomplete="off" class="layui-input hyinput">

                            <!-- <div class="layui-col-md6">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label">紧急程度</label>
                                        <div class="layui-input-block">
                                            <select name="exigence"  id="exigence" lay-filter="exigenceFilter">
                                                <option name="" value=""></option>
                                            </select>
                                        </div>
                                    </div>
                                </div>-->
                        </div>
                        <div class="layui-row layui-col-space15">
                            <input type="hidden" name="exigenceName">
                            <div class="layui-col-md6">
                                <div class="layui-form-item" id="titleOption" title="显示title">
                                    <label class="layui-form-label">审议类型</label>
									<div class="layui-input-block" title="此信息为议案填写部门编辑选择，需要编辑请通知议案编辑人员">
                                        <input type="text" lay-verify="deliberationName" id="deliberationName" name="deliberationName"  autocomplete="off" class="layui-input hyinput" readonly>
                                    </div>
                                </div>
                            </div>
                            <input type="hidden" name="deliberationName">
                            <div class="layui-col-md6">
                                <div class="layui-form-item">
                                    <label class="layui-form-label">决议类别</label>
                                    <div class="layui-input-block">
                                        <select name="resultType"  id="resultType" lay-filter="resultTypeFilter">
                                            <option name="" value=""></option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <input type="hidden" name="resultTypeName">
                            <!-- <div class="layui-col-md12">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label"><b class="red">*</b>是否上报国资委</label>
                                        <div class="layui-input-block">
                                            <select name="approvalFlag"  id="approvalFlag" lay-verify="approvalFlag" lay-filter="approvalFlagFilter">
                                                <option name="" value=""></option>
                                            </select>
                                        </div>
                                    </div>
                            </div>
                            <input type="hidden" name="approvalFlagName">-->
                        </div>
                        <div class="layui-row layui-col-space15">
                            <div class="layui-col-md12">
                                <div class="layui-form-item">
                                    <label class="layui-form-label">汇报人</label>
                                    <div class="layui-input-block">
                                        <input type="text" name="msSpeaker" id="msSpeaker" placeholder="请输入" autocomplete="off" class="layui-input hyinput" readonly="readonly"
                                               value="">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-row layui-col-space15">
                            <div class="layui-col-md12">
                                <div class="layui-form-item relative">
                                    <label class="layui-form-label">列席人员</label>
                                    <div class="layui-input-block">
                                        <input type="text" readonly id="attendances" name="attendances" placeholder="请输入" autocomplete="off" class="layui-input padRt64 hyinput"
                                               value="" lay-verify="attendances">
                                        <!--<button class="layui-btn layui-btn-radius right-btn" id="attendances-btn">编辑</button>-->
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-row layui-col-space15">
                            <div class="layui-col-md12" id="syjg">
                                <div class="layui-form-item">
                                    <label class="layui-form-label"><b class="red">*</b>审议结果</label>
                                    <div class="layui-input-block">
                                        <select name="passFlag" id="passFlag" lay-filter="passFlagFilter" lay-verify="passFlag">
                                            <option name="" value=""></option>
                                        </select>
                                    </div>
                                </div>
                                <input type="hidden" name="passFlagName">
                            </div>
                            <div class="layui-row layui-col-space15">
                                <div class="layui-col-md12">
                                    <div class="layui-form-item">
                                        <div class="layui-form-item">
                                            <label class="layui-form-label"><b class="red">*</b>审议结论</label>
                                            <div class="layui-input-block">
                                                <textarea name="subjectResult" lay-verify="subjectResult" placeholder="请输入" class="layui-textarea hyinput"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div style="display: none">
                    <div class="layui-card" style="margin-top: 10px">
                        <div class="layui-card-body">
                            <div class="layui-form-item" style="text-align: center;">
                                <button class="layui-btn" lay-submit lay-filter="formSubjectEdit"> <i class="layui-icon">&#x1005;</i>保存</button>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
            <div class="layui-card" >
                <div class="layui-card-header layui-card-header-custom hide">
                    <span><i></i>表决详情
                        <b class="zsBga"></b>
                    </span>
                </div>
                <div class="layui-card-body">
                    <span id="bjxq" >
                        <div class="layui-row layui-col-space15" >
                            <div class="layui-col-md12">
                                <div class="layui-form-item">
                                    <label class="layui-form-label hylabel layui-col-md2" style="width:130px;">表决情况</label>
                                    <div class="layui-input-block">
                                        <input type="text" readonly name="bjqk" placeholder="根据下方列表自动生成" autocomplete="off" class="layui-input hyinput">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-row layui-col-space15" style="padding-left:130px;">
                            <div class="layui-col-md12">
                                <table id="bjTable" lay-filter="bjTable"></table>
                            </div>
                        </div>
                    </span>
                    
                    <div class="layui-row layui-col-space15" >
                        <div class="layui-col-md1" style="width:155px;padding-left:36px;">
                            <div class="layui-form-item">
                                <label class="layui-form-label hylabel layui-col-md2">相关附件</label>
                            </div>
                        </div>
                        <div class="layui-col-md12" style="padding-left:135px;position:relative;top:-50px;">
                            <table id="subjectFileTable" lay-filter="subjectFileTable"></table>
                        </div>
                    </div>
                </div>
            </div>
            
        </div>
    </div>
</script>
<script type="text/html" id="deliberationToolBar">
    <div class="layui-btn-container">
        <button class="layui-btn layui-btn-sm"  lay-event="add">
            <i class="layui-icon">&#xe608;</i> 新增
        </button>
        <button class="layui-btn layui-btn-sm layui-btn-danger"  lay-event="del">
            <i class="layui-icon">&#xe640;</i> 删除
        </button>
    </div>
</script>
<script type="text/html" id="bjTableOper">
    <a class="layui-btn layui-btn-xs"  lay-event="edit">编辑</a>
</script>
<script type="text/html" id="subjectFileToolBar">
    <div class="layui-btn-container" style="position:relative;">
        <button class="layui-btn layui-btn-sm"  lay-event="add">
            <i class="layui-icon">&#xe608;</i> 新增
        </button>
        <button class="layui-btn layui-btn-sm layui-btn-danger"  lay-event="del">
            <i class="layui-icon">&#xe640;</i> 删除
        </button>
        <span style="position:absolute;right:-130px">
            <button class="layui-btn layui-btn-primary layui-btn-sm"  lay-event="up">
                <i class="layui-icon">&#xe619;</i> 向上
            </button>
            <button class="layui-btn layui-btn-primary layui-btn-sm"  lay-event="down">
                <i class="layui-icon">&#xe61a;</i> 向下
            </button>
        </span>
    </div>
</script>
<script type="text/html" id="subjectFileTableOper">
    <a class="layui-btn layui-btn-xs" lay-event="load">预览</a>
</script>
<!--列席人员选择-->
<div class="set-attendanceForm hide">
    <div class="layui-card-body">
        <table id="attendanceTable" lay-filter="attendanceTable"></table>
        <script type="text/html" id="attendanceToolBar">
            <div class="layui-btn-container">
                <button class="layui-btn layui-btn-sm"  lay-event="add">
                    <i class="layui-icon">&#xe608;</i> 新增
                </button>
                <button class="layui-btn layui-btn-sm  layui-btn-danger"  lay-event="del">
                    <i class="layui-icon">&#xe640;</i> 删除
                </button>
            </div>
        </script>
    </div>
</div>
<!--列席人员选择-添加-->
<div class="setAdd-attendanceForm hide">
    <div class="layui-card-body">
        <form class="layui-form form-theme3" name="setAdd-attendanceForm">
            <div class="layui-row layui-col-space15">
                <div class="layui-col-md12">
                    <div class="layui-form-item">
                        <label class="layui-form-label"><b class="red">*</b>列席人</label>
                        <div class="layui-input-block">
                            <input type="text" id="attendanceName" lay-verify="required" name="attendanceName"
                                placeholder="请输入" autocomplete="off" class="layui-input hyinput">
                        </div>
                    </div>
                </div>
                <div class="layui-col-md12">
                    <div class="layui-form-item">
                        <label class="layui-form-label">职位</label>
                        <div class="layui-input-block">
                            <select name="position" id="position" lay-filter="positionFilter">
                                <option name="" value=""></option>
                            </select>
                        </div>
                    </div>
                    <input type="hidden" name="positionName">
                </div>
                <div style="display: none">
                    <div class="layui-card" style="margin-top: 10px">
                        <div class="layui-card-body">
                            <div class="layui-form-item" style="text-align: center;">
                                <button class="layui-btn" lay-submit lay-filter="formAttendanceAdd"
                                    id="formAttendanceAdd"> <i class="layui-icon">&#x1005;</i>保存</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>
<!--出席人员选择-->
<div class="set-attendeeForm hide">
    <div class="layui-card-body">
        <table id="attendeeTable" lay-filter="attendeeTable"></table>
        <script type="text/html" id="attendeeToolBar">
            <div class="layui-btn-container">
                <button class="layui-btn layui-btn-sm"  lay-event="add">
                    <i class="layui-icon">&#xe608;</i> 新增
                </button>
                <button class="layui-btn layui-btn-sm  layui-btn-danger"  lay-event="del">
                    <i class="layui-icon">&#xe640;</i> 删除
                </button>
                <button class="layui-btn layui-btn-sm"  lay-event="choose">
                    <i class="layui-icon">&#xe640;</i> 选择
                </button>
            </div>
        </script>
        <script type="text/html" id="attendeeTableOper">
            <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
        </script>
    </div>
</div>
<!--出席人员选择-添加-->
<div class="setAdd-attendeeForm hide">
    <div class="layui-card-body">
        <form class="layui-form form-theme3" name="setAdd-attendeeForm">
            <input type="hidden" name="attendeeId" class="layui-input hyinput">
            <div class="layui-row layui-col-space15">
                <div class="layui-col-md12">
                    <div class="layui-form-item">
                        <label class="layui-form-label">出席人员</label>
                        <div class="layui-input-block">
                            <input type="text" name="attendeeName" placeholder="请输入" autocomplete="off"
                                class="layui-input hyinput">
                        </div>
                    </div>
                </div>
                <div class="layui-col-md12">
                    <div class="layui-form-item">
                        <label class="layui-form-label">职务名称</label>
                        <div class="layui-input-block">
                            <input type="text" name="attendeeJob" placeholder="请输入" autocomplete="off"
                                class="layui-input hyinput">
                        </div>
                    </div>
                </div>
                <div class="layui-col-md12">
                    <div class="layui-form-item">
                        <label class="layui-form-label">备注</label>
                        <div class="layui-input-block">
                            <textarea name="remark" placeholder="请输入" class="layui-textarea hyinput"></textarea>
                        </div>
                    </div>
                </div>
                <div style="display: none">
                    <div class="layui-card" style="margin-top: 10px">
                        <div class="layui-card-body">
                            <div class="layui-form-item" style="text-align: center;">
                                <button class="layui-btn" lay-submit lay-filter="formAttendeeAdd"> <i
                                        class="layui-icon">&#x1005;</i>保存</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>

<!--出席股东-添加-->
<div class="setAdd-stockForm hide">
    <div class="layui-card-body">
        <form class="layui-form form-theme3" name="setAdd-stockForm">
            <input type="hidden" name="attendeeId" class="layui-input hyinput">
            <div class="layui-row layui-col-space15">
                <div class="layui-col-md12">
                    <div class="layui-form-item">
                        <label class="layui-form-label">出席人员</label>
                        <div class="layui-input-block">
                            <input type="text" id="attendeeName" name="attendeeName" placeholder="请输入"
                                autocomplete="off" class="layui-input hyinput">
                        </div>
                    </div>
                </div>
                <div class="layui-col-md12">
                    <div class="layui-form-item">
                        <label class="layui-form-label">职务名称</label>
                        <div class="layui-input-block">
                            <input type="text" id="attendeeJob" name="attendeeJob" placeholder="请输入" autocomplete="off"
                                class="layui-input hyinput">
                        </div>
                    </div>
                </div>
                <div class="layui-col-md12">
                    <div class="layui-form-item">
                        <label class="layui-form-label">备注</label>
                        <div class="layui-input-block">
                            <textarea name="remark" id="remark" placeholder="请输入"
                                class="layui-textarea hyinput"></textarea>
                        </div>
                    </div>
                </div>
                <div style="display: none">
                    <div class="layui-card" style="margin-top: 10px">
                        <div class="layui-card-body">
                            <div class="layui-form-item" style="text-align: center;">
                                <button class="layui-btn" lay-submit lay-filter="formAttendeeAdd"> <i
                                        class="layui-icon">&#x1005;</i>保存</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>
<!--缺席人员选择-->
<div class="set-absentForm hide">
    <div class="layui-card-body">
        <table id="absentTable" lay-filter="absentTable"></table>
        <script type="text/html" id="absentToolBar">
            <div class="layui-btn-container" style="position:relative;">
                <button class="layui-btn layui-btn-sm"  lay-event="add">
                    <i class="layui-icon">&#xe608;</i> 新增
                </button>
                <button class="layui-btn layui-btn-sm  layui-btn-danger"  lay-event="del">
                    <i class="layui-icon">&#xe640;</i> 删除
                </button>
                <button class="layui-btn layui-btn-sm"  lay-event="choose">
                    <i class=" fa fa-share-alt"></i> 选择分组
                </button>
                <span style="position:absolute;right:-110px">
                    <button class="layui-btn layui-btn-sm  layui-btn-primary" permission-btn="attendMove" lay-event="up">
                        <i class="layui-icon">&#xe619;</i> 向上
                    </button>
                    <button class="layui-btn layui-btn-sm  layui-btn-primary" permission-btn="attendMove"  lay-event="down">
                        <i class="layui-icon">&#xe61a;</i> 向下
                    </button>
                </span>
            </div>
        </script>
        <script type="text/html" id="absentTableOper">
            <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
        </script>
    </div>
</div>

<!--缺席人员选择-添加-->
<div class="setAdd-absentForm hide">
    <div class="layui-card-body">
        <form class="layui-form form-theme3" name="setAdd-absentForm">
            <input type="hidden" name="attendeeId" class="layui-input hyinput">
            <div class="layui-row layui-col-space15">
                <div class="layui-col-md12">
                    <div class="layui-form-item">
                        <label class="layui-form-label">缺席人</label>
                        <div class="layui-input-block">
                            <input type="text" name="attendeeName" placeholder="请输入" autocomplete="off"
                                class="layui-input hyinput">
                        </div>
                    </div>
                </div>
                <div class="layui-col-md12">
                    <div class="layui-form-item">
                        <label class="layui-form-label">缺席原因</label>
                        <div class="layui-input-block">
                            <input type="text" name="reason" placeholder="请输入" autocomplete="off"
                                class="layui-input hyinput">
                        </div>
                    </div>
                </div>
                <div class="layui-col-md12">
                    <div class="layui-form-item">
                        <label class="layui-form-label">委托人</label>
                        <div class="layui-input-block">
                            <input type="text" name="assignor" placeholder="请输入" autocomplete="off"
                                class="layui-input hyinput">
                        </div>
                    </div>
                </div>
                <div class="layui-col-md12">
                    <div class="layui-form-item">
                        <label class="layui-form-label">备注</label>
                        <div class="layui-input-block">
                            <textarea name="remark" placeholder="请输入" class="layui-textarea hyinput"></textarea>
                        </div>
                    </div>
                </div>
                <div style="display: none">
                    <div class="layui-card" style="margin-top: 10px">
                        <div class="layui-card-body">
                            <div class="layui-form-item" style="text-align: center;">
                                <button class="layui-btn" lay-submit lay-filter="formAbsentAdd"> <i
                                        class="layui-icon">&#x1005;</i>保存</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>

<!--常设列席选择-->
<div class="set-attenderForm hide">
    <div class="layui-card-body">
        <table id="attenderTable" lay-filter="attenderTable"></table>
        <script type="text/html" id="attenderToolBar">
            <div class="layui-btn-container" style="position:relative;">
                <button class="layui-btn layui-btn-sm"  lay-event="add">
                    <i class="layui-icon">&#xe608;</i> 新增
                </button>
                <button class="layui-btn layui-btn-sm  layui-btn-danger"  lay-event="del">
                    <i class="layui-icon">&#xe640;</i> 删除
                </button>
                <!--<button class="layui-btn layui-btn-sm"  lay-event="choose">-->
                    <!--<i class="layui-icon">&#xe640;</i> 选择-->
                <!--</button>-->
                <div style="display:inline-block;position:absolute;right:-129px;">
                    <a class="layui-btn layui-btn-sm layui-btn-primary" 
                    lay-event="upFile"><i class="layui-icon">&#xe619;</i>向上</a>
                    <!-- permission-btn="regulationTextUp" -->
                <a class="layui-btn layui-btn-sm layui-btn-primary" 
                    lay-event="downFile"><i class="layui-icon">&#xe61a;</i>向下</a>
                    <!-- permission-btn="regulationTextDown" -->
                </div>
            </div>
        </script>
        <script type="text/html" id="attenderTableOper">
            <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
        </script>
    </div>
</div>
<!--常设列席选择-添加-->
<div class="setAdd-attenderForm hide">
    <div class="layui-card-body">
        <form class="layui-form form-theme3" name="setAdd-attenderForm">
            <input type="hidden" name="attenderId" class="layui-input hyinput">
            <div class="layui-row layui-col-space15">
                <div class="layui-col-md12">
                    <div class="layui-form-item">
                        <label class="layui-form-label"><b class="red">*</b>人员姓名</label>
                        <div class="layui-input-block">
                            <input type="text" id="attenderSuName" lay-verify="required" name="attenderSuName"
                                placeholder="请输入" autocomplete="off" class="layui-input hyinput">
                        </div>
                    </div>
                </div>
                <div class="layui-col-md12">
                    <div class="layui-form-item">
                        <label class="layui-form-label"><b class="red">*</b>职务名称</label>
                        <div class="layui-input-block">
                            <input type="text" id="attenderJob" name="attenderJob" lay-verify="required"
                                placeholder="请输入" autocomplete="off" class="layui-input hyinput">
                        </div>
                    </div>
                </div>
                <div class="layui-col-md12">
                    <div class="layui-form-item">
                        <label class="layui-form-label"><b class="red">*</b>人员排序</label>
                        <div class="layui-input-block">
                            <input type="number" name="ggSort" placeholder="请输入" relay-verify="required"
                                autocomplete="off" class="layui-input hyinput">
                        </div>
                    </div>
                </div>
                <div class="layui-col-md12">
                    <div class="layui-form-item">
                        <label class="layui-form-label">备注信息</label>
                        <div class="layui-input-block">
                            <textarea name="remark" class="layui-textarea" placeholder="请输入备注信息"></textarea>
                        </div>
                    </div>
                </div>
                <div style="display: none">
                    <div class="layui-card" style="margin-top: 10px">
                        <div class="layui-card-body">
                            <div class="layui-form-item" style="text-align: center;">
                                <button class="layui-btn" lay-submit lay-filter="formAttenderAdd"> <i
                                        class="layui-icon">&#x1005;</i>保存</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>

<div class="memberTable hide">
    <div class="layui-card-body">
        <table id="memberTable" lay-filter="memberTable"></table>
    </div>
</div>

<!--会议资料-添加-->
<script type="text/html" id="hyzl-add">
    <div class="layui-card-body">
        <form class="layui-form form-theme3" name="hyzl-add">
            <div class="layui-row layui-col-space10">
                <div class="layui-col-md12">
                    <div class="layui-form-item">
                        <label class="layui-form-label"><b class="red">*</b>资料类型：</label>
                        <div class="layui-input-block">
                            <select name="fiFileType" id="meetingFileType" lay-filter="meetingFileType">
                                <option value="">请选择</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="layui-col-md12 printTimeArea" style="display: none">
                    <div class="layui-form-item">
                        <label class="layui-form-label"> <b class="red">*</b>印发日期：</label>
                        <div class="layui-input-block">
                            <input type="text" name="printTime" id="printTimeArea" class="layui-input" placeholder="请选择" readonly="readonly">
                        </div>
                    </div>
                </div>

                <div class="layui-col-md12">
                    <div class="layui-form-item">
                        <!-- <div class="layui-upload">
                            <button class="layui-btn layui-btn-normal" id="uploadFile" type="button">选择文件</button>
                        </div> -->
                        <label class="layui-form-label"><b class="red">*</b>文件上传：</label>
                        <div class="layui-input-block">
                            <div style="display: inline-block">
                                <input type="text" name="fileName" placeholder="请输入文件名称" class="layui-input"
                                   style="width: 60%;display: inline-block" readonly="readonly" >
                            <input type="text" name="fileType" class="layui-input" readonly="readonly"
                                   style="display: inline-block;width: 35%">
                                <button class="layui-btn " id="uploadFile" type="button" style="position:absolute;right:0;"><i class=" fa fa-share-alt"></i>选择
                                </button>
                                <button class="layui-btn hide" id="realUploadFile" type="button">
                                </button>
                            </div>
                            <!--<input type="text" name="fileName" placeholder="" class="layui-input"-->
                            <!--readonly="readonly"-->
                            <!--style="display: inline-block;width: 180px;margin-left: 20px;border: none !important">-->
                        </div>
                    </div>
                </div>
                <!-- <div class="layui-col-xs12" id="fileNameArea" style="display: none">
                    <div class="layui-form-item">
                        <label class="layui-form-label">文件名称：</label>
                        <div class="layui-input-block">
                            
                        </div>
                    </div>
                </div> -->

                <div class="layui-col-xs12 hide">
                    <div class="layui-form-item">
                        <label class="layui-form-label">备注：</label>
                        <div class="layui-input-block">
                            <textarea name="maRemarks" placeholder="请输入" class="layui-textarea hyinput"></textarea>
                        </div>
                    </div>
                </div>
                <div class="layui-col-xs12">
                    <!-- <div class="layui-form-item layui-upload ">
                        <button type="button" class="layui-btn layui-btn-normal" id="fileUpload"><i class="layui-icon"></i>上传文件</button> -->
                   <div style="text-align: center">
                       <button type="button" class="layui-btn" id="fileUpload"><i class="fa fa-check-circle"></i>确定</button>
                       <button type="button" class="layui-btn layui-btn-primary btnClose"><i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消</button>
                   </div>
                </div>
            </div>
        </form>
    </div>
</script>
<!-- 会议纪要 -->
<script type="text/html" id="hyjyDate">
    <div class="layui-card-body">
        <form class="layui-form form-theme3" name="hyjyDateAdd" lay-filter="formTest">
            <div class="layui-row layui-col-space10">
                
                <div class="layui-col-md12 printTimeArea">
                    <div class="layui-form-item">
                        <label class="layui-form-label"> <b class="red">*</b>印发日期：</label>
                        <div class="layui-input-block">
                            <input type="text" name="printTime" id="printTimeArea" class="layui-input" placeholder="请选择" readonly="readonly" lay-verify="required">
                        </div>
                    </div>
                </div>

                <div class="layui-col-xs12">
                    <!-- <div class="layui-form-item layui-upload ">
                        <button type="button" class="layui-btn layui-btn-normal" id="fileUpload"><i class="layui-icon"></i>上传文件</button> -->
                   <div style="text-align: center">
                       <button type="button" class="layui-btn" lay-submit lay-filter="updateReleaseTime"><i class="fa fa-check-circle"></i>确定</button>
                       <button type="button" class="layui-btn layui-btn-primary btnClose"><i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消</button>
                   </div>
                </div>
            </div>
        </form>
    </div>
</script>
<!-- 议题附件-添加 -->
<script type="text/html" class="subject-add hide" id="subject-add">
    <div class="layui-card-body">
        <form class="layui-form form-theme3" name="subject-add">
            <div class="layui-row layui-col-space15">
                <!--<div class="layui-col-md12">
                    <div class="layui-form-item">
                        <label class="layui-form-label">资料类型</label>
                        <div class="layui-input-block">
                            <select name="fiFileType" id="subjectFileType">
                                <option value="">请选择</option>
                            </select>
                        </div>
                    </div>
                </div>-->
                <div class="layui-col-md2">
                    <div class="layui-form-item">
                        <div class="layui-upload">
                            <button class="layui-btn" id="uploadSubjectFile" type="button">选择文件</button>
                        </div>
                    </div>
                </div>
                <div class="layui-col-xs12" id="fileNameArea" style="display: none">
                    <div class="layui-form-item">
                        <label class="layui-form-label">文件名称：</label>
                        <div class="layui-input-block">
                            <input type="text" name="fileName" placeholder="请输入文件名称" class="layui-input"
                                   style="width: 60%;display: inline-block">
                            <input type="text" name="fileType" class="layui-input" readonly="readonly"
                                   style="display: inline-block;width: 30%">
                        </div>
                    </div>
                </div>
                <div class="layui-col-md12">
                    <div class="layui-layer-btn layui-layer-btn-c">
                        <button type="button" class="layui-btn" id="fileSubjectUpload"><i class="fa fa-check-circle"></i>确定</button>
                        <button type="button" class="layui-btn layui-btn-primary btnClose"><i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>关闭</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</script>
<!--待上会议题清单-->
<script type="text/html" class="dshyt hide">
    <div class="layui-card white-bg">
        <div class="layui-card-header layui-card-header-custom"><span><i></i>议案列表</span></div>
        <div class="layui-card-body">
            <!--layui-form-pane-->
            <form action="" class="layui-form layui-form-pane">
                <div class="layui-row layui-col-space10">
                    <div class="layui-col-md4">
                        <div class="layui-form-item">
                            <label class="layui-form-label">议案名称</label>
                            <div class="layui-input-block">
                                <input type="text" name="motionName" placeholder="请输入" autocomplete="off" class="layui-input">
                            </div>
                        </div>
                    </div>
                    <div class="layui-col-md4">
                        <div class="layui-form-item">
                            <label class="layui-form-label">提出部门</label>
                            <div class="layui-input-block">
                                <input type="text" name="soName"  placeholder="请选择" readonly="" autocomplete="off" class="layui-input">
                                <input type="hidden" name="soId"  class="layui-input">
                                <div class="eleTree ele5" lay-filter="data5"></div>
                            </div>
                        </div>
                    </div>
                    <div class="layui-col-md4">
                        <div class="layui-form-item">
                            <label class="layui-form-label">提出时间</label>
                            <div class="layui-input-block">
                                <input type="text" class="layui-input" readonly name="motionCreateTime" id="motionCreateTime" placeholder="请选择时间范围">
                            </div>
                        </div>
                    </div>
                    <input type="hidden" name="motionCreateTimeStar" id="motionCreateTimeStar">
                    <input type="hidden" name="motionCreateTimeEnd" id="motionCreateTimeEnd">

                </div>
                <div class="layui-row layui-col-space10">
                    <div class="" style="text-align: center; margin-bottom: 5px;right: 0;bottom: 8px;">
                        <div class="layui-input-inline" style="padding-left: 20px">
                            <button name="searchSubmit" class="layui-btn  " lay-submit="" lay-filter="dshytSearch" ><i class="fa fa-search"></i>查询</button>
                            <button name="reset" lay-filter="reset" type="reset" class="layui-btn layui-btn-primary  "><i class="fa fa-eraser"></i>重置</button>
                        </div>
                    </div>
                </div>

            </form>
        </div>
    </div>
    <div class="layui-card-body">
        <table id="dshyt" lay-filter="dshyt"></table>
    </div>
</script>
<!--待上议题-添加-->
<!-- <div class="dshyt-add hide">
        <div class="layui-card-body">
            <form class="layui-form form-theme3" name="dshyt-add">
                    <div class="layui-row layui-col-space15">
                        <div class="layui-col-md12">
                            <div class="layui-form-item">
                                <label class="layui-form-label">议题名称</label>
                                <div class="layui-input-block">
                                    <input type="text" name="ytmc" placeholder="请输入" autocomplete="off" class="layui-input hyinput">
                                </div>
                            </div>
                        </div>
                        <div class="layui-col-md12">
                            <div class="layui-form-item">
                                <label class="layui-form-label">提出部门</label>
                                <div class="layui-input-block">
                                    <select name="tcbm">
                                        <option value="">请选择</option>
                                        <option value="0">投资管理部</option>
                                        <option value="1">财务部</option>
                                        <option value="2">党群工作部</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="layui-col-md12">
                            <div class="layui-form-item">
                                <label class="layui-form-label">备注</label>
                                <div class="layui-input-block">
                                    <textarea name="ggmemo" placeholder="请输入" class="layui-textarea hyinput"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
            </form>
        </div>
</div> -->
<!--表决清单-编辑-->
<script type="text/html" class="bjqk-edit hide">
    <div class="layui-card-body">
        <form class="layui-form  form-theme3" name="dshyt-add" id="bjqkForm">
            <div class="layui-row layui-col-space15">
                <input type="hidden" id="deliberationId" name="deliberationId" class="layui-input hyinput">
                <input type="hidden" id="subjectId" name="subjectId" class="layui-input hyinput">
                <div class="layui-col-md12">
                    <div class="layui-form-item">
                        <label class="layui-form-label">人员姓名</label>
                        <div class="layui-input-block">
                            <input type="text" id="deliberationPersonnel" lay-verify="deliberationPersonnel" name="deliberationPersonnel" readonly="readonly" autocomplete="off" class="layui-input hyinput">
                        </div>
                    </div>
                </div>
                <div class="layui-col-md12">
                    <div class="layui-form-item">
                        <label class="layui-form-label">职务名称</label>
                        <div class="layui-input-block">
                            <input type="text" id="job" name="job" autocomplete="off" class="layui-input hyinput" readonly="readonly">
                        </div>
                    </div>
                </div>
                <div class="layui-col-md12">
                    <div class="layui-form-item">
                        <label class="layui-form-label">参会状态</label>
                        <div class="layui-input-block">
							<input type="text" id="attendStatusName" name="attendStatusName" autocomplete="off" class="layui-input hyinput" readonly="readonly">
                        </div>
                    </div>
                </div>
                <div class="layui-col-md12">
                    <div class="layui-form-item">
                        <label class="layui-form-label">缺席原因</label>
                        <div class="layui-input-block">
                            <textarea id="reason" name="reason" class="layui-textarea hyinput" readonly="readonly"></textarea>
                        </div>
                    </div>
                </div>
                <div class="layui-col-md12">
                    <div class="layui-form-item">
                        <label class="layui-form-label"><b class="red">*</b>审议结果</label>
                        <div class="layui-input-block">
                            <select id="deliberationResult" name="deliberationResult" lay-verify="deliberationResult">
                            </select>
                        </div>
                    </div>
                </div>
				<div class="layui-col-md12">
                    <div class="layui-form-item">
                        <label class="layui-form-label">委托人名</label>
                        <div class="layui-input-block">
							<input type="text" id="assignor" name="assignor"  autocomplete="off" class="layui-input hyinput" readonly="readonly">
                        </div>
                    </div>
                </div>
                <div class="layui-col-md12">
                    <div class="layui-form-item">
                        <label class="layui-form-label">备注信息</label>
                        <div class="layui-input-block">
                            <textarea id="remark" name="remark"  class="layui-textarea hyinput"></textarea>
                        </div>
                    </div>
                </div>
                <div style="display: none">
                    <div class="layui-card" style="margin-top: 10px">
                        <div class="layui-card-body">
                            <div class="layui-form-item" style="text-align: center;">
                                <button class="layui-btn" lay-submit lay-filter="deliberationAdd"> <i class="layui-icon">&#x1005;</i>保存</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
</script>

<!--会议类型选择-->
<div class="meetingTypeSelectLayer hide">
    <div class="moduleBox">
        <form class="layui-form form-theme3" name="preMeetingTypeFormLayer" lay-filter="preMeetingTypeForm">
            <div class="layui-card">
                <div class="layui-card-body">
                    <div class="layui-row layui-col-space15">
                        <div class="layui-col-md12">
                            <div class="layui-form-item">
                                <label class="layui-form-label"><b class="red">*</b>会议类型:</label>
                                <div class="layui-input-block">
                                    <select name="meetingType" lay-verify="required" id="meetingType"
                                        lay-filter="meetingTypeFilter"></select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--<div style="display: none">-->
            <!--<div class="layui-card" style="margin-top: 10px">-->
            <!--<div class="layui-card-body">-->
            <!--<div class="layui-form-item" style="text-align: center;">-->
            <!--<button class="layui-btn"  lay-filter="preFormMeetingTypeAdd"> <i class="layui-icon">&#x1005;</i>保存</button>-->
            <!--</div>-->
            <!--</div>-->
            <!--</div>-->
            <!--</div>-->
        </form>
    </div>
</div>

<!--编辑出席人员 layer-->
<div class="attendee-edit-layer hide">
    <div class="moduleBox">
        <table class="layui-hide" id="attendee-edit-table" lay-filter="attendee-edit-table"></table>
        <script type="text/html" id="attendee-edit-table-tool-bar">
            <div class="layui-btn-container">
                <button class="layui-btn layui-btn-sm" lay-event="add">
                    <i class="layui-icon">&#xe608;</i> 新增
                </button>
                <button class="layui-btn layui-btn-sm layui-btn-danger" lay-event="delete" >
                    <i class="layui-icon">&#xe640;</i> 删除
                </button>
                <button class="layui-btn layui-btn-sm layui-btn-primary" lay-event="choose">
                    <i class="fa fa-share-alt"></i> 选择
                </button>
                <!-- <button class="layui-btn layui-btn-sm layui-btn-primary" lay-event="choosePeople">
                    <i class="fa fa-share-alt"></i> 选择分组
                </button> -->
            </div>
        </script>
        <script type="text/html" id="attendee-edit-table-oper">
            <div class="layui-btn-container">
                <button class="layui-btn layui-btn-xs" lay-event="edit">编辑</button>
            </div>
        </script>
    </div>
</div>
<!--编辑出席股东 layer-->
<div class="stockholder-edit-layer hide">
    <div class="moduleBox">
        <table class="layui-hide" id="stockholder-edit-table" lay-filter="stockholder-edit-table"></table>
        <script type="text/html" id="stockholderToolBar">
            <div class="layui-btn-container">
                <button class="layui-btn layui-btn-sm" lay-event="stockAdd">
                    <i class="layui-icon">&#xe608;</i> 新增
                </button>
                <button class="layui-btn layui-btn-sm layui-btn-danger" lay-event="stockDelete" >
                    <i class="layui-icon">&#xe640;</i> 删除
                </button>
                <!-- <button class="layui-btn layui-btn-sm" lay-event="stockChoose">
                    <i class="fa fa-share-alt"></i> 选择分组
                </button> -->
                <button class="layui-btn layui-btn-sm" lay-event="stockPeopleChoose">
                    <i class="fa fa-share-alt"></i> 选择股东
                </button>
                
            </div>
        </script>
        <script type="text/html" id="stockholder-edit-table-oper">
            <div class="layui-btn-container">
                <button class="layui-btn layui-btn-xs" lay-event="stockEdit">编辑</button>
            </div>
        </script>
    </div>
</div>
<!--编辑出席人员情况 layer-->
<div class="attendeeStatusLayer hide">
    <div class="moduleBox">
        <form class="layui-form form-theme3" lay-filter="attendeeForm">
            <input type="hidden" name="attendeeId">
            <div class="layui-form-item">
                <label class="layui-form-label "><b class="red">*</b>人员姓名:</label>
                <div class="layui-input-block">
                    <input type="text" class="layui-input required2" name="attendeeName" lay-verify="required"
                        autocomplete="off" placeholder="请输入人员姓名">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label "><b class="red">*</b>职务名称:</label>
                <div class="layui-input-block">
                    <input type="text" class="layui-input required2" name="attendeeJob" lay-verify="required"
                        autocomplete="off" placeholder="请输入职务名称">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label "><b class="red">*</b>出席排序:</label>
                <div class="layui-input-block">
                    <input type="text" class="layui-input required2" autocomplete="off" name="ggSort"
                        lay-verify="required">
                </div>
            </div>

            <div class="layui-form-item">
                <label class="layui-form-label "><b class="red">*</b>参会状态:</label>
                <div class="layui-input-block">
                    <select name="participantsType" lay-filter="participantsType">
                        <option name="" value=""></option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item zhuchiArea" style="display: none">
                <label class="layui-form-label "><b class="red">*</b>召集主持:</label>
                <div class="layui-input-block">
                    <input type="checkbox" name="isConvenor" lay-filter="isConvenor" title="召集人">
                    <input type="checkbox" name="isModerator" lay-filter="isModerator" title="主持人">
                </div>
            </div>
            <div class="layui-form-item quexiArea" style="display: none;padding-right: 88px;position: relative;">
                <label class="layui-form-label required2"><b class="red">*</b>缺席原因:</label>
                <div class="layui-input-block">
                    <input type="text" class="layui-input required2" name="reason" placeholder="请输入缺席原因"
                        autocomplete="off" lay-verify="required">
                    <button type="button" class="layui-btn" id="commonReasons"
                        style="position: absolute;right: -88px;top: 0;">常用原因</button>
                    <div class="reasonDiv"
                        style="display: none;position: absolute;top: 38px;left: 0;width: 97%;z-index: 99999999;background-color: white;">

                    </div>
                </div>
            </div>
            <div class="layui-form-item weituoArea" style="display: none">
                <label class="layui-form-label "><b class="red">*</b>委托人名:</label>
                <div class="layui-input-block">
                    <input type="text" class="layui-input required2" name="assignor" autocomplete="off"
                        lay-verify="required" placeholder="请输入委托人名">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label hide">备注:</label>
                <div class="layui-input-block">
                    <textarea name="remark" autocomplete="off" class="layui-textarea" placeholder="请输入备注信息"></textarea>
                </div>
            </div>
        </form>
    </div>
</div>
<!--编辑出席股东情况 layer-->
<div class="stockholderLayer hide">
    <div class="moduleBox">
        <form class="layui-form form-theme3" lay-filter="stockForm">
            <input type="hidden" name="attendeeId">
            <div class="layui-form-item">
                <label class="layui-form-label "><b class="red">*</b>企业名称:</label>
                <div class="layui-input-block">
                    <input autocomplete="off" type="hidden" id="hideSeId">
                    <input type="text" class="layui-input required2" name="stockName" id="seNameSelect" lay-verify="required"
                        autocomplete="off" placeholder="弹出法人层级组织机构树，单机选择" readonly>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label "><b class="red">*</b>持股比例:</label>
                <div class="layui-input-block">
                    <input type="text" class="layui-input required2" name="ratio" lay-verify="required"
                        autocomplete="off" placeholder="请输入百分数，例如持股60%，请输入60">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label ">持股数量:</label>
                <div class="layui-input-block">
                    <input type="text" class="layui-input" autocomplete="off" name="quantity"
                        placeholder="请输入持股数，单位为股，若为1万股，请输入10000">
                </div>
            </div>

            <div class="layui-form-item">
                <label class="layui-form-label ">认缴资本:</label>
                <div class="layui-input-block">
                    <input type="text" class="layui-input" autocomplete="off" name="amount"
                        placeholder="请输入认缴金额，单位为元人民币">
                </div>
            </div>
        </form>
    </div>
</div>


<script type="text/html" id="tableSelect">
	<select name='deliberationResult1' lay-filter="deliberationResult">
        <option value="">请选择</option>
        <option value="同意">同意</option>
        <option value="弃权">弃权</option>
        <option value="反对">反对</option>
    </select>
</script>


<body class="iframe-h">

    <div class="content-wrap">
        <div class="layui-row layui-col-space10">
            <div class="layui-col-xs12">
                <div class="gloBg">
                    <div class="mainTitle" id="mainTitle">会议</div>
                </div>
            </div>
            <div class="layui-col-xs12 layui-col-sm12 layui-col-md12">
                <!-- 基本信息 -->
                <form style="margin-top: 0" class="layui-form form-theme3" name="meetingLayer" lay-filter="meetingForm">
                    <div class="layui-card">
                        <div class="layui-card-header layui-card-header-custom">
                            <span><i></i>会议信息
                                <b class="zsBga"></b>
                            </span>
                        </div>
                        <input type="hidden" name="curSeId" id="curSeId">
                        <input type="hidden" name="meetingId" id="meetingId">
                        <input type="hidden" name="exceptionFlag" id="exceptionFlag">
                        <input type="hidden" name="formOperType" id="formOperType">
                        <input type="hidden" name="releaseTime" id="releaseTime">
                        <input type="hidden" name="flowStatusId" id="flowStatusId">
                        <div class="layui-card-body">
                            <div class="layui-row layui-col-space15">
                                <div class="layui-col-md12">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label"><b class="red">*</b>会议名称:</label>
                                        <div class="layui-input-block">
                                            <input type="text" lay-verify="meetingName" name="meetingName"
                                                id="meetingName" placeholder="请输入" autocomplete="off"
                                                class="layui-input hyinput" value="">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="layui-row layui-col-space15">
                                <div class="layui-col-md6">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label"><b class="red">*</b>会议日期:</label>
                                        <div class="layui-input-block">
                                            <input type="text" readonly lay-verify="meetingTime"
                                                class="layui-input hyinput" id="meetingTime" name="meetingTime"
                                                placeholder="请选择日期">
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-col-md6">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label"><b class="red"
                                                id="meetingAddrSpan">*</b>会议地点:</label>
                                        <div class="layui-input-block">
                                            <input type="text" name="meetingAddr" id="meetingAddr"
                                                lay-varify="meetingAddr" placeholder="请输入" autocomplete="off"
                                                class="layui-input hyinput" value="">
                                        </div>
                                    </div>
                                </div>
                                <!--  <div class="layui-col-md6">
                                 <div class="layui-form-item">
                                     <label class="layui-form-label"><b class="red">*</b>会议类型:</label>
                                     <div class="layui-input-block">
                                         <select name="meetingType" lay-verify="required" id="meetingType" lay-filter="meetingTypeFilter">
                                             <option name="" value=""></option>
                                         </select>
                                     </div>
                                 </div>
                             </div> -->
                                <input type="hidden" name="meetingTypeId" id="meetingTypeId">
                                <input type="hidden" name="meetingTypeCode" id="meetingTypeCode">
                                <input type="hidden" name="meetingTypeName" id="meetingTypeName">
                            </div>
                            <div class="layui-row layui-col-space15">
                                <div class="layui-col-md6">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label"><b class="red">*</b>会议形式:</label>
                                        <div class="layui-input-block">
                                            <select name="meetingMode" id="meetingMode" lay-filter="meetingModeFilter"
                                                lay-verify="meetingMode">
                                                <option name="" value=""></option>
                                            </select>

                                        </div>
                                    </div>
                                </div>
                                <input type="hidden" name="meetingModeName" id="meetingModeName">
                                <input type="hidden" name="deliberationName">
                                <input type="hidden" name="meetingFormGzwName">
                                <div class="layui-col-md6">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label"><b class="red">*</b>审议形式:</label>
                                        <div class="layui-input-block">
                                            <select name="deliberationMode" lay-verify="deliberationMode"
                                                id="deliberationMode" lay-filter="deliberationModeFilter">
                                                <option name="" value=""></option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- <div class="layui-row layui-col-space15">
                            <div class="layui-col-md6">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label"><b class="red">*</b>纪要印发时间:</label>
                                        <div class="layui-input-block">
                                            <input type="text" lay-verify="required" readonly class="layui-input hyinput" id="releaseTime" name="releaseTime" placeholder="请选择日期">
                                        </div>
                                    </div>
                            </div>
                        </div> -->
                        </div>
                    </div>
                    <input type="hidden" readonly name="seComcode" id="seComcode" placeholder="请输入" autocomplete="off"
                        class="layui-input hyinput" value="">
                    <input type="hidden" readonly name="meetingCode" id="meetingCode" placeholder="请输入"
                        autocomplete="off" class="layui-input hyinput" value="">
                    <input type="hidden" readonly id="meetingYear" class="layui-input hyinput" name="meetingYear"
                        id="meetingYear" placeholder="请输入年份">
                    <input type="hidden" id="serialNumber" readonly name="serialNumber" placeholder="请输入"
                        autocomplete="off" class="layui-input hyinput" value="">

                    <div style="display: none;z-index: 970;">
                        <div class="layui-card" style="margin-top: 10px">
                            <div class="layui-card-body">
                                <div class="layui-form-item" style="text-align: center;">
                                    <button class="layui-btn" lay-submit lay-filter="formMeetingAdd"> <i
                                            class="layui-icon">&#x1005;</i>保存</button>
                                    <button class="layui-btn" lay-submit lay-filter="formMeetingSubmit"><i
                                            class="layui-icon">&#xe605;</i>提交</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="layui-collapse white-bg editView" style="margin-top: 10px">
                        <div class="layui-colla-item">
                            <h2 class="layui-colla-title white-bg">参会情况 <b class="zsBga"></b></h2>
                            <div class="layui-colla-content layui-show">
                                <!-- 参会人员 -->
                                <div class="layui-card">

                                    <div class="layui-card-body">
                                        <div class="layui-row layui-col-space10">
                                            <div class="layui-col-md6">
                                                <div class="layui-form-item" style="position: relative">
                                                    <label class="layui-form-label"><b class="red">*</b>召集人员:</label>
                                                    <div class="layui-input-block" style="padding-right: 160px">
                                                        <input type="text" name="convenor" lay-verify="convenor"
                                                            id="convenor" placeholder="请输入召集人员姓名" autocomplete="off"
                                                            class="layui-input hyinput" value="" readonly="readonly">
                                                    </div>
                                                    <div style="position: absolute;z-index: 1;top: 1px;right: 0">
                                                        <button class="layui-btn layui-btn-warm" id="attend-edit"><i
                                                                class="fa fa-pencil"></i>编辑</button>
                                                        <button class="layui-btn" id="attend-setting"><i
                                                                class=" fa fa-share-alt"></i>选择</button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="layui-col-md6">
                                                <div class="layui-form-item" style="position: relative">
                                                    <label class="layui-form-label"><b class="red">*</b>主持人员:</label>
                                                    <div class="layui-input-block" style="padding-right: 160px">
                                                        <input type="text" name="moderatorName"
                                                            lay-verify="moderatorName" id="moderatorName"
                                                            placeholder="请输入主持人员姓名" autocomplete="off"
                                                            class="layui-input hyinput" value="" readonly="readonly">
                                                    </div>
                                                    <div style="position: absolute;top: 1px; right: 0">
                                                        <button class="layui-btn layui-btn-warm" id="zhuchi-edit"><i
                                                                class="fa fa-pencil"></i>编辑</button>
                                                        <button class="layui-btn" id="zhuchi-setting"><i
                                                                class=" fa fa-share-alt"></i>选择</button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="layui-col-md12">
                                                <div class="layui-form-item" style="position: relative">
                                                    <label class="layui-form-label"><b class="red">*</b>出席人员:</label>
                                                    <div class="layui-input-block" style="padding-right: 160px">
                                                        <input type="text" lay-verify="attendeeNames"
                                                            name="attendeeNames" id="attendeeNames"
                                                            placeholder="请点击选择按钮添加出席人员" autocomplete="off"
                                                            class="layui-input hyinput" value="" readonly="readonly">
                                                    </div>
                                                    <div style="position: absolute;top: 1px; right: 0">
                                                        <button class="layui-btn layui-btn-warm" id="attendee-edit"><i
                                                                class="fa fa-pencil"></i>编辑</button>
                                                        <button class="layui-btn" id="attendee-setting"><i
                                                                class=" fa fa-share-alt"></i>选择</button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="layui-col-md12" id="stockholderDiv" style="display:none">
                                                <div class="layui-form-item" style="position: relative">
                                                    <label class="layui-form-label"><b class="red">*</b>出席股东:</label>
                                                    <div class="layui-input-block" style="padding-right: 160px">
                                                        <input type="text" lay-verify="stockName" name="stockName"
                                                            id="stockName"
                                                            placeholder="默认从企业完善信息中获取持股前10名股东名称，可点击编辑按钮加入企业完善模块中无维护股东信息，也可点击选择按钮重新选择加入需要展示的股东。"
                                                            autocomplete="off" class="layui-input hyinput" value=""
                                                            readonly="readonly">
                                                    </div>
                                                    <div style="position: absolute;top: 1px; right: 0">
                                                        <button class="layui-btn layui-btn-warm"
                                                            id="stockholder-edit"><i
                                                                class="fa fa-pencil"></i>编辑</button>
                                                        <button class="layui-btn"
                                                            permission-btn="selectTiolAttendStockList"
                                                            id="stockholder-setting"><i
                                                                class=" fa fa-share-alt"></i>选择</button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="layui-col-md12">
                                                <div class="layui-form-item relative">
                                                    <label class="layui-form-label">缺席人员:</label>
                                                    <div class="layui-input-block">
                                                        <input type="text" readonly name="absentNames" id="absentNames"
                                                            placeholder="从已选出席人员中筛选制度人员，且为全会缺席情况" autocomplete="off"
                                                            class="layui-input padRt64 hyinput" value="">
                                                    </div>
                                                    <!-- <div style="position: absolute;right: 0;top: 1px;">
                                                    <button class="layui-btn " id="absent-setting">选择</button>
                                                    </div> -->
                                                </div>
                                            </div>
                                            <div class="layui-col-md12">
                                                <div class="layui-form-item relative">
                                                    <label class="layui-form-label">常设列席:</label>
                                                    <div class="layui-input-block" style="padding-right: 70px;">
                                                        <input type="text" readonly name="attenders" id="attenders"
                                                            placeholder="由已选择出席人自动带出常设列席人员，并在此基础上增补删减"
                                                            autocomplete="off" class="layui-input hyinput" value="">
                                                    </div>
                                                    <div style="position: absolute;right: 0;top: 1px;">
                                                        <button class="layui-btn layui-btn-warm"
                                                            id="attender-setting"><i
                                                                class="fa fa-pencil"></i>编辑</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="layui-col-xs12">
                <div class="layui-collapse white-bg editView">
                    <div class="layui-colla-item">
                        <h2 class="layui-colla-title white-bg">会议资料 <b class="zsBga"></b></h2>
                        <div class="layui-colla-content">
                            <!-- 会议资料 -->
                            <div class="layui-card">
                                <div style="width: 110px;">
                                    <label class="layui-form-label" style="position:relative;right:-8px">最终版本:</label>
                                </div>

                                <div class="layui-card-body" style="padding-left: 137px;">
                                    <table id="meetingFile" lay-filter="meetingFile"></table>
                                    <script type="text/html" id="meetingFileToolBar">
                                    <div class="layui-btn-container" style="position:relative;">
                                        <button class="layui-btn layui-btn-sm"   lay-event="add">
                                            <i class="layui-icon">&#xe608;</i> 新增
                                        </button>
                                        <button class="layui-btn layui-btn-sm layui-btn-danger" lay-event="del">
                                            <i class="layui-icon">&#xe640;</i> 删除
                                        </button>

                                        <span style="position:absolute;right:-130px;">
                                            <a class="layui-btn layui-btn-sm layui-btn-primary"
                                             lay-event="upFile"><i
                                                class="layui-icon">&#xe619;</i>向上</a>
                                        <a class="layui-btn layui-btn-sm layui-btn-primary"
                                             lay-event="downFile"><i
                                                class="layui-icon">&#xe61a;</i>向下</a>

                                        </span>
                                    </div>
                                </script>

                                    <script type="text/html" id="meetingFileOper">
                                    <!-- <a class="layui-btn layui-btn-xs" lay-event="check">查看</a> -->
                                    <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
                                    <a class="layui-btn layui-btn-xs layui-btn-warm" lay-event="load">预览</a>

                                    <!-- <a class="layui-btn layui-btn-xs"  lay-event="up">上移</a>
                                    <a class="layui-btn layui-btn-xs"  lay-event="down">下移</a> -->


                                    <!-- <a class="layui-btn layui-btn-xs edit1" lay-event="edit">编辑</a> -->
                                    </script>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="layui-col-xs12">
                <div class="layui-collapse white-bg editView">
                    <div class="layui-colla-item">
                        <h2 class="layui-colla-title white-bg">议题清单<b class="zsBga"></b></h2>
                        <div class='layui-colla-content'>
                            <!-- 议题清单 -->
                            <div class="layui-card">
                                <div style="width: 110px;">
                                    <label class="layui-form-label" style="position:relative;right:-8px">上会议题:</label>
                                </div>
                                <div class="layui-card-body" style="padding-left: 137px;">
                                    <table id="ytList" lay-filter="ytList"></table>
                                    <script type="text/html" id="ytListToolBar">
                                    <div class="layui-btn-container" style="position:relative;">
                                        <button class="layui-btn layui-btn-sm"  lay-event="add">
                                            <i class="layui-icon">&#xe608;</i> 关联
                                        </button>
                                        <button class="layui-btn layui-btn-sm layui-btn-danger"  lay-event="del">
                                            <i class="layui-icon">&#xe640;</i> 删除
                                        </button>
                                        <span style="position:absolute;right:-130px">
                                            <button class="layui-btn layui-btn-primary layui-btn-sm"  lay-event="up">
                                                <i class="layui-icon">&#xe619;</i> 向上
                                            </button>
                                            <button class="layui-btn layui-btn-primary layui-btn-sm"  lay-event="down">
                                                <i class="layui-icon">&#xe61a;</i> 向下
                                            </button>
                                        </span>
                                        
                                    </div>
                                </script>

                                    <script type="text/html" id="ytListOper">
                                    <a class="layui-btn layui-btn-xs " 
                                        lay-event="edit">审议</a>
                                    <a class="layui-btn layui-btn-xs layui-btn-warm" lay-event="check">查看</a>
                                    </script>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div style="position: fixed;width: 100%;bottom: 17px;background: white;z-index: 980;">
        <div class="layui-card" style="">
            <div class="layui-card-body" style="border-top: 1px solid #dfdfdf">
                <div class="layui-form-item" style="text-align: center;">
                    <button class="layui-btn" id="saveMeetingAll" permission-btn="meetingSave"><i
                            class="layui-icon">&#x1005;</i>保存</button>
                    <button class="layui-btn" id="submitMeeting" permission-btn="meetingSubmit"><i
                            class="layui-icon">&#xe605;</i>提交</button>
                    <button class="layui-btn layui-btn-primary" id="addNewMeeting"><i
                            class="layui-icon">&#xe608;</i>新建</button>

                    <button class="layui-btn hide" id="formMeetingClose"><i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>关闭</button>
                </div>
            </div>
        </div>
    </div>
    <!--脚垫-->
    <div style="height: 80px;"> </div>
    <script src="./../../../../src/js/layui/layui.js"></script>
    <script>

        layui.config({
            base: '../../../../src/js/',
            version: new Date().getTime()
        }).use(['eleTree', 'layer', 'table', 'form', 'laytpl', 'common', 'element', 'laydate', 'upload'], function () {
            var table = layui.table;
            var form = layui.form;
            var tree = layui.eleTree;
            var common = layui.common;
            var element = layui.element;
            var laydate = layui.laydate;
            var upload = layui.upload;
            var util = layui.util;
            element.init();
            var baseUrl = '../../../../';
            var fileSortData;
            common.themeSet();
            var agree = 0;
            var disagree = 0;//预设表决情况
            var notFill = 0;


            var mainFunc = {
                meetingTypeSelectLayer: function () {
                    var meetingTypeSelectLayer = layer.open({
                        title: '会议类型',
                        area: ['400px', '500px'],
                        btn: ['<i class="layui-icon">&#xe605;</i>确定'],
                        content: $('.meetingTypeSelectLayer').html(),
                        type: '1',
                        closeBtn: 0,
                        btnAlign: 'c',
                        success: function (obj) {
                            var parent = $(obj.selector);
                            common.selectDataSet({
                                elem: parent.find('[name=meetingType]'),
                                url: 'meetingmgr/tiolMeetingType/getTiolMeetingTypeSelect',
                                responseList: 'list',
                                method: 'get',//默认为get
                                optionText: 'meetingTypeName',
                                optionValue: 'meetingType',
                                success: function (data) {
                                    form.render('select');
                                }
                            });
                        },
                        yes: function (index, layero) {
                            var parent = $(layero.selector);
                            if (!parent.find('[name=meetingType]').val()) {
                                layer.alert('请选择会议类型');
                                return false;
                            }
                            var select = parent.find('[name=meetingType]');
                            var meetingTypeValue = select.val();//值
                            meetingTypeName = parent.find('[name=meetingType]').find('option:checked').text();//现实的内容
                            meetingTypeId = meetingTypeValue.split("_")[0];
                            meetingTypeCode = meetingTypeValue.split("_")[1];

                            $("#meetingTypeId").val(meetingTypeId);
                            $("#meetingTypeCode").val(meetingTypeCode);
                            $("#meetingTypeName").val(meetingTypeName);
                            $("#meetingId").val(meetingIdForm);
                            $("#formOperType").val(formOperType);
                            $('#mainTitle').text(meetingTypeName + '会议').show();
                            if ('GD' == meetingTypeCode) {
                                $('#stockholderDiv').show();
                            } else {
                                $('#stockholderDiv').hide();
                            }
                            layer.close(meetingTypeSelectLayer);
                        }
                    });
                }
            };

            //页面刚进来，需要先选择会议类型，获取对应会议类型ID Code Name
            var meetingTypeId,
                meetingTypeCode,
                meetingTypeName,
                meetingIdForm = common.getQueryVariable('dataObj') || common.uuid('', 32);
            //操作类型，add:新增；edit：编辑
            var formOperType = common.getQueryVariable('formOperType');
            var flowStatusId = common.getQueryVariable('flowStatusId');
            //是否异常
            var exceptionFlag = false;
            var editFlowStatusId = common.getQueryVariable('flowStatusId');
            if (common.getQueryVariable('meetingId')) {
                meetingTypeId = common.getQueryVariable('meetingTypeId');
                meetingTypeCode = common.getQueryVariable('meetingTypeCode');
                meetingTypeName = common.getQueryVariable('meetingTypeName');


                meetingIdForm = common.getQueryVariable('meetingId') || common.uuid('', 32);
                $("#meetingTypeId").val(meetingTypeId);
                $("#meetingTypeCode").val(meetingTypeCode);
                $("#meetingTypeName").val(meetingTypeName);
                $("#meetingId").val(meetingIdForm);
                $("#formOperType").val(formOperType);
                $('#mainTitle').text(meetingTypeName + '会议').show();

                //隐藏新建按钮
                $('#addNewMeeting').hide();
                if (meetingTypeCode == 'GD') {
                    $("#stockholderDiv").show();
                } else {
                    $("#stockholderDiv").hide();
                }
                $("#formMeetingClose").show();
            } else {
                //会议类型选择
                mainFunc.meetingTypeSelectLayer();
                $("#formMeetingClose").hide();
            }

            var reasonMap = {};
            var reasonList = [];
            var approvalFlagMap = {};
            var approvalFlagList = [];
            var passFlagMap = {};
            var attendStatusMap = {};
            var attendStatusList = [];
            var deliberationResultMap = {};
            var deliberationResultList = [];
            var meetingFileTypeMap = {};
            var meetingFileTypeList = [];
            var participantsTypeMap = {};
            var participantsTypeList = [];
            var meetingFormMap = {};
            var meetingFormReg = RegExp(/(视频|电话|电视|传签)/);
            //表决弹窗
            var bj_index_edit;
            //议题弹窗
            var yt_index_edit;
            var formMeetingCloseIndex = window.parent.layer.index;
            // --------------------------------下拉框-----------------------------------
            //会议类型获取URL
            var meetingTypeUrl = baseUrl + "meetingmgr/tiolMeetingType/getTiolMeetingTypeSelect";
            //审议形式获取URL
            var deliberationModeUrl = baseUrl + "meetingmgr/tiolMeetingFormAlias/getTiolMeetingFormAliasList";
            //字典获取URL
            var dictUrl = baseUrl + "sysmgr/dicts/selectDictListByPcode";
            //人员选择
            var memberChooseUrl = baseUrl + "meetingmgr/tiolCompanyGroup/pageQueryEnableTiolMeetingMemberGroup";
            //股东选择
            var stockChooseUrl = baseUrl + "meetingmgr/enterpriseShareholder/selectTiolEnterpriseShareholderList";
            //保存人员URL
            var saveMemberInfoUrl = baseUrl + "meetingmgr/tiolMeeting/saveMemberInfo";
            //批量保存股东URL
            var saveStockInfoUrl = baseUrl + "meetingmgr/tiolAttendStock/saveStockInfos";

            var saveSingleStockInfoUrl = baseUrl + "meetingmgr/tiolAttendStock/saveSingleStockInfo";
            //保存出席人员信息
            var saveAttendInfoUrl = baseUrl + "meetingmgr/tiolAttendee/saveTiolAttendeeInfo";
            var keyValueTypeMap = {
                "meetingType": {
                    "url": meetingTypeUrl,
                    "key": "meetingType",
                    "value": "meetingTypeName"
                },
                "deliberationMode": {
                    "url": deliberationModeUrl,
                    "key": "meetingFormId",
                    "value": "meetingFormName"
                },
                "dict": {
                    "url": dictUrl,
                    "key": "sdCode",
                    "value": "sdName"
                }
            };

            var selectDictMap = {
                "deliberationResult": {
                    "kvType": keyValueTypeMap.dict,
                    "param": {
                        "dictPCode": "DELIBERATIONRESULT"
                    }
                },
                /*  "attendStatus":{
                     "kvType": keyValueTypeMap.dict,
                     "param": {
                         "dictPCode": "attendStatus"
                     }
                 }, */
                // "reason":{
                //     "kvType": keyValueTypeMap.dict,
                //     "param": {
                //         "dictPCode": "reason"
                //     }
                // },
                "meetingType": {
                    "kvType": keyValueTypeMap.meetingType
                },
                "deliberationMode": {
                    "kvType": keyValueTypeMap.deliberationMode
                },
                "meetingMode": {
                    "kvType": keyValueTypeMap.dict,
                    "param": {
                        "dictPCode": "MEETING_REVIEW_MODE"
                    }
                },
                "exigence": {
                    "kvType": keyValueTypeMap.dict,
                    "param": {
                        "dictPCode": "msRank"
                    }
                },
                "passFlag": {
                    "kvType": keyValueTypeMap.dict,
                    "param": {
                        "dictPCode": "PASSFLAG"
                    }
                },
                /* "subjectType":{
                    "kvType": keyValueTypeMap.dict,
                    "param": {
                        "dictPCode": "subjectType"
                    }
                }, */
                "resultType": {
                    "kvType": keyValueTypeMap.dict,
                    "param": {
                        "dictPCode": "resultType"
                    }
                },
                "meetingFileType": {
                    "kvType": keyValueTypeMap.dict,
                    "param": {
                        "dictPCode": "materialType"
                    }
                },
                "subjectFileType": {
                    "kvType": keyValueTypeMap.dict,
                    "param": {
                        "dictPCode": "subjectMaterialType"
                    }
                },
                "participantsType": {
                    "kvType": keyValueTypeMap.dict,
                    "param": {
                        "dictPCode": "attendStatus"
                    }
                },
            };

            /*  form.on('select(meetingTypeFilter)', function(data){
                 var meetingTypeInfo=data.value.split("_");
                 var meetingTypeId=meetingTypeInfo[0];
                 var meetingTypeCode=meetingTypeInfo[1];
                 var curMeetingTypeName=data.elem[data.elem.selectedIndex].text;
                 $("#meetingTypeId").val(meetingTypeId);
                 $("#meetingTypeCode").val(meetingTypeCode);
                 $("#meetingTypeName").val(curMeetingTypeName);
                 //生成会议编码
                 createMeetingCode();
             }); */

            form.on('select(meetingModeFilter)', function (data) {
                $("[name='meetingModeName']").val($(data.elem).find("[value='" + data.value + "']").text());
                $("#deliberationMode").empty();
                common.selectDataSet({
                    elem: $('[name=deliberationMode]'),
                    url: deliberationModeUrl + "?meetingTypeId=" + $("#meetingTypeId").val() + "&meetingMode=" + data.value,
                    responseList: 'list',
                    method: 'get',//默认为get
                    optionText: 'meetingFormName',
                    optionValue: 'meetingFormAliasId',
                    success: function (data) {
                        if (data.list.length == 0) {
                            layer.alert("请联系管理员在审议别名模块为当前会议类型配置会议形式和审议形式关联关系!");
                            return;
                        }
                        form.render('select');
                        if (data && data.list && data.list.length > 0) {
                            $.map(data.list, function (item) {
                                meetingFormMap[item.meetingFormAliasId] = item.meetingFormGzwName;
                            });
                        }
                    }
                });
            });
            form.on('select(deliberationModeFilter)', function (data) {
                var meetingMode = $("#meetingMode").val();
                if (meetingMode == '') {
                    layer.alert("请先选择会议形式");
                    return;
                }
                if (data.elem.selectedOptions[0].text == "现场会议") {
                    $("#meetingAddrSpan").show();
                    $('#meetingAddr').attr("lay-verify", "meetingAddr");
                } else {
                    $("#meetingAddrSpan").hide();
                    $("#meetingAddr").removeAttr("meetingAddr");
                }
                // if (meetingFormMap[data.value] != null && meetingFormMap[data.value].match(meetingFormReg)) {
                //     $("#meetingAddrSpan").hide();
                // } else {
                //     $("#meetingAddrSpan").show();
                // }
                $("[name='meetingFormGzwName']").val(meetingFormMap[data.value]);
                $("[name='deliberationName']").val($(data.elem).find("[value='" + data.value + "']").text());
            });
            /*  form.on('select(exigenceFilter)', function(data){
                 $("[name='exigenceName']").val($(data.elem).find("[value='" + data.value + "']").text());
             }); */
            /*  form.on('select(subjectTypeFilter)', function(data){
                 $("[name='deliberationName']").val($(data.elem).find("[value='" + data.value + "']").text());
             }); */
            form.on('select(resultTypeFilter)', function (data) {
                $("[name='resultTypeName']").val($(data.elem).find("[value='" + data.value + "']").text());
            });
            form.on('select(passFlagFilter)', function (data) {
                $("[name='passFlagName']").val($(data.elem).find("[value='" + data.value + "']").text());
                if(agree >0 && disagree == 0 && notFill == 0 && $("select[name=passFlag]").val() === "0"){
                                                layer.alert("表决情况中均为同意，请编辑表决情况的审议意见！");
                                            }else if (agree == 0 && disagree > 0 && notFill == 0 && $("select[name=passFlag]").val() === "1") {
                                                layer.alert("表决情况中均为非同意，请编辑表决情况的审议意见！");
                                            }
            });
            form.on('select(approvalFlagFilter)', function (data) {
                $("[name='approvalFlagName']").val($(data.elem).find("[value='" + data.value + "']").text());
            });
            form.on('select(positionFilter)', function (data) {
                $("[name='positionName']").val($(data.elem).find("[value='" + data.value + "']").text());
            });

            common.selectDataSet({
                elem: $('[name=passFlag]'),
                url: 'sysmgr/dicts/selectDictListByPcode?dictPCode=PASSFLAG',
                responseList: 'list',
                method: 'get',//默认为get
                optionText: 'sdName',
                optionValue: 'sdCode',
                success: function (data) {
                    if (data && data.list && data.list.length > 0) {
                        $.map(data.list, function (item) {
                            passFlagMap[item.sdCode] = item;
                        });
                    }
                    form.render('select');
                }
            });

            // --------------------------------下拉框END--------------------------------
            // --------------------------------初始化--------------------------------

            common.fetchGet('sysmgr/dicts/selectDictListByPcode?dictPCode=materialType', function (data) {
                if (data && data.list && data.list.length > 0) {
                    meetingFileTypeList = data.list;
                    $.map(data.list, function (item) {
                        meetingFileTypeMap[item.sdCode] = item;
                    });
                }
            });
            var eventHandle = {
                initDict: function (array, parent, where, json, callback) {
                    $.map(array, function (value) {
                        var dictId = value;
                        var dictConfigInfo = selectDictMap[dictId];
                        if (!dictConfigInfo) return false;
                        var queryParam = '?';
                        $.map(dictConfigInfo.param, function (value, key) {
                            queryParam += key + '=' + value + '&';
                        });
                        if (where && dictConfigInfo.where) {
                            queryParam += "&where=" + where;
                        }
                        var option = {
                            elem: $('#' + dictId),
                            url: dictConfigInfo.kvType.url + queryParam,
                            method: 'get',
                            responseList: 'list',
                            optionText: dictConfigInfo.kvType.value,
                            optionValue: dictConfigInfo.kvType.key,
                            success: function (obj) {
                                form.render("select");
                                if (typeof (callback) == "function") {
                                    callback();
                                }
                            }
                        }
                        if (json) {
                            var selectData = [];
                            $.each(json, function (i) {
                                $.map(json[i], function (value, key) {
                                    var data = {};
                                    data[dictConfigInfo.kvType.key] = key;
                                    data[dictConfigInfo.kvType.value] = value;
                                    selectData.push(data);
                                })
                            })
                            option.loadData = selectData;
                            option.loadSuccess = function (obj) {

                                if (obj && obj.length == 1) {
                                    this.elem.val(obj[0][this.optionValue]);
                                    form.render();
                                }
                            }
                        }
                        common.selectDataSet(option);
                    });
                },
                shqkInit: function (subjectId) {
                    common.fetchPost('meetingmgr/tiolDeliberation/selectTiolDeliberationTj?subjectId=' + subjectId, null, function (res) {
                        $('input[name=bjqk]').val(res.object);
                        form.render();
                    }, function () { });
                },
                subjectPageInit: function (meetingId) {
                    //if(meetingId!=null&&meetingId!=undefined&&meetingId!=''){
                    table.render(common.tableInitParams({//议题清单
                        elem: '#ytList',
                        url: baseUrl + 'meetingmgr/tiolSubject/selectTiolSubjectPageByMeetingId',
                        where: { "meetingId": meetingId },
                        id: 'subjectTableReload',
                        method: 'post',
                        toolbar: '#ytListToolBar',
                        defaultToolbar: [],
                        // height: 'full-200',
                        height: false,
                        cols: [
                            [
                                { type: 'checkbox' },
                                { type: 'numbers', title: '序号' },
                                // {field: 'motionName', title: '议案名称'},
                                { field: 'subjectName', title: '议题名称', minWidth: 200 },
                                { field: 'soName', title: '提出部门', minWidth: 120, align: "center" },
                                { field: 'motionCreateTime', title: '提交日期', width: 120, align: "center" },
                                {
                                    field: 'passFlag', title: '审议情况', align: "center", width: 90,
                                    templet: function (rowData) {
                                        if (rowData['passFlag'] && passFlagMap[rowData['passFlag']]) {
                                            if(rowData['passFlag'] == 1){
                                                return '<span class="green">'+passFlagMap[rowData['passFlag']]['sdName'] +'</span>'
                                            }else if(rowData['passFlag'] == 0){
                                                return '<span class="red">'+passFlagMap[rowData['passFlag']]['sdName'] +'</span>'
                                            }else{
                                                return '<span class="green3">'+passFlagMap[rowData['passFlag']]['sdName'] +'</span>'
                                            }
                                        } else {
                                            return ''
                                        }
                                    }
                                }, { field: '', title: '操作', width: 125, toolbar: '#ytListOper', fixed: 'right', align: "center" }
                            ]
                        ]
                    }));
                    table.render(common.tableInitParams({//会议资料
                        elem: '#meetingFile',
                        id: 'meetingFileTableReload',
                        url: baseUrl + 'dfsmgr/file/getFileByResId?id=' + meetingId,
                        // data:meetingFile,
                        method: 'post',
                        toolbar: '#meetingFileToolBar',
                        defaultToolbar: [],
                        height: 'full-200',
                        height: false,
                        cols: [
                            [
                                { type: 'checkbox' },
                                { type: 'numbers', title: '序号' },
                                {
                                    field: 'fiFileType', title: '资料类型', width: 120, align: "center", templet: function (rowData) {
                                        if (meetingFileTypeMap[rowData['fiFileType']] != null && meetingFileTypeMap[rowData['fiFileType']] != undefined) {
                                            return meetingFileTypeMap[rowData['fiFileType']]['sdName'];
                                        } else {
                                            return '其他';
                                        }

                                        // var html='';
                                        // switch(rowData['fiFileType']){ // 0 会议通知 1 会议纪要 2 会议记录
                                        //     case "NOTICE":html='会议通知';break;
                                        //     case "SUMMARY":html='会议纪要';break;
                                        //     case "RECORD":html='会议记录';break;
                                        //     case "RESOLUTION":html='会议决议';break;
                                        //     default:html='其他';break;
                                        // }
                                        // return html;
                                    }
                                },
                                {
                                    field: 'fiName',
                                    title: '文件名称',
                                    minWidth: 150,
                                    templet: function (rowData) {
                                        return rowData.fiName + '.' + rowData.fiSuffix;
                                    }
                                },
                                // {field: 'fiUploadTime', title: '上传时间'},
                                /*  {field: 'fiUploadTime', title: '上传时间',sort:true
                                     ,templet:function (rowData) {return util.toDateString(rowData.effectTime, 'yyyy-MM-dd');
                                     }}, */
                                // {field: 'ggMemo', title: '备注'},
                                {
                                    field: '', title: '操作', fixed: 'right', width: 120, align: "right", templet: function (rowData) {
                                        if (meetingFileTypeMap[rowData['fiFileType']] != null && meetingFileTypeMap[rowData['fiFileType']] != undefined && meetingFileTypeMap[rowData['fiFileType']]['sdName'] == '会议纪要') {
                                            return '<a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a> <a class="layui-btn layui-btn-xs layui-btn-warm" lay-event="load">预览</a>'
                                        } else {
                                            return '<a class="layui-btn layui-btn-xs layui-btn-warm" lay-event="load">预览</a>'
                                        }

                                    }
                                },
                            ]
                        ],
                        done: function (data) {
                            //文件排序，并且数据保存到全局
                            fileSortData = common.arraySort(data.data ? data.data : [], 'ggSort');
                            // common.buttonLimit();
                        }
                    }));
                    // }
                }
            };
            // 日期时间选择器
            laydate.render({
                elem: '#meetingTime',
                type: 'date',
                range: true,
                trigger: 'click',
                change: function (value, date, endDate) {
                    $('#meetingYear')[0].value = value.split("-")[0];
                    createMeetingCode();
                }
            });
            /* laydate.render({
                elem: '#releaseTime',
                type: 'date',
                range: false
            }); */
            // 版本号
            /*  laydate.render({
                 elem: '#meetingYear',
                 type: 'year',
                 value:new Date(),
                 done: function (value, date, endDate) {
                     $('#meetingYear')[0].value = value;
                     createMeetingCode();
                 }
             }); */

            //eventHandle.initDict(['meetingType','deliberationMode','meetingMode','exigence','passFlag','subjectType','resultType','position']);
            eventHandle.initDict(['meetingType', 'meetingMode', 'position']);
            if (meetingIdForm && formOperType == "edit") {
                common.fetchPost('meetingmgr/tiolMeeting/selectTiolMeetingById', { meetingId: meetingIdForm }, function (data) {
                    if (data.success) {
                        loadDeliberationMode(data.object.meetingTypeId, data.object.meetingMode);
                        loadFormValue(data);
                        //$("#meetingType").attr("disabled", "true");
                        form.render();
                    } else {
                        layer.alert("查询会议信息失败:" + data.resultMessage);
                    }
                }, function () {
                    layer.alert('查询会议信息失败');//失败后提示
                });
            } else {
                /* var userInfo = JSON.parse(common.getCookie('userInfo'));
                var seComeCode = userInfo.currEnterpriseVo.seComcode;
                $("#seComcode").val(seComeCode); */
            }
            eventHandle.subjectPageInit(meetingIdForm);
            var userInfo = JSON.parse(common.getCookie('userInfo'));
            var curSeId, seComeCode;
            if (userInfo) {
                curSeId = userInfo.currEnterpriseVo.seId;
                seComeCode = userInfo.currEnterpriseVo.seComcode;
            }

            $("#seComcode").val(seComeCode);
            $("#curSeId").val(curSeId);
            $('#formMeetingClose').unbind('click').bind('click', function (e) {
                window.parent.layer.close(formMeetingCloseIndex);
                return false;
            });
            //保存
            $('#saveMeetingAll').unbind('click').bind('click', function (e) {



                layer.confirm('确定保存会议？', function (index) {
                    //todo: 提交事件 待补充
                    $("[lay-filter='formMeetingAdd']").click();

                    layer.close(index);
                });

                return false;
            });
            //新建
            $('#addNewMeeting').off().on('click', function () {
                layer.confirm('将重置表单，确认新建？', function () {
                    // mainFunc.meetingTypeSelectLayer();
                    //触发会议保存事件
                    $("[lay-filter='formMeetingAdd']").click();

                    //重载新增页面
                    window.location.reload();
                });
            });
            //提交
            $('#submitMeeting').off().on('click', function () {
                if (formOperType == null || formOperType == 'add') {
                    layer.confirm('确定提交会议？', function (index) {
                        $("[lay-filter='formMeetingSubmit']").click();
                        layer.close(index);
                    });
                } else {
                    layer.confirm('确定提交会议？', function (index) {
                        //todo: 提交事件 待补充
                        var layerLoader = common.layerLoader();
                        var exceptionFlag = 0;
                        layer.close(index);
                        common.fetchGet('meetingmgr/tiolMeeting/validMeetingException?meetingId=' + meetingIdForm, function (res) {
                            if (res.success) {
                                if (res.object == "success") {
                                    $("#exceptionFlag").val(0);
                                    $("[lay-filter='formMeetingSubmit']").click();
                                } else if (res.object == "meetingEx") {
                                    layer.close(layerLoader);
                                    layer.confirm('会议召开异常:会议出席人数不足1/2,是否提交?', function (innerConfirm) {
                                        $("#exceptionFlag").val(1);
                                        $("[lay-filter='formMeetingSubmit']").click();
                                        layer.close(innerConfirm);
                                    })
                                } else {
                                    layer.close(layerLoader);
                                    layer.alert(res.resultMessage);
                                }
                            } else {
                                layer.close(layerLoader);
                                layer.alert(res.resultMessage);
                            }
                        });
                    });
                }
            });
            function loadFormValue(data) {
                data.object.meetingType = data.object.meetingTypeId + "_" + data.object.meetingTypeCode;
                data.object.meetingTime = data.object.meetingTime + " - " + data.object.meetingTimeEnd;
                data.object.formOperType = 'edit';
                formOperType = 'edit';
                if (data.object.flowStatusId == null || data.object.flowStatusId == "") {
                    data.object.flowStatusId = editFlowStatusId ? flowStatusId : "";
                } else {
                    flowStatusId = data.object.flowStatusId;
                }
                form.val("meetingForm", data.object);
                meetingIdForm = data.object.meetingId;
                meetingTypeId = data.object.meetingTypeId
                meetingTypeCode = data.object.meetingTypeCode
                meetingTypeName = data.object.meetingTypeName
            }
            function initFormValue(data) {
                form.val("meetingForm", data.object);
            }
            function loadDeliberationMode(meetingTypeId, meetingMode) {
                common.selectDataSet({
                    elem: $('[name=deliberationMode]'),
                    url: deliberationModeUrl + "?meetingTypeId=" + meetingTypeId + "&meetingMode=" + meetingMode,
                    responseList: 'list',
                    method: 'get',//默认为get
                    optionText: 'meetingFormName',
                    optionValue: 'meetingFormAliasId',
                    success: function (data) {
                        form.render('select');
                    }
                });
            }
            // --------------------------------初始化END--------------------------------

            function createMeetingCode() {
                getMeetingSerialNumber();
                var serialNumber = $('#serialNumber').val();
                $('#meetingCode').val($('#seComcode').val() + "-" + $('#meetingTypeCode').val() + $('#meetingYear').val() + $('#serialNumber').val());
            }

            function getMeetingSerialNumber() {
                var userInfo = JSON.parse(common.getCookie('userInfo'));
                var seComeCode = userInfo.currEnterpriseVo.seComcode;
                if ($('#seComcode').val() == undefined || $('#seComcode').val() == '' || $('#seComcode').val() == null) {
                    $('#seComcode').val(seComeCode);
                }
                var meetingTypeCode = $('#meetingTypeCode').val();
                var meetingYear = $('#meetingYear').val();
                common.fetchPost('meetingmgr/tiolMeeting/findSerialNumberByMap',
                    {
                        meetingId: meetingIdForm,
                        seComcodeEq: seComeCode,
                        meetingTypeCode: meetingTypeCode,
                        meetingYear: meetingYear,
                        type: "meeting"
                    }
                    , function (data) {
                        if (data.success) {
                            $('#serialNumber').val(data.object);
                        } else {
                            layer.alert("获取流水号失败:" + data.resultMessage);
                        }
                    }, function () {
                        layer.alert('获取流水号失败');//失败后提示
                    }, false);
            }
            var reg = /^\s*$/;
            form.verify({
                meetingName: function (value, item) {
                    if (reg.test(value)) {
                        return "会议名称不能为空!";
                    }
                },
                meetingTime: function (value, item) {
                    if (reg.test(value)) {
                        return "会议时间不能为空!";
                    }
                },
                meetingAddr: function (value, item) {
                    var meetingFormGzwName = $("[name=meetingFormGzwName]").val();
                    if (reg.test(value) && !meetingFormGzwName.match(meetingFormReg)) {
                        return "会议地点不能为空!";
                    }
                },
                meetingMode: function (value, item) {
                    if (reg.test(value)) {
                        return "会议形式不能为空!";
                    }
                },
                convenor: function (value, item) {
                    if (reg.test(value)) {
                        return "召集人不能为空!";
                    }
                },
                moderatorName: function (value, item) {
                    if (reg.test(value)) {
                        return "主持人不能为空!";
                    }
                },
                attendeeNames: function (value, item) {
                    if (reg.test(value)) {
                        return "出席人员不能为空!";
                    }
                },
                deliberationMode: function (value, item) {
                    if (reg.test(value)) {
                        return "审议形式不能为空!";
                    }
                },
                deliberationPersonnel: function (value, item) {
                    if (reg.test(value)) {
                        return "姓名不能为空!";
                    }
                },
                /*  attendStatus: function(value,item){
                     if(reg.test(value)){
                         return "参会状态不能为空!";
                     }
                 }, */
                deliberationResult: function (value, item) {
                    if (reg.test(value)) {
                        return "审议结果不能为空!";
                    }
                },
                subjectName: function (value, item) {
                    if (reg.test(value)) {
                        return "议题名称不能为空!";
                    }
                },
                /*subjectCode: function(value,item){
                    if(reg.test(value)){
                        return "议题编码不能为空!";
                    }
                },
                 approvalFlag: function(value,item){
                    if(reg.test(value)){
                        return "是否上报国资委不能为空!";
                    }
                }, */
                passFlag: function (value, item) {
                    if (reg.test(value) && $('#syjg').css('display') == 'block') {
                        return "审议结果不能为空!";
                    }
                },
                subjectResult: function (value, item) {
                    if (reg.test(value)) {
                        return "审议结论不能为空!";
                    }
                }
            });
            // --------------------------------保存表单--------------------------------
            form.on('submit(deliberationAdd)', function (obj) {
                var val = obj.field.deliberationPersonnel;
                if (val) {
                    obj.field.meetingId = $("#meetingId").val();
                    // obj.field.subjectId =$("#subjectId").val();
                    common.fetchPost('meetingmgr/tiolDeliberation/saveTiolDeliberationInfo', obj.field, function (data) {
                        if (data.success) {

                            layer.alert('保存审议结果成功');
                            eventHandle.shqkInit(obj.field.subjectId);
                            table.reload('bjTable', {
                                page: {}
                                , where: {
                                    subjectId: obj.field.subjectId
                                }
                            });
                            layer.close(bj_index_edit);
                        } else {
                            layer.alert("保存审议结果失败:" + data.resultMessage);
                        }
                    }, function () {
                        layer.alert('保存审议结果失败');//失败后提示
                    });
                }
                return false;
            });

            form.on('submit(formMeetingAdd)', function (obj) {
                var val = $("#meetingId").val();
                var meetingSaveLoader = common.layerLoader();
                if (formOperType == "edit") {//编辑时的保存
                    common.fetchPost('meetingmgr/tiolMeeting/saveTiolMeetingInfo', obj.field, function (data) {
                        layer.close(meetingSaveLoader);
                        if (data.success) {
                            loadFormValue(data);
                            layer.alert('更新会议信息成功', { icon: 6 });
                            window.parent.layer.close(formMeetingCloseIndex);

                            //如果是新建入口 则不关闭，编辑入口就关闭
                            setTimeout(function () {
                                if (meetingIdForm && formOperType == "edit") {
                                    parent.$('.newIframeFixedDom', parent.document).prev().prev().click();
                                }
                            }, 500);

                        } else {
                            layer.alert("保存会议信息失败:" + data.resultMessage, { icon: 5 });
                        }
                    }, function () {
                        layer.alert("保存会议信息失败:", { icon: 5 });
                        layer.close(meetingSaveLoader);
                    });

                } else {//新增时的保存
                    common.fetchPost('meetingmgr/tiolMeeting/saveTiolMeetingInfo', obj.field, function (data) {
                        layer.close(meetingSaveLoader);
                        if (data.success) {
                            loadFormValue(data);
                            layer.alert('保存会议信息成功!', { icon: 6 });
                        } else {
                            layer.alert('保存会议信息失败:' + data.resultMessage, { icon: 5 });
                        }
                    }, function () {
                        layer.alert("保存会议信息失败:", { icon: 5 });
                        layer.close(meetingSaveLoader);
                    });
                }
                return false;
            });
            form.on('submit(formMeetingSubmit)', function (obj) {
                var val = $("#meetingId").val();
                var meetingSaveLoader = common.layerLoader();
                obj.field.flowStatusId = (flowStatusId == null || flowStatusId == '') ? editFlowStatusId : flowStatusId;
                common.fetchPost('meetingmgr/tiolMeeting/saveAndSubmitTiolMeetingInfo', obj.field, function (data) {
                    layer.close(meetingSaveLoader);
                    if (data.success) {
                        if (data.object.error != null && data.object.error == "requireEx") {
                            layer.alert(data.resultMessage);
                        } else {
                            loadFormValue(data);
                            layer.alert('提交会议信息成功!下一步到已提交和报送', { icon: 6 });
                        }
                    } else {
                        layer.alert('提交会议信息失败:' + data.resultMessage, { icon: 5 });
                    }
                }, function () {
                    layer.alert("提交会议信息失败:", { icon: 5 });
                    layer.close(meetingSaveLoader);
                });
                return false;
            });
            form.on('submit(formAttendeeAdd)', function (obj) {
                var val = obj.field.attendeeName;
                if (val) {
                    obj.field.meetingId = $("#meetingId").val();
                    obj.field.participantsType = "ATTEND";
                    var layerLoader = common.layerLoader();
                    common.fetchPost('meetingmgr/tiolAttendee/saveTiolAttendeeInfo', obj.field, function (data) {
                        if (data.success) {
                            layer.close(layerLoader);
                            layer.alert('保存出席人成功');
                            table.reload('attendee-edit-table', {
                                page: {}
                                , where: {
                                    meetingId: meetingIdForm,
                                    participantsType: "ATTEND"
                                }
                            });
                        } else {
                            layer.close(layerLoader);
                            layer.alert("保存出席人失败:" + data.resultMessage);
                        }

                    }, function () {
                        layer.close(layerLoader);
                        layer.alert('保存出席人失败');//失败后提示

                    });
                }
                return false;
            });

            form.on('submit(formAbsentAdd)', function (obj) {
                var val = obj.field.attendeeName;
                if (val) {
                    obj.field.meetingId = $("#meetingId").val();
                    obj.field.participantsType = "ABSENT";
                    var layerLoader = common.layerLoader();
                    common.fetchPost('meetingmgr/tiolAttendee/saveTiolAttendeeInfo', obj.field, function (data) {
                        if (data.success) {
                            layer.alert('保存缺席人成功');
                            table.reload('absentTableReload', {
                                page: {}
                                , where: {
                                    meetingId: meetingIdForm,
                                    participantsType: "ABSENT"
                                }
                            });
                        } else {
                            layer.alert("保存缺席人失败:" + data.resultMessage);
                        }
                        layer.close(layerLoader);
                    }, function () {
                        layer.alert('保存缺席人失败');//失败后提示
                        layer.close(layerLoader);
                    });
                }
                return false;
            });

            form.on('submit(formAttenderAdd)', function (obj) {

                var val = obj.field.attenderSuName;
                if (val) {
                    obj.field.meetingId = $("#meetingId").val();
                    var layerLoader = common.layerLoader();
                    common.fetchPost('meetingmgr/tiolAttender/saveTiolAttenderInfo', obj.field, function (data) {
                        if (data.success) {
                            layer.alert('保存常设列席成功');
                            table.reload('attenderTableReload', {
                                page: {}
                                , where: {
                                    meetingId: meetingIdForm
                                }
                            });
                        } else {
                            layer.alert("保存常设列席失败:" + data.resultMessage);
                        }
                        layer.close(layerLoader);
                    }, function () {
                        layer.alert('保存常设列席失败');//失败后提示
                        layer.close(layerLoader);
                    });
                }
                return false;
            });

            form.on('submit(formSubjectEdit)', function (obj) {

                if(agree >0 && disagree == 0 && notFill == 0 && $("select[name=passFlag]").val() === "0"){
                                                layer.alert("表决情况中均为同意，请编辑表决情况的审议意见！");
                                                return false;
                                            }else if (agree == 0 && disagree > 0 && notFill == 0 && $("select[name=passFlag]").val() === "1") {
                                                layer.alert("表决情况中均为非同意，请编辑表决情况的审议意见！");
                                                return false;
                                            }

                var val = obj.field.subjectCode;
                if (val) {
                    if (obj.field.passFlag && !obj.field.passFlagName) {
                        obj.field.passFlagName = passFlagMap[obj.field.passFlag]['sdName'];
                    }
                    obj.field.meetingId = $("#meetingId").val();
                    var layerLoader = common.layerLoader();
                    common.fetchPost('meetingmgr/tiolSubject/saveTiolSubjectInfo', obj.field, function (data) {
                        if (data.success) {
                            layer.close(yt_index_edit);
                            layer.alert('保存议题成功');
                            table.reload('subjectTableReload', {
                                page: {}
                                , where: {
                                    meetingId: meetingIdForm
                                }
                            });
                        } else {
                            layer.alert("保存议题失败:" + data.resultMessage);
                        }
                        layer.close(layerLoader);
                    }, function () {
                        layer.alert('保存议题失败');//失败后提示
                        layer.close(layerLoader);
                    });
                }
                return false;
            });


            // --------------------------------保存表单END--------------------------------
            function stockholderEditLayer(obj) {
                var objParam = $.extend({
                    title: '编辑',
                    offset: '10px',
                    area: ['80%', '90%'],//高度自适应
                    btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                    btnAlign: 'c',
                }, obj);

                var index_qx = layer.open({
                    offset: objParam.offset,
                    title: objParam.title,
                    area: objParam.area,
                    type: 1,//页面层
                    shadeClose: false,
                    btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                    btnAlign: objParam.btnAlign,
                    yes: function () {
                        layer.close(index_qx)
                        common.fetchPost('meetingmgr/tiolAttendStock/selectStockNameInfo', { "meetingId": meetingIdForm }, function (res) {
                            if (res.success) {
                                $('[name=stockName]').val(res.object.stockName);
                            } else {
                                layer.alert(err.resultMessage);
                            }
                        }, function (err) {
                            layer.alert(err.resultMessage);
                        })
                        return false;
                    },
                    content: $('.stockholder-edit-layer').html(),
                    success: function (obj) {
                        table.render(common.tableInitParams({
                            elem: $(obj.selector).find('#stockholder-edit-table'),
                            id: "stockholder-edit-table",
                            url: baseUrl + 'meetingmgr/tiolAttendStock/selectTiolAttendStockList?meetingId=' + meetingIdForm,
                            contentType: 'text/plain',
                            method: 'get',
                            // request:null,
                            toolbar: '#stockholderToolBar',
                            // data:qxryData,
                            cellMinWidth: 60,
                            height: 'full-220',
                            defaultToolbar: [],
                            cols: [
                                [
                                    { type: 'checkbox' },
                                    { type: 'numbers', title: '序号' },
                                    { field: 'stockName', title: '出席股东', minWidth: 120 },
                                    { field: 'ratio', title: '持股比例(%)', minWidth: 120 },
                                    { field: 'quantity', title: '持股数量(股)', minWidth: 120 },
                                    { field: 'amount', title: '认缴金额(元)', minWidth: 120 },
                                    { field: '', title: '操作', width: 80, toolbar: '#stockholder-edit-table-oper', fixed: 'right' }
                                ]
                            ]
                        }));
                        table.on('toolbar(stockholder-edit-table)', function (obj) {
                            var checkStatus = table.checkStatus(obj.config.id);
                            var data = obj.config;
                            var obj1;
                            switch (obj.event) {
                                case 'stockAdd':
                                    var edit_attend = layer.open({
                                        title: '新增出席股东',
                                        type: 1,//页面层
                                        area: ['60%', '80%'],
                                        shadeClose: false,
                                        btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                                        btnAlign: 'c',
                                        content: $('.stockholderLayer').html(),//加载该区域的html
                                        success: function (obj) {
                                            obj1 = obj;
                                            var parent = $(obj.selector);
                                            parent.find('#seNameSelect').on("click", function (e) {
                                            var changeSLayer = layer.open({
                                                type: 1,
                                                title: "选择企业",
                                                content: $(".changeShareholderLayer").html(),
                                                area: ['400px', '500px'],
                                                btnAlign: "c",
                                                btn: ['<i class="fa fa-check-circle"></i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>关闭'],
                                                yes: function (index, layero) {
                                                    if (parent.find('#seNameSelect').val() == "") {
                                                        layer.msg("请选择股东");
                                                        return;
                                                    }
                                                    layer.close(changeSLayer)

                                                },
                                                btn2: function (index, layero) {
                                                    layer.close(index);
                                                },
                                                success: function (layero, index) {
                                                    common.fetchGet('sysmgr/sysEnterprise/selectAllDescendantNodeFromRootNode?treeType=enterpriseTree&rootId=-1', function (res) {
                                                        var eleTreeId = tree.render({
                                                            showLine: true,
                                                            elem: '#changeShareholderTree',
                                                            "expandOnClickNode": true,
                                                            data: common.arrayToTreeJson(res.list || [], "id", "pid", "children"),
                                                            // defaultExpandAll: true,
                                                            request: {
                                                                name: "title",
                                                                key: "id",
                                                                children: "children",
                                                                checked: "checked",
                                                                disabled: "disabled",
                                                                isLeaf: "isLeaf",
                                                                extendAttr: "extendAttr"
                                                            },
                                                            lazy: false,
                                                            response: {// 对于后台数据重新定义名字
                                                                dataName: "list"
                                                            },
                                                            searchNodeMethod: function (value, data) {
                                                                if (!value) return true;

                                                                return data.title.indexOf(value) !== -1;
                                                            }
                                                        });
                                                        $('#changeShareholderTree').find('.eleTree-node-content-label').eq(0).trigger('click');
                                                    }, false, false);

                                                    tree.on("nodeClick(changeShareholderTree)", function (obj) {
                                                        parent.find('#hideSeId').val(obj.data.currentData.id);
                                                        parent.find('#seNameSelect').val(obj.data.currentData.name);
                                                    });
                                                }
                                            });
                                        });
                                        },
                                        yes: function () {
                                            var parent = $(obj1.selector);
                                            if (parent.find('[name=stockName]').val() == '') {
                                                layer.alert('请输企业名称');
                                                return false;
                                            }
                                            if (parent.find('[name=ratio]').val() == '') {
                                                layer.alert('请输持股比例');
                                                return false;
                                            }
                                            var layerLoader = common.layerLoader();

                                            common.fetchPost(saveSingleStockInfoUrl, {
                                                stockName: parent.find('input[name=stockName]').val(),
                                                ratio: parent.find('input[name=ratio]').val(),
                                                quantity: parent.find('input[name=quantity]').val(),
                                                amount: parent.find('input[name=amount]').val(),
                                                meetingId: meetingIdForm
                                            }, function (data) {
                                                layer.close(layerLoader);
                                                if (data.success) {
                                                    layer.alert('编辑出席股东成功');
                                                    table.reload('stockholder-edit-table');
                                                } else {
                                                    layer.alert("编辑出席股东失败:" + data.resultMessage);
                                                }
                                                layer.close(edit_attend);
                                            }, function () {
                                                layer.close(layerLoader);
                                                layer.alert('编辑出席股东失败');//失败后提示
                                                layer.close(edit_attend);
                                            });
                                        },
                                        btn2: function () {
                                            layer.close(yt_index_edit);
                                        },
                                    });
                                    break;
                                case 'stockDelete':
                                    //点击删除按钮
                                    if (checkStatus.data.length > 0) {
                                        layer.confirm('确定删除选中列?', { icon: 3, title: '提示', offset: '150px' }, function (index) {
                                            var stockIdArr = [];
                                            for (var i = 0; i < checkStatus.data.length; i++) {
                                                stockIdArr.push(checkStatus.data[i]['attendeeId']);
                                            }
                                            var layerLoader = common.layerLoader();
                                            common.fetchDelete('meetingmgr/tiolAttendStock/deleteTiolAttendStockByIds?stockIds=' + stockIdArr.join(','), function (res) {
                                                layer.close(layerLoader);
                                                if (res.success) {
                                                    table.reload('stockholder-edit-table', {
                                                        page: {}
                                                        , where: {
                                                            meetingId: meetingIdForm
                                                        }
                                                    });
                                                    layer.alert('删除出席人成功');
                                                } else {
                                                    layer.alert(res.resultMessage);
                                                }

                                            }, function () {
                                                layer.close(layerLoader);
                                            });

                                            layer.close(index);
                                        });
                                    } else {
                                        layer.alert('请选择删除列');
                                    }
                                    break;
                                case 'stockChoose':
                                    layer.closeAll();
                                    var attendLayer = layer.open({
                                        offset: '10px',
                                        title: '选择参会人员分组',
                                        // maxmin: false,
                                        area: ['80%', '90%'],//高度自适应
                                        type: 1,//页面层
                                        shadeClose: false,
                                        btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                                        btnAlign: 'c',
                                        content: '<div class="moduleBox"><table lay-filter="attendGroupTable" id="attendGroupTable"></table></div>',
                                        success: function (obj) {
                                            table.render(common.tableInitParams({
                                                elem: '#attendGroupTable',
                                                url: memberChooseUrl,
                                                // where:{tcgMeetingTypeId:meetingTypeId},
                                                method: 'post',
                                                height: 'full-300',
                                                limit: 100000,
                                                cols: [
                                                    [
                                                        { type: 'radio' },
                                                        { "type": "numbers", "title": "序号" },
                                                        { field: 'tcgName', title: '分组名称' },
                                                        { field: 'attendanceNames', title: '出席人员' },
                                                        { field: 'observerNames', title: '列席人员' },
                                                        { field: 'tcgStartDate', title: '适用开始日期', width: 135 }
                                                    ]
                                                ],
                                                page: false,
                                                done: function () {
                                                    // common.buttonLimit();
                                                    // 默认第一列选中
                                                }
                                            }));
                                        },
                                        yes: function () {
                                            var checkStatus = table.checkStatus('attendGroupTable');
                                            //获取选中组

                                            if (checkStatus.data.length === 0) {
                                                layer.alert('请选择人员分组');
                                                return false;
                                            }

                                            var layerLoader = common.layerLoader();
                                            var postData = {};
                                            var moderatorName = checkStatus.data[0].attendanceList[0].tcgmMemberName;
                                            var convenor = checkStatus.data[0].attendanceList[0].tcgmMemberName;
                                            var attendanceList = checkStatus.data[0].attendanceList;
                                            var observerList = checkStatus.data[0].observerList;
                                            postData.moderatorName = moderatorName;
                                            postData.convenor = convenor;
                                            postData.attendanceList = attendanceList;
                                            postData.observerList = observerList;
                                            postData.meetingId = meetingIdForm;
                                            common.fetchPost(saveMemberInfoUrl, postData, function (data) {
                                                if (data.success) {
                                                    //召集人
                                                    $('[name=convenor]').val(convenor);
                                                    //主持人
                                                    $('[name=moderatorName]').val(moderatorName);
                                                    //出席人
                                                    $('[name=attendeeNames]').val(checkStatus.data[0].attendanceNames);
                                                    //列席人
                                                    $('[name=attenders]').val(checkStatus.data[0].observerNames);
                                                    layer.close(attendLayer);
                                                    layer.close(layerLoader)
                                                } else {
                                                    layer.close(layerLoader)
                                                    layer.alert("保存人员信息失败:" + data.resultMessage);
                                                }
                                            }, function () {
                                                layer.close(layerLoader)
                                                layer.alert('查询人员信息失败');//失败后提示
                                            });
                                            return false;
                                        }
                                    });

                                    return false;
                                    break;
                                case "stockPeopleChoose":
                                    // =====================选择股东start============
                                    var stockLayer = layer.open({
                                        offset: '10px',
                                        title: '选择股东信息',
                                        // maxmin: false,
                                        area: ['80%', '90%'],//高度自适应
                                        type: 1,//页面层
                                        shadeClose: false,
                                        btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                                        btnAlign: 'c',
                                        content: '<div class="moduleBox"><table lay-filter="stockGroupTable" id="stockGroupTable"></table></div>',
                                        success: function (obj) {
                                            table.render(common.tableInitParams({
                                                elem: '#stockGroupTable',
                                                url: stockChooseUrl,
                                                method: 'post',
                                                height: 'full-190',
                                                limit: 100000,
                                                cols: [
                                                    [
                                                        { type: 'checkbox' },
                                                        { "type": "numbers", "title": "序号" },
                                                        {
                                                            field: 'teeShareholderName', title: '股东名称', templet: function (rowData) {
                                                                if (rowData.teeShareholderName) {
                                                                    return '<span title="' + rowData.teeShareholderName + '">' + rowData.teeShareholderName + '</span>'
                                                                } else {
                                                                    return '-'
                                                                }
                                                            }
                                                        },
                                                        {
                                                            field: 'tesShareholderInGroup', title: '集团内标识', templet: function (rowData) {
                                                                return rowData.tesShareholderInGroup == 0 ? "否" : "是"
                                                            }
                                                        },
                                                        { field: 'tesProportion', title: '持股比例(%)' },
                                                        { field: 'tesControllingQuantity', title: '持股数量(股)' },
                                                        { field: 'tesSubscribedCapital', title: '认缴资本(元)' }
                                                    ]
                                                ],
                                                page: false,
                                                done: function () {
                                                    // common.buttonLimit();
                                                    // 默认第一列选中
                                                }
                                            }));
                                        },
                                        yes: function () {
                                            var checkStatus = table.checkStatus('stockGroupTable');
                                            var len = checkStatus.data.length
                                            //获取选中组
                                            if (len === 0) {
                                                layer.alert('请选择股东信息');
                                                return false;
                                            }
                                            var stockArray = [];
                                            var stockNameArr = [];
                                            for (var i = 0; i < len; i++) {
                                                var stockObj = {};
                                                stockObj['tesId'] = checkStatus.data[i].tesId;
                                                stockObj['stockName'] = checkStatus.data[i].teeShareholderName;
                                                stockObj['ratio'] = checkStatus.data[i].tesProportion;
                                                stockObj['quantity'] = checkStatus.data[i].tesControllingQuantity;
                                                stockObj['meetingId'] = meetingIdForm;
                                                stockArray.push(stockObj)
                                                stockNameArr.push(checkStatus.data[i].teeShareholderName);
                                            }
                                            var layerLoader = common.layerLoader();
                                            common.fetchPost(saveStockInfoUrl, stockArray, function (data) {
                                                if (data.success) {
                                                    // $("#stockName").val(stockNameArr.join(","));
                                                    layer.close(stockLayer);
                                                    layer.close(layerLoader)
                                                    table.reload('stockholder-edit-table')
                                                } else {
                                                    layer.close(layerLoader)
                                                    layer.alert("保存股东信息失败:" + data.resultMessage);
                                                }
                                            }, function () {
                                                layer.close(layerLoader)
                                                layer.alert('查询股东信息失败');//失败后提示

                                            });
                                            return false;
                                        }
                                    });
                                    return false;
                                    break;
                            }
                        });
                        table.on('tool(stockholder-edit-table)', function (obj) {
                            var data = obj.data;
                            var obj1;
                            switch (obj.event) {
                                case 'stockEdit'://编辑
                                    var edit_attend = layer.open({
                                        title: '编辑出席股东情况',
                                        type: 1,//页面层
                                        area: ['60%', '80%'],
                                        shadeClose: false,
                                        btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                                        btnAlign: 'c',
                                        content: $('.stockholderLayer').html(),//加载该区域的html
                                        success: function (obj) {
                                            obj1 = obj;
                                            var parent = $(obj.selector);
                                            form.val('stockForm', data);
                                            form.render();
                                        },
                                        yes: function () {
                                            var parent = $(obj1.selector);
                                            if (parent.find('[name=stockName]').val() == '') {
                                                layer.alert('请输入企业名称');
                                                return false;
                                            }
                                            if (parent.find('[name=ratio]').val() == '') {
                                                layer.alert('请输入持股比例');
                                                return false;
                                            }
                                            var layerLoader = common.layerLoader();
                                            common.fetchPost(saveAttendInfoUrl, {
                                                stockId: obj.data.stockId,
                                                stockName: parent.find('input[name=stockName]').val(),
                                                ratio: parent.find('input[name=ratio]').val(),
                                                amount: parent.find('input[name=amount]').val(),
                                                quantity: parent.find('input[name=quantity]').val()
                                            }, function (data) {
                                                if (data.success) {
                                                    layer.alert('编辑出席股东成功');
                                                    table.reload('stockholder-edit-table', {
                                                        page: {}
                                                    });
                                                } else {
                                                    layer.alert("编辑出席股东失败:" + data.resultMessage);
                                                }
                                                layer.close(edit_attend);
                                                layer.close(layerLoader);
                                            }, function () {
                                                layer.close(layerLoader);
                                                layer.alert('编辑出席股东失败');//失败后提示
                                                layer.close(edit_attend);

                                            });
                                        },
                                        btn2: function () {
                                            layer.close(yt_index_edit);
                                        },
                                    });
                            }
                        });
                    },
                    // 关闭弹出层的回调函数
                    // end: function () {
                    //     // var parent = $(obj1.selector);
                    //     common.fetchPost('meetingmgr/tiolAttendStock/selectStockNameInfo', { "meetingId": meetingIdForm }, function (res) {
                    //         if (res.success) {
                    //             $('[name=stockName]').val(res.object.stockName);
                    //         } else {
                    //             layer.alert(err.resultMessage);
                    //         }
                    //     }, function (err) {
                    //         layer.alert(err.resultMessage);
                    //     })
                    // }
                });
                return false;
            }

            function userEditLayer(obj) {
                common.fetchGet('sysmgr/dicts/selectDictListByPcode?dictPCode=attendStatus', function (data) {
                    if (data && data.list && data.list.length > 0) {
                        participantsTypeList = data.list;
                        $.map(data.list, function (item) {
                            participantsTypeMap[item.sdCode] = item;
                        });
                    }
                });
                var objParam = $.extend({
                    title: '编辑',
                    offset: '10px',
                    area: ['80%', '80%'],//高度自适应
                    btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                    btnAlign: 'c',
                }, obj);
                var index_qx = layer.open({
                    offset: objParam.offset,
                    title: objParam.title,
                    area: objParam.area,
                    type: 1,//页面层
                    shadeClose: false,
                    btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                    btnAlign: objParam.btnAlign,
                    yes: function () {
                        layer.close(index_qx)
                        return false;
                    },
                    content: $('.attendee-edit-layer').html(),
                    success: function (obj) {
                        table.render(common.tableInitParams({
                            elem: $(obj.selector).find('#attendee-edit-table'),
                            id: "attendee-edit-table",
                            url: baseUrl + 'meetingmgr/tiolAttendee/selectTiolAttendeePage?meetingId=' + meetingIdForm,
                            contentType: 'text/plain',
                            method: 'get',
                            // request:null,
                            toolbar: '#attendee-edit-table-tool-bar',
                            // data:qxryData,
                            cellMinWidth: 60,
                            height: 'full-300',
                            page: false,
                            defaultToolbar: [],
                            cols: [
                                [
                                    { type: 'checkbox' },
                                    { type: 'numbers', title: '序号' },
                                    { field: 'attendeeName', title: '出席人员', minWidth: 120 },
                                    { field: 'attendeeJob', title: '职位', minWidth: 120 },
                                    {
                                        field: 'participantsType', title: '状态', width: 80, templet: function (rowData) {
                                            if (JSON.stringify(participantsTypeMap) != JSON.stringify({}) && participantsTypeMap[rowData['participantsType']] != null) {
                                                return participantsTypeMap[rowData['participantsType']]['sdName'];
                                            } else {
                                                return "";
                                            }
                                        }
                                    },
                                    {
                                        field: 'isConvenor', title: '召集人', minWidth: 120, templet: function (rowData) {
                                            if (rowData['isConvenor'] === '1') {
                                                return '<span class="green">是</span>';
                                            } else {
                                                return '<span class="red">否</span>';
                                            }
                                        }
                                    },
                                    {
                                        field: 'isModerator', title: '主持人', width: 100, templet: function (rowData) {
                                            if (rowData['isModerator'] === '1') {
                                                return '<span class="green">是</span>';
                                            } else {
                                                return '<span class="red">否</span>';
                                            }
                                        }
                                    },
                                    { field: 'reason', title: '缺席原因', minWidth: 120 },
                                    { field: 'assignor', title: '委托人名', minWidth: 120 },
                                    { field: 'remark', title: '备注', minWidth: 120 },
                                    { field: '', title: '操作', width: 80, toolbar: '#attendee-edit-table-oper', fixed: 'right' }
                                ]
                            ],
                            done: function () {

                            }
                        }));
                        table.on('toolbar(attendee-edit-table)', function (obj) {
                            var checkStatus = table.checkStatus(obj.config.id);
                            // var data = obj.data;
                            var data = obj.config;



                            var obj1
                            switch (obj.event) {
                                case 'add':
                                    var isConvenor = 0;
                                    var isModerator = 0;
                                    $('[name=isConvenor]').attr('checked', false);
                                    $('[name=isModerator]').attr('checked', false);
                                    var edit_attend = layer.open({
                                        title: '新增出席人员情况',
                                        type: 1,//页面层
                                        area: ['60%', '80%'],
                                        shadeClose: false,
                                        btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                                        btnAlign: 'c',
                                        content: $('.attendeeStatusLayer').html(),//加载该区域的html
                                        success: function (obj) {
                                            common.selectDataSet({
                                                elem: $('[name=participantsType]'),
                                                loadData: participantsTypeList,
                                                optionText: 'sdName',
                                                optionValue: 'sdCode'
                                            });

                                            common.fetchGet('sysmgr/dicts/selectDictListByPcode?dictPCode=reasonCode', function (data) {
                                                if (data && data.list && data.list.length > 0) {
                                                    var reasonHtml = ''
                                                    for (var i = 0; i < data.list.length; i++) {
                                                        reasonHtml += '<div class="reasonOption">' + data.list[i].sdName + '</div>'
                                                    }
                                                    $('.reasonDiv').html(reasonHtml)
                                                }
                                            });
                                            var parent = $(obj.selector);

                                            parent.find('button[id=commonReasons]').on('click', function () {
                                                $('.reasonDiv').toggle();
                                                parent.find('.reasonOption').off().on('click', function (e) {
                                                    $('input[name=reason]').val(e.target.innerText);
                                                    $('.reasonDiv').toggle();
                                                })
                                            })


                                            obj1 = obj
                                            form.on('select(participantsType)', function (data) {
                                                if (data.value === "ATTEND") {
                                                    // 出席：【缺席原因】、【委托人名】默认隐藏，【召集主持】展示
                                                    parent.find('.quexiArea').hide();
                                                    parent.find('.weituoArea').hide();
                                                    parent.find('.zhuchiArea').show();

                                                } else if (data.value === "ABSENT") {
                                                    //缺席：展现【缺席原因】供选择缺席原因。
                                                    parent.find('.quexiArea').show();
                                                    parent.find('.weituoArea').hide();
                                                    parent.find('.zhuchiArea').hide();
                                                }
                                                else if (data.value === "ENTRUST") {
                                                    // 委托：展现【缺席原因】、【委托人名】供选择缺席原因及委托人名。
                                                    parent.find('.quexiArea').show();
                                                    parent.find('.weituoArea').show();
                                                    parent.find('.zhuchiArea').show();
                                                }
                                                else if (data.value === "AVOID") {
                                                    // 回避：【缺席原因】、【委托人名】默认隐藏
                                                    parent.find('.quexiArea').hide();
                                                    parent.find('.weituoArea').hide();
                                                    parent.find('.zhuchiArea').show();
                                                }
                                            });


                                            form.on('checkbox(isConvenor)', function (data) {

                                                if (data.elem.checked === true) {
                                                    isConvenor = 1;
                                                } else {
                                                    isConvenor = 0;
                                                }
                                            })
                                            form.on('checkbox(isModerator)', function (data) {
                                                if (data.elem.checked === true) {
                                                    isModerator = 1;
                                                } else {
                                                    isModerator = 0;
                                                }
                                            })
                                            form.render();

                                        },
                                        yes: function () {
                                            var parent = $(obj1.selector);

                                            if (parent.find('[name=attendeeName]').val() == '') {
                                                layer.alert('请输入人员姓名');
                                                return false;
                                            }
                                            if (parent.find('[name=attendeeJob]').val() == '') {
                                                layer.alert('请输入职务名称');
                                                return false;
                                            }
                                            if (parent.find('[name=ggSort]').val() == '') {
                                                layer.alert('请输入出席排序');
                                                return false;
                                            }
                                            if (parent.find('[name=participantsType]').val() == '') {
                                                layer.alert('请选择参会状态');
                                                return false;
                                            }

                                            if (parent.find('[name=participantsType]').val() == '') {
                                                layer.alert('请选择参会状态');
                                                return false;
                                            }
                                            if (parent.find('.quexiArea')[0].style.display == '' && parent.find('input[name=reason]')[0].value == '') {
                                                layer.alert('请输入缺席原因');
                                                return false;
                                            }
                                            var layerLoader = common.layerLoader();

                                            // alert(parent.find('input[name=attendeeName]').val());
                                            common.fetchPost(saveAttendInfoUrl, {
                                                attendeeId: obj.attendeeId,
                                                attendeeName: parent.find('input[name=attendeeName]').val(),
                                                attendeeJob: parent.find('input[name=attendeeJob]').val(),
                                                reason: parent.find('input[name=reason]').val(),
                                                ggSort: parent.find('input[name=ggSort]').val(),
                                                participantsType: parent.find('[name=participantsType]').val(),
                                                //  isConvenor:parent.find('[name=participantsType]').val(),
                                                //  isModerator:parent.find('[name=participantsType]').val(),
                                                isConvenor: isConvenor,
                                                isModerator: isModerator,
                                                meetingId: meetingIdForm,
                                                assignor: parent.find('input[name=assignor]').val(),
                                                remark: parent.find('[name=remark]').val()

                                            }, function (data) {
                                                layer.close(layerLoader);
                                                if (data.success) {
                                                    layer.alert('编辑出席人成功');
                                                    table.reload('attendee-edit-table', {
                                                        page: {}
                                                        , where: {
                                                            meetingId: meetingIdForm
                                                        }
                                                    });
                                                } else {
                                                    layer.alert("编辑出席人失败:" + data.resultMessage);
                                                }
                                                layer.close(edit_attend);
                                            }, function () {
                                                layer.close(layerLoader);
                                                layer.alert('编辑出席人失败');//失败后提示
                                                layer.close(edit_attend);
                                            });
                                        },
                                        btn2: function () {
                                            layer.close(yt_index_edit);
                                        },
                                    });
                                    break;
                                case 'delete':
                                    //点击删除按钮
                                    if (checkStatus.data.length > 0) {
                                        layer.confirm('确定删除选中列?', { icon: 3, title: '提示', offset: '150px' }, function (index) {
                                            var attendeeIdArr = [];
                                            for (var i = 0; i < checkStatus.data.length; i++) {
                                                attendeeIdArr.push(checkStatus.data[i]['attendeeId']);
                                            }
                                            var layerLoader = common.layerLoader();
                                            common.fetchDelete('meetingmgr/tiolAttendee/deleteTiolAttendeeByIds?attendeeIds=' + attendeeIdArr.join(','), function (res) {
                                                layer.close(layerLoader);
                                                if (res.success) {
                                                    //成功之后刷新tree 以及表格
                                                    // eventHandle.tableReload(currentTableId);
                                                    table.reload('attendee-edit-table', {
                                                        page: {}
                                                        , where: {
                                                            meetingId: meetingIdForm
                                                        }
                                                    });
                                                    layer.alert('删除出席人成功');
                                                } else {
                                                    layer.alert(res.resultMessage);
                                                }

                                            }, function () {
                                                layer.close(layerLoader);
                                            });

                                            layer.close(index);
                                        });
                                    } else {
                                        layer.alert('请选择删除列');
                                    }
                                    break;
                                case 'choose':
                                    layer.closeAll();
                                    var attendLayer = layer.open({
                                        offset: '10px',
                                        title: '选择参会人员分组',
                                        // maxmin: false,
                                        area: ['80%', '90%'],//高度自适应
                                        type: 1,//页面层
                                        shadeClose: false,
                                        btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                                        btnAlign: 'c',
                                        content: '<div class="moduleBox"><table lay-filter="attendGroupTable" id="attendGroupTable"></table></div>',
                                        success: function (obj) {
                                            table.render(common.tableInitParams({
                                                elem: '#attendGroupTable',
                                                url: memberChooseUrl,
                                                where:{tcgMeetingTypeId:meetingTypeId},
                                                method: 'post',
                                                // height: 'full-500',
                                                height: "full-300",
                                                limit: 100000,
                                                cols: [
                                                    [
                                                        { type: 'radio' },
                                                        { "type": "numbers", "title": "序号" },
                                                        { field: 'tcgName', title: '分组名称' },
                                                        { field: 'attendanceNames', title: '出席人员' },
                                                        { field: 'observerNames', title: '列席人员' },
                                                        { field: 'tcgStartDate', title: '适用开始日期', width: 135 }
                                                    ]
                                                ],
                                                page: false,
                                                done: function () {
                                                    // common.buttonLimit();
                                                    // 默认第一列选中
                                                }
                                            }));
                                        },
                                        yes: function () {
                                            var checkStatus = table.checkStatus('attendGroupTable');
                                            //获取选中组

                                            if (checkStatus.data.length === 0) {
                                                layer.alert('请选择人员分组');
                                                return false;
                                            }

                                            var layerLoader = common.layerLoader();
                                            var postData = {};
                                            var moderatorName = checkStatus.data[0].attendanceList[0].tcgmMemberName;
                                            var convenor = checkStatus.data[0].attendanceList[0].tcgmMemberName;
                                            var attendanceList = checkStatus.data[0].attendanceList;
                                            var observerList = checkStatus.data[0].observerList;
                                            postData.moderatorName = moderatorName;
                                            postData.convenor = convenor;
                                            postData.attendanceList = attendanceList;
                                            postData.observerList = observerList;
                                            postData.meetingId = meetingIdForm;
                                            common.fetchPost(saveMemberInfoUrl, postData, function (data) {
                                                if (data.success) {
                                                    //召集人
                                                    $('[name=convenor]').val(convenor);
                                                    //主持人
                                                    $('[name=moderatorName]').val(moderatorName);
                                                    //出席人
                                                    $('[name=attendeeNames]').val(checkStatus.data[0].attendanceNames);
                                                    //列席人
                                                    $('[name=attenders]').val(checkStatus.data[0].observerNames);
                                                    layer.close(attendLayer);
                                                    layer.close(layerLoader)
                                                } else {
                                                    layer.close(layerLoader)
                                                    layer.alert("保存人员信息失败:" + data.resultMessage);
                                                }
                                            }, function () {
                                                layer.close(layerLoader)
                                                layer.alert('查询人员信息失败');//失败后提示
                                            });
                                            return false;
                                        }
                                    });

                                    return false;
                                    break;

                                case "up":
                                    if (checkStatus.data.length == 1) {
                                        var data = checkStatus.data[0];
                                        layer.confirm("确定上移?", {}, function () {
                                            var layerLoader = common.layerLoader();
                                            common.fetchPost("meetingmgr/tiolAttendee/editTiolAttendeeSort", { attendeeId: data.attendeeId, currentSort: data.ggSort, opType: 0, meetingId: data.meetingId }, function (res) {
                                                layer.alert(res.resultMessage);
                                                table.reload('attendee-edit-table')
                                            }, function (err) {
                                                layer.alert(err.resultMessage);
                                            })
                                            layer.close(layerLoader);
                                        })


                                    } else {
                                        layer.alert('请选择一条数据')
                                    }
                                    break;

                                case "down":
                                    if (checkStatus.data.length == 1) {
                                        var data = checkStatus.data[0];
                                        layer.confirm("确定下移?", {}, function () {
                                            var layerLoader = common.layerLoader();
                                            common.fetchPost("meetingmgr/tiolAttendee/editTiolAttendeeSort", { attendeeId: data.attendeeId, currentSort: data.ggSort, opType: 1, meetingId: data.meetingId }, function (res) {
                                                layer.alert(res.resultMessage);
                                                table.reload('attendee-edit-table')
                                            }, function (err) {
                                                layer.alert(err.resultMessage);
                                            })
                                            layer.close(layerLoader);
                                        })


                                    } else {
                                        layer.alert('请选择一条数据')
                                    }
                                    break;

                            }
                        });
                        table.on('tool(attendee-edit-table)', function (obj) {
                            var data = obj.data;

                            var isConvenor = data.isConvenor;
                            var isModerator = data.isModerator

                            if (isConvenor == 1) {
                                $('[name=isConvenor]').attr('checked', true);

                            } else {
                                isConvenor = 0;
                                $('[name=isConvenor]').attr('checked', false);
                            }

                            if (isModerator == 1) {
                                $('[name=isModerator]').attr('checked', true);
                            } else {
                                isModerator = 0;
                                $('[name=isModerator]').attr('checked', false);
                            }

                            var obj1;
                            switch (obj.event) {
                                case 'edit'://编辑
                                    var edit_attend = layer.open({
                                        title: '编辑出席人员情况',
                                        type: 1,//页面层
                                        area: ['60%', '80%'],
                                        shadeClose: false,
                                        btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                                        btnAlign: 'c',
                                        content: $('.attendeeStatusLayer').html(),//加载该区域的html
                                        success: function (obj) {
                                            obj1 = obj;

                                            common.fetchGet('sysmgr/dicts/selectDictListByPcode?dictPCode=reasonCode', function (data) {
                                                if (data && data.list && data.list.length > 0) {
                                                    var reasonHtml = ''
                                                    for (var i = 0; i < data.list.length; i++) {
                                                        reasonHtml += '<div class="reasonOption">' + data.list[i].sdName + '</div>'
                                                    }
                                                    $('.reasonDiv').html(reasonHtml)
                                                }
                                            });
                                            var parent = $(obj.selector);

                                            parent.find('button[id=commonReasons]').on('click', function () {
                                                $('.reasonDiv').toggle();
                                                parent.find('.reasonOption').off().on('click', function (e) {
                                                    $('input[name=reason]').val(e.target.innerText);
                                                    $('.reasonDiv').toggle();
                                                })
                                            })

                                            switch (data.participantsType) {
                                                case 'ATTEND':
                                                    parent.find('.quexiArea').hide();
                                                    parent.find('.weituoArea').hide();
                                                    parent.find('.zhuchiArea').show();
                                                    break;
                                                case "ABSENT":
                                                    parent.find('.quexiArea').show();
                                                    parent.find('.weituoArea').hide();
                                                    parent.find('.zhuchiArea').hide();
                                                    break;
                                                case "ENTRUST":
                                                    parent.find('.quexiArea').show();
                                                    parent.find('.weituoArea').show();
                                                    parent.find('.zhuchiArea').show();
                                                    break;
                                                case "AVOID":
                                                    // 回避：【缺席原因】、【委托人名】默认隐藏
                                                    parent.find('.quexiArea').hide();
                                                    parent.find('.weituoArea').hide();
                                                    parent.find('.zhuchiArea').show();
                                                    break;
                                            }

                                            form.on('select(participantsType)', function (data) {
                                                if (data.value === "ATTEND") {
                                                    // 出席：【缺席原因】、【委托人名】默认隐藏，【召集主持】展示
                                                    parent.find('.quexiArea').hide();
                                                    parent.find('.weituoArea').hide();
                                                    parent.find('.zhuchiArea').show();

                                                } else if (data.value === "ABSENT") {
                                                    //缺席：展现【缺席原因】供选择缺席原因。
                                                    parent.find('.quexiArea').show();
                                                    parent.find('.weituoArea').hide();
                                                    parent.find('.zhuchiArea').hide();
                                                }
                                                else if (data.value === "ENTRUST") {
                                                    // 委托：展现【缺席原因】、【委托人名】供选择缺席原因及委托人名。
                                                    parent.find('.quexiArea').show();
                                                    parent.find('.weituoArea').show();
                                                    parent.find('.zhuchiArea').show();
                                                }
                                                else if (data.value === "AVOID") {
                                                    // 回避：【缺席原因】、【委托人名】默认隐藏
                                                    parent.find('.quexiArea').hide();
                                                    parent.find('.weituoArea').hide();
                                                    parent.find('.zhuchiArea').show();
                                                }
                                            });

                                            form.on('checkbox(isConvenor)', function (data) {
                                                if (data.elem.checked === true) {
                                                    isConvenor = 1;
                                                } else {
                                                    isConvenor = 0;
                                                }
                                            })
                                            form.on('checkbox(isModerator)', function (data) {
                                                if (data.elem.checked === true) {
                                                    isModerator = 1;
                                                } else {
                                                    isModerator = 0;
                                                }
                                            })

                                            parent.find('[name=participantsType]').val(data.participantsType);
                                            common.selectDataSet({
                                                elem: $('[name=participantsType]'),
                                                loadData: participantsTypeList,
                                                optionText: 'sdName',
                                                optionValue: 'sdCode'
                                            });
                                            form.val('attendeeForm', data);
                                            if (isConvenor == 1) {
                                                form.val('attendeeForm', {
                                                    'isConvenor': true
                                                })
                                            } else {
                                                form.val('attendeeForm', {
                                                    'isConvenor': false
                                                })
                                            }

                                            if (isModerator == 1) {
                                                form.val('attendeeForm', {
                                                    'isModerator': true
                                                })
                                            } else {
                                                form.val('attendeeForm', {
                                                    'isModerator': false
                                                })
                                            }
                                            // form.val('attendeeForm', data)
                                            // 渲染复选框

                                            form.render();
                                        },
                                        yes: function () {

                                            var parent = $(obj1.selector);
                                            if (parent.find('[name=attendeeName]').val() == '') {
                                                layer.alert('请输入人员姓名');
                                                return false;
                                            }
                                            if (parent.find('[name=attendeeJob]').val() == '') {
                                                layer.alert('请输入职务名称');
                                                return false;
                                            }
                                            if (parent.find('[name=ggSort]').val() == '') {
                                                layer.alert('请输入出席排序');
                                                return false;
                                            }
                                            if (parent.find('[name=participantsType]').val() == '') {
                                                layer.alert('请选择参会状态');
                                                return false;
                                            }
                                            if (parent.find('.quexiArea')[0].style.display == '' && parent.find('input[name=reason]')[0].value == '') {
                                                layer.alert('请输入缺席原因');
                                                return false;
                                            }
                                            var layerLoader = common.layerLoader();
                                            common.fetchPost(saveAttendInfoUrl, {
                                                attendeeId: obj.data.attendeeId,
                                                attendeeName: parent.find('input[name=attendeeName]').val(),
                                                attendeeJob: parent.find('input[name=attendeeJob]').val(),
                                                reason: parent.find('input[name=reason]').val(),
                                                ggSort: parent.find('input[name=ggSort]').val(),
                                                participantsType: parent.find('[name=participantsType]').val(),
                                                isConvenor: isConvenor,
                                                isModerator: isModerator,
                                                meetingId: meetingIdForm,
                                                assignor: parent.find('input[name=assignor]').val(),
                                                remark: parent.find('textarea[name=remark]').val()
                                            }, function (data) {
                                                if (data.success) {
                                                    layer.alert('编辑出席人成功');
                                                    table.reload('attendee-edit-table', {
                                                        page: {}
                                                        , where: {
                                                            meetingId: meetingIdForm
                                                        }
                                                    });
                                                } else {
                                                    layer.alert("编辑出席人失败:" + data.resultMessage);
                                                }
                                                layer.close(edit_attend);
                                                layer.close(layerLoader);
                                            }, function () {
                                                layer.close(layerLoader);
                                                layer.alert('编辑出席人失败');//失败后提示
                                                layer.close(edit_attend);

                                            });
                                        },
                                        btn2: function () {
                                            layer.close(yt_index_edit);
                                        },
                                    });
                            }
                        });
                    },
                    // 关闭弹出层的回调函数
                    end: function () {
                        // var parent = $(obj1.selector);
                        common.fetchPost('meetingmgr/tiolAttendee/selectAttendeeNameInfo', { "meetingId": meetingIdForm }, function (res) {
                            if (res.success) {
                                $('[name=attendeeNames]').val(res.object.attend);
                                $("[name=absentNames]").val(res.object.absent);
                                $("[name=moderatorName]").val(res.object.moderator);
                                $("[name=convenor]").val(res.object.convenor);
                            } else {
                                layer.alert(err.resultMessage);
                            }
                        }, function (err) {
                            layer.alert(err.resultMessage);
                        })
                    }
                });
                return false;
            }

            //出席人员选择
            $('#attendee-setting').on('click', function () {
                var attendLayer = layer.open({
                    offset: '10px',
                    title: '选择出席人员分组',
                    // maxmin: false,
                    area: ['80%', '90%'],//高度自适应
                    type: 1,//页面层
                    shadeClose: false,
                    btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                    btnAlign: 'c',
                    content: '<div class="moduleBox"><table lay-filter="attendanceGroupTable" id="attendanceGroupTable"></table></div>',
                    success: function (obj) {
                        table.render(common.tableInitParams({
                            elem: '#attendanceGroupTable',
                            url: memberChooseUrl,
                            where:{tcgMeetingTypeId:meetingTypeId},
                            method: 'post',
                            height: 'full-190',
                            limit: 100000,
                            cols: [
                                [
                                    { type: 'radio' },
                                    { "type": "numbers", "title": "序号" },
                                    { field: 'tcgName', title: '分组名称' },
                                    { field: 'attendanceNames', title: '出席人员' },
                                    { field: 'observerNames', title: '列席人员' },
                                    { field: 'tcgStartDate', title: '适用开始日期', width: 135 }
                                ]
                            ],
                            page: false,
                            done: function () {
                                // common.buttonLimit();
                                // 默认第一列选中
                            }
                        }));
                    },
                    yes: function () {
                        var checkStatus = table.checkStatus('attendanceGroupTable');
                        //获取选中组
                        if (checkStatus.data.length === 0) {
                            layer.alert('请选择人员分组');
                            return false;
                        }
                        var layerLoader = common.layerLoader();
                        var postData = {};
                        var moderatorName = checkStatus.data[0].attendanceList[0].tcgmMemberName;
                        var convenor = checkStatus.data[0].attendanceList[0].tcgmMemberName;
                        var attendanceList = checkStatus.data[0].attendanceList;
                        var observerList = checkStatus.data[0].observerList;
                        postData.moderatorName = moderatorName;
                        postData.convenor = convenor;
                        postData.attendanceList = attendanceList;
                        postData.observerList = observerList;
                        postData.meetingId = meetingIdForm;
                        common.fetchPost(saveMemberInfoUrl, postData, function (data) {
                            if (data.success) {
                                //召集人
                                $('[name=convenor]').val(convenor);
                                //主持人
                                $('[name=moderatorName]').val(moderatorName);
                                //出席人
                                $('[name=attendeeNames]').val(checkStatus.data[0].attendanceNames);
                                //列席人
                                $('[name=attenders]').val(checkStatus.data[0].observerNames);
                                layer.close(attendLayer);
                                layer.close(layerLoader)
                            } else {
                                layer.close(layerLoader)
                                layer.alert("保存人员信息失败:" + data.resultMessage);
                            }
                        }, function () {
                            layer.close(layerLoader)
                            layer.alert('查询人员信息失败');//失败后提示

                        });
                        return false;
                    }
                });
                return false;
            });
            //出席股东选择
            $('#stockholder-setting').on('click', function () {
                var stockLayer = layer.open({
                    offset: '10px',
                    title: '选择股东信息',
                    // maxmin: false,
                    area: ['80%', '90%'],//高度自适应
                    type: 1,//页面层
                    shadeClose: false,
                    btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                    btnAlign: 'c',
                    content: '<div class="moduleBox"><table lay-filter="stockGroupTable" id="stockGroupTable"></table></div>',
                    success: function (obj) {
                        table.render(common.tableInitParams({
                            elem: '#stockGroupTable',
                            url: stockChooseUrl,
                            method: 'post',
                            height: 'full-190',
                            limit: 100000,
                            cols: [
                                [
                                    { type: 'checkbox' },
                                    { "type": "numbers", "title": "序号" },
                                    {
                                        field: 'teeShareholderName', title: '股东名称', templet: function (rowData) {
                                            if (rowData.teeShareholderName) {
                                                return '<span title="' + rowData.teeShareholderName + '">' + rowData.teeShareholderName + '</span>'
                                            } else {
                                                return '-'
                                            }
                                        }
                                    },
                                    {
                                        field: 'tesShareholderInGroup', title: '集团内标识', templet: function (rowData) {
                                            return rowData.tesShareholderInGroup == 0 ? "否" : "是"
                                        }
                                    },
                                    { field: 'tesProportion', title: '持股比例(%)' },
                                    { field: 'tesControllingQuantity', title: '持股数量(股)' },
                                    { field: 'tesSubscribedCapital', title: '认缴资本(元)' }
                                ]
                            ],
                            page: false,
                            done: function () {
                                // common.buttonLimit();
                                // 默认第一列选中
                            }
                        }));
                    },
                    yes: function () {
                        var checkStatus = table.checkStatus('stockGroupTable');
                        var len = checkStatus.data.length
                        //获取选中组
                        if (len === 0) {
                            layer.alert('请选择股东信息');
                            return false;
                        }
                        var stockArray = [];
                        var stockNameArr = [];
                        for (var i = 0; i < len; i++) {
                            var stockObj = {};
                            stockObj['tesId'] = checkStatus.data[i].tesId;
                            stockObj['stockName'] = checkStatus.data[i].teeShareholderName;
                            stockObj['ratio'] = checkStatus.data[i].tesProportion;
                            stockObj['quantity'] = checkStatus.data[i].tesControllingQuantity;
                            stockObj['meetingId'] = meetingIdForm;
                            stockArray.push(stockObj)
                            stockNameArr.push(checkStatus.data[i].teeShareholderName);
                        }
                        var layerLoader = common.layerLoader();
                        common.fetchPost(saveStockInfoUrl, stockArray, function (data) {
                            if (data.success) {
                                $("#stockName").val(stockNameArr.join(","));
                                layer.close(stockLayer);
                                layer.close(layerLoader)
                            } else {
                                layer.close(layerLoader)
                                layer.alert("保存股东信息失败:" + data.resultMessage);
                            }
                        }, function () {
                            layer.close(layerLoader)
                            layer.alert('查询股东信息失败');//失败后提示

                        });
                        return false;
                    }
                });
                return false;
            });
            //出席人编辑
            $('#attendee-edit').off().on('click', function () {
                userEditLayer({
                    title: '编辑出席人员'
                });
                return false;
            });
            //股东编辑
            $('#stockholder-edit').off().on('click', function () {
                stockholderEditLayer({
                    title: '编辑出席股东'
                });
                return false;
            });

            //支持人选择
            $('#zhuchi-setting').off().on('click', function () {
                var zhuchirenLayer = layer.open({
                    offset: '10px',
                    title: '会议成员选择',
                    // maxmin: false,
                    area: ['80%', '90%'],//高度自适应
                    type: 1,//页面层
                    shadeClose: false,
                    btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                    btnAlign: 'c',
                    content: '<div class="moduleBox"><table lay-filter="zhuichiGroupTable" id="zhuichiGroupTable"></table></div>',
                    success: function (obj) {
                        table.render(common.tableInitParams({
                            elem: '#zhuichiGroupTable',
                            url: memberChooseUrl,
                            where:{tcgMeetingTypeId:meetingTypeId},
                            method: 'post',
                            height: 'full-300',
                            limit: 100000,
                            cols: [
                                [
                                    { type: 'radio' },
                                    { "type": "numbers", "title": "序号" },
                                    { field: 'tcgName', title: '分组名称' },
                                    { field: 'attendanceNames', title: '出席人员' },
                                    { field: 'observerNames', title: '列席人员' },
                                    { field: 'tcgStartDate', title: '适用开始日期', width: 135 }
                                ]
                            ],
                            page: false,
                            done: function () {
                                // common.buttonLimit();
                                // 默认第一列选中
                            }
                        }));
                    },
                    yes: function () {
                        var checkStatus = table.checkStatus('zhuichiGroupTable');
                        //获取选中组
                        if (checkStatus.data.length === 0) {
                            layer.alert('请选择人员分组');
                            return false;
                        }
                        var layerLoader = common.layerLoader();
                        var postData = {};
                        var moderatorName = checkStatus.data[0].attendanceList[0].tcgmMemberName;
                        var convenor = checkStatus.data[0].attendanceList[0].tcgmMemberName;
                        var attendanceList = checkStatus.data[0].attendanceList;
                        var observerList = checkStatus.data[0].observerList;
                        postData.moderatorName = moderatorName;
                        postData.convenor = convenor;
                        postData.attendanceList = attendanceList;
                        postData.observerList = observerList;
                        postData.meetingId = meetingIdForm;
                        common.fetchPost(saveMemberInfoUrl, postData, function (data) {
                            if (data.success) {
                                //召集人
                                $('[name=convenor]').val(checkStatus.data[0].attendanceList[0].tcgmMemberName);
                                //主持人
                                $('[name=moderatorName]').val(checkStatus.data[0].attendanceList[0].tcgmMemberName);
                                //出席人
                                $('[name=attendeeNames]').val(checkStatus.data[0].attendanceNames);
                                //列席人
                                $('[name=attenders]').val(checkStatus.data[0].observerNames);
                                layer.close(layerLoader);
                                layer.close(zhuchirenLayer);

                            } else {
                                layer.close(layerLoader);
                                layer.alert("保存人员信息失败:" + data.resultMessage);
                            }
                        }, function () {
                            layer.close(layerLoader);
                            layer.alert('查询人员信息失败');//失败后提示
                        });
                        return false;
                    }
                });

                return false;
            });
            //召集人选择
            $('#attend-setting').off().on('click', function () {
                var attendLayer = layer.open({
                    offset: '10px',
                    title: '选择参会人员分组',
                    // maxmin: false,
                    area: ['80%', '90%'],//高度自适应
                    type: 1,//页面层
                    shadeClose: false,
                    btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                    btnAlign: 'c',
                    content: '<div class="moduleBox"><table lay-filter="attendGroupTable" id="attendGroupTable"></table></div>',
                    success: function (obj) {
                        table.render(common.tableInitParams({
                            elem: '#attendGroupTable',
                            url: memberChooseUrl,
                            where:{tcgMeetingTypeId:meetingTypeId},
                            method: 'post',
                            height: 'full-300',
                            limit: 100000,
                            cols: [
                                [
                                    { type: 'radio' },
                                    { type: "numbers", "title": "序号" },
                                    { field: 'tcgName', title: '分组名称' },
                                    { field: 'attendanceNames', title: '出席人员' },
                                    { field: 'observerNames', title: '列席人员' },
                                    { field: 'tcgStartDate', title: '适用开始日期', width: 135 }
                                ]
                            ],
                            page: false,
                            done: function () {
                                // common.buttonLimit();
                                // 默认第一列选中
                            }
                        }));
                    },
                    yes: function () {

                        var checkStatus = table.checkStatus('attendGroupTable');
                        //获取选中组

                        if (checkStatus.data.length === 0) {
                            layer.alert('请选择人员分组');
                            return false;
                        }

                        var layerLoader = common.layerLoader();
                        var postData = {};
                        var moderatorName = checkStatus.data[0].attendanceList[0].tcgmMemberName;
                        var convenor = checkStatus.data[0].attendanceList[0].tcgmMemberName;
                        var attendanceList = checkStatus.data[0].attendanceList;
                        var observerList = checkStatus.data[0].observerList;
                        postData.moderatorName = moderatorName;
                        postData.convenor = convenor;
                        postData.attendanceList = attendanceList;
                        postData.observerList = observerList;
                        postData.meetingId = meetingIdForm;
                        common.fetchPost(saveMemberInfoUrl, postData, function (data) {
                            if (data.success) {
                                //召集人
                                $('[name=convenor]').val(convenor);
                                //主持人
                                $('[name=moderatorName]').val(moderatorName);
                                //出席人
                                $('[name=attendeeNames]').val(checkStatus.data[0].attendanceNames);
                                //列席人
                                $('[name=attenders]').val(checkStatus.data[0].observerNames);
                                layer.close(attendLayer);
                                layer.close(layerLoader);
                            } else {
                                layer.close(layerLoader);
                                layer.alert("保存人员信息失败:" + data.resultMessage);
                            }
                        }, function () {
                            layer.close(layerLoader);
                            layer.alert('查询人员信息失败');//失败后提示
                        });
                        return false;
                    }
                });

                return false;
            });
            //召集人编辑
            $('#attend-edit').off().on('click', function () {
                userEditLayer({
                    title: '编辑召集人'
                });
                return false;
            });

            //主持人编辑
            $('#zhuchi-edit').off().on('click', function () {
                userEditLayer({
                    title: '编辑主持人'
                });
                return false;
            });
            //缺席人员选择
            $('#absent-edit').on('click', function () {
                var index_qx = layer.open({
                    offset: '10px',
                    title: '<i class="iconfont icon-SZYD-xitongcaidanguanli"></i>缺席人员选择',
                    // maxmin: false,
                    area: ['800px', '90%'],//高度自适应
                    type: 1,//页面层
                    shadeClose: false,
                    btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                    btnAlign: 'c',
                    yes: function () {
                        var layerLoader = common.layerLoader();
                        common.fetchPost('meetingmgr/tiolAttendee/selectTiolAttendeeList', { meetingId: meetingIdForm, participantsType: "ABSENT" }, function (data) {
                            if (data.success) {
                                $("#absentNames").val(data.object);
                            } else {
                                layer.alert("查询出席人员信息失败:" + data.resultMessage);
                            }
                            layer.close(layerLoader)
                        }, function () {
                            layer.close(layerLoader)
                            layer.alert('查询出席人员信息失败');//失败后提示
                        });
                        layer.close(index_qx);
                        return false;
                    },
                    btn2: function () {
                        layer.close(index_qx);
                        return false;
                    },
                    content: $('.set-absentForm').html(),//加载该区域的html
                    success: function (obj) {
                        table.render(common.tableInitParams({
                            elem: $(obj.selector).find('#absentTable'),
                            id: "absentTableReload",
                            url: baseUrl + 'meetingmgr/tiolAttendee/selectTiolAttendeePage?meetingId=' + meetingIdForm + '&participantsType=ABSENT',
                            contentType: 'text/plain',
                            method: 'get',
                            // request:null,
                            toolbar: '#absentToolBar',
                            // data:qxryData,
                            cellMinWidth: 60,
                            height: 'full-300',
                            defaultToolbar: [],
                            cols: [
                                [
                                    { type: 'checkbox' },
                                    { type: 'numbers', title: '序号' },
                                    { field: 'attendeeName', title: '缺席人' },
                                    { field: 'reason', title: '缺席原因' },
                                    { field: 'assignor', title: '委托人' },
                                    { field: 'remark', title: '备注' },
                                    { field: '', title: '操作', toolbar: '#absentTableOper' },
                                ]
                            ],
                            done: function () {

                            }
                        }));
                        table.on('toolbar(absentTable)', function (obj) {
                            var checkStatus = table.checkStatus(obj.config.id);
                            // var data = obj.data;
                            var data = obj.config;
                            switch (obj.event) {
                                case 'add':
                                    var index_add = layer.open({
                                        offset: '10px',
                                        title: '<i class="iconfont icon-SZYD-xitongcaidanguanli"></i>新增缺席人员',
                                        maxmin: false,
                                        area: ['580px', '90%'],//高度自适应
                                        type: 1,//页面层
                                        shadeClose: false,
                                        btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                                        btnAlign: 'c',
                                        yes: function () {
                                            $("[lay-filter='formAbsentAdd']").click();
                                            layer.close(index_add);
                                            return false;
                                        },
                                        btn2: function () {
                                            layer.close(index_add);
                                        },
                                        content: $('.setAdd-absentForm').html(),//加载该区域的html
                                        success: function (obj) {
                                            form.render();
                                        }
                                    });
                                    break;
                                case 'del':
                                    //点击删除按钮
                                    if (checkStatus.data.length > 0) {
                                        layer.confirm('确定删除选中列?', { icon: 3, title: '提示', offset: '150px' }, function (index) {
                                            // layer.alert('已删除');
                                            // return false;
                                            var attendeeIdArr = [];

                                            for (var i = 0; i < checkStatus.data.length; i++) {
                                                attendeeIdArr.push(checkStatus.data[i]['attendeeId'])
                                            }
                                            var layerLoader = common.layerLoader();
                                            common.fetchDelete('meetingmgr/tiolAttendee/deleteTiolAttendeeByIds?attendeeIds=' + attendeeIdArr.join(','), function () {
                                                layer.close(layerLoader);
                                                //成功之后刷新tree 以及表格
                                                // eventHandle.tableReload(currentTableId);
                                                table.reload('absentTableReload', {
                                                    page: {}
                                                    , where: {
                                                        meetingId: meetingIdForm,
                                                        participantsType: "ABSENT"
                                                    }
                                                });
                                                layer.alert('删除缺席人成功');
                                            }, function () {
                                                layer.close(layerLoader);
                                            });

                                            layer.close(index);
                                        });
                                    } else {
                                        layer.alert('请选择删除列');
                                    }
                                    break;
                                case 'choose':
                                    var index_add = layer.open({
                                        offset: '10px',
                                        title: '<i class="iconfont icon-SZYD-xitongcaidanguanli"></i>选择缺席人员',
                                        maxmin: false,
                                        area: ['580px', '90%'],//高度自适应
                                        type: 1,//页面层
                                        shadeClose: false,
                                        btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                                        btnAlign: 'c',
                                        yes: function () {
                                            var seId = $("#curSeId")[0].value;
                                            var checkStatus = table.checkStatus("memberTableReload");
                                            var memberTypeIdArr = [];
                                            for (var i = 0; i < checkStatus.data.length; i++) {
                                                memberTypeIdArr.push(checkStatus.data[i]['memberTypeId']);
                                            }
                                            var meetingId = $("#meetingId")[0].value;
                                            var layerLoader = common.layerLoader();
                                            common.fetchPost('meetingmgr/tiolAttendee/saveTiolAttendeeInfoRel', { "memberTypeIds": memberTypeIdArr.join(','), "meetingId": meetingId, participantsType: "ABSENT" }, function () {
                                                layer.close(layerLoader);
                                                //成功之后刷新tree 以及表格
                                                table.reload('memberTableReload', {
                                                    page: {}
                                                    , where: {
                                                        meetingId: meetingIdForm,
                                                        meetingTypeId: meetingTypeId,
                                                        seId: seId,
                                                        memberAttendeeType: 'attendee'
                                                    }
                                                });
                                                //成功之后刷新tree 以及表格
                                                table.reload('absentTableReload', {
                                                    page: {}
                                                    , where: {
                                                        meetingId: meetingIdForm,
                                                        participantsType: "ABSENT"
                                                    }
                                                });
                                                layer.alert('关联成功');
                                            }, function () {
                                                layer.close(layerLoader);
                                            });

                                            layer.close(index_add);
                                            return false;
                                        },
                                        btn2: function () {
                                            layer.close(index_add);
                                        },
                                        content: $('.memberTable').html(),//加载该区域的html
                                        success: function (obj) {
                                            var seId = $("#curSeId")[0].value;
                                            table.render(common.tableInitParams({
                                                elem: $(obj.selector).find('#memberTable'),
                                                url: baseUrl + 'meetingmgr/tiolCompanyMember/selectTiolCompanyMemberPageSelect',
                                                // contentType:'text/plain',
                                                id: 'memberTableReload',
                                                method: 'post',
                                                where: { "meetingTypeId": meetingTypeId, "seId": seId, memberAttendeeType: 'attendee', meetingId: meetingIdForm, },
                                                // request:null,
                                                // toolbar:'#memberToolBar',
                                                // data:resAdd,
                                                height: 'full-200',
                                                defaultToolbar: [],
                                                cols: [
                                                    [
                                                        { type: 'checkbox' },
                                                        { type: 'numbers', title: '序号' },
                                                        { field: 'memberName', title: '姓名' },
                                                        { field: 'jobName', title: '职位' },
                                                        { field: 'startDate', title: '开始时间' },
                                                        { field: 'endDate', title: '结束时间' }
                                                    ]
                                                ],
                                                done: function () {

                                                }
                                            }));
                                        }
                                    });
                                    break;
                            }
                        });
                    }
                    , cancel: function (index, layero) {

                    }
                });
                return false;
            });

            //常设列席选择
            $('#attender-setting').on('click', function () {
                var index_qx = layer.open({
                    offset: '10px',
                    title: '编辑常设列席人员情况',
                    // maxmin: false,
                    area: ['800px', '90%'],//高度自适应
                    type: 1,//页面层
                    shadeClose: false,
                    btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                    btnAlign: 'c',
                    yes: function () {
                        common.fetchPost('meetingmgr/tiolAttender/selectTiolAttenderList', { meetingId: meetingIdForm }, function (data) {
                            if (data.success) {
                                $("#attenders").val(data.object);
                            } else {
                                layer.alert("查询常设列席信息失败:" + data.resultMessage);
                            }
                        }, function () {
                            layer.alert('查询常设列席信息失败');//失败后提示
                        });
                        layer.close(index_qx);
                        return false;
                    },
                    btn2: function () {
                        layer.close(index_qx);
                        return false;
                    },
                    content: $('.set-attenderForm').html(),//加载该区域的html
                    success: function (obj) {
                        table.render(common.tableInitParams({
                            elem: $(obj.selector).find('#attenderTable'),
                            id: "attenderTableReload",
                            url: baseUrl + 'meetingmgr/tiolAttender/selectTiolAttenderPage?meetingId=' + meetingIdForm,
                            contentType: 'text/plain',
                            method: 'get',
                            // request:null,
                            toolbar: '#attenderToolBar',
                            // data:qxryData,
                            cellMinWidth: 60,
                            height: 'full-300',
                            defaultToolbar: [],
                            cols: [
                                [
                                    { type: 'checkbox' },
                                    { type: 'numbers', title: '序号' },
                                    { field: 'attenderSuName', title: '常设列席人' },
                                    { field: 'attenderJob', title: '职位' },
                                    { field: 'remark', title: '备注' },
                                    { field: '', title: '操作', toolbar: '#attenderTableOper', width: 80, align: "center" }
                                ]
                            ],
                            done: function () {

                            }
                        }));
                        table.on('toolbar(attenderTable)', function (obj) {
                            var checkStatus = table.checkStatus(obj.config.id);
                            // var data = obj.data;
                            var data = obj.config;
                            switch (obj.event) {
                                case 'add':
                                    var index_add = layer.open({
                                        offset: '10px',
                                        title: '<i class="iconfont icon-SZYD-xitongcaidanguanli"></i>新增常设列席',
                                        maxmin: false,
                                        area: ['580px', '90%'],//高度自适应
                                        type: 1,//页面层
                                        shadeClose: false,
                                        btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                                        btnAlign: 'c',
                                        yes: function () {
                                            $("[lay-filter='formAttenderAdd']").click();
                                            layer.close(index_add);
                                            return false;
                                        },
                                        btn2: function () {
                                            layer.close(index_add);
                                        },
                                        content: $('.setAdd-attenderForm').html(),//加载该区域的html
                                        success: function (obj) {
                                            form.render();
                                        }
                                    });
                                    break;
                                case 'del':
                                    //点击删除按钮
                                    if (checkStatus.data.length > 0) {
                                        layer.confirm('确定删除选中列?', { icon: 3, title: '提示', offset: '150px' }, function (index) {

                                            var attenderIdArr = [];

                                            for (var i = 0; i < checkStatus.data.length; i++) {
                                                attenderIdArr.push(checkStatus.data[i]['attenderId'])
                                            }
                                            var layerLoader = common.layerLoader();
                                            common.fetchDelete('meetingmgr/tiolAttender/deleteTiolAttenderByIds?attenderIds=' + attenderIdArr.join(','), function () {
                                                layer.close(layerLoader);

                                                table.reload('attenderTableReload', {
                                                    page: {}
                                                    , where: {
                                                        meetingId: meetingIdForm
                                                    }
                                                });
                                                layer.alert('删除常设列席成功');
                                            }, function () {
                                                layer.close(layerLoader);
                                            });

                                            layer.close(index);
                                        });
                                    } else {
                                        layer.alert('请选择删除列');
                                    }
                                    break;
                                case 'choose':
                                    var index_add = layer.open({
                                        offset: '10px',
                                        title: '<i class="iconfont icon-SZYD-xitongcaidanguanli"></i>选择常设人员',
                                        maxmin: false,
                                        area: ['580px', '90%'],//高度自适应
                                        type: 1,//页面层
                                        shadeClose: false,
                                        btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                                        btnAlign: 'c',
                                        yes: function () {
                                            var seId = $("#curSeId")[0].value;
                                            var checkStatus = table.checkStatus("memberTableReload");
                                            var memberTypeIdArr = [];
                                            for (var i = 0; i < checkStatus.data.length; i++) {
                                                memberTypeIdArr.push(checkStatus.data[i]['memberTypeId'])
                                            }
                                            var meetingId = $("#meetingId")[0].value;
                                            var layerLoader = common.layerLoader();
                                            common.fetchPost('meetingmgr/tiolAttender/saveTiolAttenderInfoRel', { "memberTypeIds": memberTypeIdArr.join(','), "meetingId": meetingId }, function () {
                                                layer.close(layerLoader);
                                                //成功之后刷新tree 以及表格
                                                table.reload('memberTableReload', {
                                                    page: {}
                                                    , where: {
                                                        meetingId: meetingIdForm,
                                                        meetingTypeId: meetingTypeId,
                                                        seId: seId,
                                                        memberAttendeeType: 'attender'
                                                    }
                                                });
                                                //成功之后刷新tree 以及表格
                                                table.reload('attenderTableReload', {
                                                    page: {}
                                                    , where: {
                                                        meetingId: meetingIdForm
                                                    }
                                                });
                                                layer.alert('关联成功');
                                            }, function () {
                                                layer.close(layerLoader);
                                            });

                                            layer.close(index_add);
                                            return false;
                                        },
                                        btn2: function () {
                                            layer.close(index_add);
                                        },
                                        content: $('.memberTable').html(),//加载该区域的html
                                        success: function (obj) {
                                            var seId = $("#curSeId")[0].value;
                                            table.render(common.tableInitParams({
                                                elem: $(obj.selector).find('#memberTable'),
                                                url: baseUrl + 'meetingmgr/tiolCompanyMember/selectTiolCompanyMemberPageSelect',
                                                // contentType:'text/plain',
                                                id: 'memberTableReload',
                                                method: 'post',
                                                where: { "meetingTypeId": meetingTypeId, "seId": seId, memberAttendeeType: 'attender', meetingId: meetingIdForm, },
                                                // request:null,
                                                // toolbar:'#memberToolBar',
                                                // data:resAdd,
                                                height: 'full-200',
                                                defaultToolbar: [],
                                                cols: [
                                                    [
                                                        { type: 'checkbox' },
                                                        { type: 'numbers', title: '序号' },
                                                        { field: 'memberName', title: '姓名' },
                                                        { field: 'jobName', title: '职位' },
                                                        { field: 'startDate', title: '开始时间' },
                                                        { field: 'endDate', title: '结束时间' }
                                                    ]
                                                ],
                                                done: function () {

                                                }
                                            }));
                                        }
                                    });
                                    break;

                                    case "upFile":
                                        layer.msg("模拟上移");
                                        break;
                                        case "downFile":
                                        layer.msg("模拟下移");
                                        break;
                            }
                        });
                    }
                });
                return false;
            });

            //table监听事件
            table.on('toolbar(ytList)', function (obj) {
                var checkStatus = table.checkStatus(obj.config.id);
                // var data = obj.data;
                var data = obj.config;
                switch (obj.event) {
                    case 'add':
                        if (formOperType == 'edit') {
                            var index_add = layer.open({
                                offset: '20px',
                                title: '<i class="iconfont icon-SZYD-xitongcaidanguanli"></i>待上会议题清单',
                                maxmin: false,
                                area: ['80%', '80%'],//高度自适应
                                type: 1,//页面层
                                shadeClose: false,
                                btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                                btnAlign: 'c',
                                yes: function () {
                                    var checkStatus = table.checkStatus("dshytList");
                                    if (checkStatus.data.length == 0) {
                                        layer.alert('请选择要关联的议案');
                                        return;
                                    }
                                    var motionIdArr = [];
                                    for (var i = 0; i < checkStatus.data.length; i++) {
                                        motionIdArr.push(checkStatus.data[i]['motionId'])
                                    }
                                    var meetingId = $("#meetingId")[0].value;
                                    var layerLoader = common.layerLoader();
                                    common.fetchPost('meetingmgr/tiolSubject/saveTiolSubjectInfos', { "motionIds": motionIdArr.join(','), "meetingId": meetingId, "meetingTypeCode": meetingTypeCode }, function (res) {
                                        layer.close(layerLoader);
                                        if (res.success) {
                                            //成功之后刷新tree 以及表格
                                            table.reload('subjectTableReload', {
                                                page: {}
                                                , where: {
                                                    meetingId: meetingIdForm
                                                }
                                            });
                                            layer.alert('关联成功');
                                        } else {
                                            layer.alert(res.resultMessage);
                                            return;
                                        }
                                    }, function () {
                                        layer.close(layerLoader);
                                    });

                                    layer.close(index_add);
                                    // layer.alert('已提交');
                                    return false;
                                },
                                btn2: function () {
                                    layer.close(index_add);
                                },
                                content: $('.dshyt').html(),//加载该区域的html
                                // content: ' <div style="padding: 15px 20px"> <table id="pedding-yts" lay-filter="pedding-yts"></table> </div>',//加载该区域的html
                                success: function (obj) {
                                    var meetingTypeId = $("#meetingTypeId")[0].value;
                                    var seId = $("#curSeId")[0].value;
                                    table.render(common.tableInitParams({
                                        elem: $(obj.selector).find('#dshyt'),
                                        url: baseUrl + 'motionmgr/motiona/selectMotionSubmitedMeetingPage',
                                        id: 'dshytList',
                                        // contentType:'text/plain',
                                        method: 'post',
                                        where: { "meetingTypeId": meetingTypeId, "ggCreateEid": seId },
                                        // request:null,
                                        // toolbar:'#dshytToolBar',
                                        // data:resAdd,
                                        height: 'full-200',
                                        defaultToolbar: [],
                                        cols: [
                                            [
                                                { type: 'checkbox' },
                                                { type: 'numbers', title: '序号' },
                                                // {field: 'ggSort', title: '序号',width:80,align:'center', sort: true},
                                                { field: 'motionName', title: '议案名称' },
                                                // {field: 'msName', title: '议题名称',sort:true},
                                                { field: 'soName', title: '提出部门' },
                                                { field: 'motionCreateTime', title: '提交日期' }

                                            ]
                                        ],
                                        done: function () {

                                        }
                                    }));
                                    var el5;
                                    if (!el5) {
                                        common.fetchPost('sysmgr/sysOrgan/selectSysOrganTreeBySeId', {}, function (data) {
                                            if (data.success) {
                                                el5 = tree.render({
                                                    elem: '.ele5',
                                                    data: data.list,
                                                    defaultExpandAll: true,
                                                    expandOnClickNode: false,
                                                    highlightCurrent: true
                                                });
                                            } else {
                                                layer.alert('查询部门树失败');
                                            }
                                        }, function () {
                                            layer.alert('查询部门树失败');//失败后提示
                                        });
                                    }
                                    $("[name='soName']").on("click", function (e) {
                                        e.stopPropagation();
                                        $(".ele5").toggle();
                                    });
                                    tree.on("nodeClick(data5)", function (d) {
                                        $("[name='soName']").val(d.data.parentData.data.id != d.data.currentData.id ? (d.data.parentData.data.name + '-' + d.data.currentData.name) : d.data.currentData.name);
                                        $("[name='soId']").val(d.data.currentData.id);
                                        $(".ele5").hide();
                                    });
                                    laydate.render({
                                        elem: '#motionCreateTime',
                                        type: 'date',
                                        range: true,
                                        trigger: 'click'
                                    });
                                    form.render();
                                    //查询
                                    form.on('submit(dshytSearch)', function (obj) {
                                        var motionCreateTime = obj.field.motionCreateTime;
                                        if (motionCreateTime) {
                                            obj.field.motionCreateTimeStar = motionCreateTime.split(" - ")[0];
                                            obj.field.motionCreateTimeEnd = motionCreateTime.split(" - ")[1];
                                        } else {
                                            obj.field.motionCreateTimeStar = "";
                                            obj.field.motionCreateTimeEnd = "";
                                        }
                                        //表格重载
                                        table.reload('dshytList', {
                                            method: 'post',
                                            contentType: 'application/json',
                                            page: {
                                                curr: 1
                                            },
                                            where: obj.field,

                                        });
                                        return false;
                                    });

                                }
                            });
                        } else {
                            layer.alert('请先保存会议');
                        }
                        break;
                    case 'del':
                        //点击删除按钮
                        if (checkStatus.data.length > 0) {
                            layer.confirm('确定删除选中列?', { icon: 3, title: '提示', offset: '150px' }, function (index) {
                                var subjectIdArr = [];

                                for (var i = 0; i < checkStatus.data.length; i++) {
                                    subjectIdArr.push(checkStatus.data[i]['subjectId'])
                                }
                                var layerLoader = common.layerLoader();
                                common.fetchPost('meetingmgr/tiolSubject/deleteTiolSubjectByIds', { "subjectIds": subjectIdArr.join(',') }, function () {
                                    //成功之后刷新tree 以及表格
                                    table.reload('subjectTableReload', {
                                        page: {}
                                        , where: {
                                            meetingId: meetingIdForm
                                        }
                                    });
                                    layer.close(layerLoader);
                                    layer.alert('删除成功');
                                }, function () {
                                    layer.close(layerLoader);
                                });

                                layer.close(index);
                            });
                        } else {
                            layer.alert('请选择删除列')
                        }
                        break;
                    case 'up':
                        if (checkStatus.data.length > 0) {
                            if (checkStatus.data.length > 1) {
                                layer.alert("只能选择一条记录进行排序!");
                                return false;
                            }
                            var meetingId = checkStatus.data[0].meetingId;
                            var subjectId = checkStatus.data[0].subjectId;
                            var ggSort = checkStatus.data[0].ggSort;
                            var layerLoader = common.layerLoader();
                            common.fetchPost('meetingmgr/tiolSubject/updateSubjectSort', { "meetingId": meetingId, "subjectId": subjectId, "orderType": "UP", "ggSort": ggSort }, function () {
                                layer.alert("向上排序成功", function (index) {
                                    //成功之后刷新tree 以及表格
                                    table.reload('subjectTableReload', {
                                        page: {}
                                        , where: {
                                            meetingId: meetingIdForm
                                        }
                                    });
                                    layer.close(index);
                                    layer.close(layerLoader);
                                })
                            }, function () {
                                layer.close(layerLoader);
                            });
                        } else {
                            layer.alert('请先选择向上排序的列')
                        }
                        break;
                    case 'down':
                        if (checkStatus.data.length > 0) {
                            if (checkStatus.data.length > 1) {
                                layer.alert("只能选择一条记录进行排序!");
                                return false;
                            }
                            var meetingId = checkStatus.data[0].meetingId;
                            var subjectId = checkStatus.data[0].subjectId;
                            var ggSort = checkStatus.data[0].ggSort;
                            var layerLoader = common.layerLoader();
                            common.fetchPost('meetingmgr/tiolSubject/updateSubjectSort', { "meetingId": meetingId, "subjectId": subjectId, "orderType": "DOWN", "ggSort": ggSort }, function () {
                                layer.alert("向下排序成功", function (index) {
                                    //成功之后刷新tree 以及表格1
                                    table.reload('subjectTableReload', {
                                        page: {}
                                        , where: {
                                            meetingId: meetingIdForm
                                        }
                                    });
                                    layer.close(index);
                                    layer.close(layerLoader);
                                })
                            }, function () {
                                layer.close(layerLoader);
                            });
                        } else {
                            layer.alert('请先选择向下排序的列');
                        }
                        break;
                }
            });

            table.on('tool(ytList)', function (obj) {
                var data = obj.data;
                var addLayer
                switch (obj.event) {
                    case 'edit'://编辑
                        yt_index_edit = layer.open({
                            offset: '10px',
                            title: '审议情况',
                            maxmin: false,
                            type: 1,//页面层
                            area: ["100%", "98%"],//高度自适应
                            zIndex: 980,
                            // area: ['580px'],//高度自适应
                            shadeClose: false,
                            btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                            btnAlign: 'c',
                            yes: function () {
                                $("[lay-filter='formSubjectEdit']").click();
                                //layer.close(index_edit);
                            },
                            btn2: function () {
                                layer.close(yt_index_edit);
                            },
                            content: $('#edit-syForm').html(),//加载该区域的html
                            success: function (obj) {
                                
                                form.render();
                                $('#yaView').on('click', function () {

                                    var meetingTypeName = common.getQueryVariable('meetingTypeName');
                                    var viewMeeting = top.layer.open({
                                        title: ['议案查看'],
                                        type: 2,
                                        content: baseUrl + 'src/page/ys/yagl/yaListReportedView.html?motionId=' + data.subjectId + "&meetingTypeName=" + meetingTypeName,
                                        maxmin: true
                                    });
                                    top.layer.full(viewMeeting);
                                })
                                eventHandle.initDict(['exigence', 'passFlag', 'resultType', 'position']);
                                var subjectIdForm = data.subjectId;
                                common.fetchGet('sysmgr/dicts/selectDictListByPcode?dictPCode=attendStatus', function (data) {
                                    if (data && data.list && data.list.length > 0) {
                                        attendStatusList = data.list;
                                        $.map(data.list, function (item) {
                                            attendStatusMap[item.sdCode] = item;
                                        });
                                    }
                                });
                                common.fetchGet('sysmgr/dicts/selectDictListByPcode?dictPCode=DELIBERATIONRESULT', function (data) {
                                    if (data && data.list && data.list.length > 0) {
                                        deliberationResultList = data.list;
                                        $.map(data.list, function (item) {
                                            deliberationResultMap[item.sdCode] = item;
                                        });
                                    }
                                });
                                common.fetchPost('meetingmgr/tiolSubject/selectTiolSubjectById', { subjectId: data.subjectId }, function (data) {
                                    if (data.success) {
                                        $(obj.selector).find('input[name=subjectId]').val(data.object.subjectId);
                                        $(obj.selector).find('input[name=subjectName]').val(data.object.subjectName);
                                        $(obj.selector).find('input[name=subjectCode]').val(data.object.subjectCode);
                                        $(obj.selector).find('select[name=exigence]').val(data.object.exigence);
                                        $(obj.selector).find('input[name=exigenceName]').val(data.object.exigenceName);
                                        $(obj.selector).find('input[name=deliberationName]').val(data.object.deliberationName);
                                        $(obj.selector).find('select[name=resultType]').val(data.object.resultType == null ? '1/2' : data.object.resultType);
                                        $(obj.selector).find('input[name=resultTypeName]').val(data.object.resultTypeName == null ? '普通决议' : data.object.resultTypeName);
                                        $(obj.selector).find('input[name=msSpeaker]').val(data.object.msSpeaker);
                                        $(obj.selector).find('input[name=attendances]').val(data.object.attendances);
                                        $(obj.selector).find('select[name=passFlag]').val(data.object.passFlag);
                                        $(obj.selector).find('textarea[name=subjectResult]').val(data.object.subjectResult);
                                        $(obj.selector).find('input[name=bjqk]').val(data.object.bjqk);
                                        //$(obj.selector).find('select[name=approvalFlag]').val(data.object.approvalFlag);
                                        form.render();
                                        // 判断审议类型=========================
                                        //讨论类和通报类没有审议结果和表决
                                        if (data.object.deliberationCode === "1" || data.object.deliberationCode === "2") {
                                            $('#bjxq').hide();
                                            $('#syjg').hide();
                                        } else {
                                            $('#bjxq').show();
                                            $('#syjg').show();
                                        }
                                    } else {
                                        layer.alert("查询会议信息失败:" + data.resultMessage);
                                    }
                                }, function () {
                                    layer.alert('查询会议信息失败');//失败后提示
                                });
                                var cols;
                                if (meetingTypeCode == 'GD') {
                                    cols = [[
                                        { type: 'checkbox' },
                                        { type: 'numbers', title: '序号', width: 80 },
                                        { field: 'deliberationPersonnel', title: '股东名称' },
                                        { field: 'voteUser', title: '投票人' },
                                        { field: 'job', title: '职务' },
                                        { field: 'stockRatio', title: '持股比例' },
                                        { field: 'voteNum', title: '投票股数' },
                                        {
                                            field: 'attendStatus', title: '参会状态',
                                            templet: function (rowData) {
                                                if (rowData['attendStatus'] && attendStatusMap[rowData['attendStatus']]) {
                                                    return attendStatusMap[rowData['attendStatus']]['sdName'];
                                                } else {
                                                    return '';
                                                }
                                            }
                                        }
                                        , {
                                            field: 'deliberationResult1', title: '审议意见', templet: "#tableSelect"
                                            // templet: function (rowData) {
                                            //     if (rowData['deliberationResult'] && deliberationResultMap[rowData['deliberationResult']]) {
                                            //         if(rowData['deliberationResult'] == "同意"){
                                            //     return '<span class="green">同意</span>'
                                            // }else if(rowData['deliberationResult'] == "反对"){
                                            //     return '<span class="red">反对</span>'
                                            // }else{
                                            //     return '<span class="green3">弃权</span>'
                                            // };
                                            //     } else {
                                            //         return '';
                                            //     }
                                            // }
                                        }
                                        , { field: 'remark', title: '备注' },
                                        { field: '', title: '操作', toolbar: '#bjTableOper', fixed: 'right' }
                                    ]];
                                } else {
                                    cols = [[
                                        { type: 'checkbox' },
                                        { type: 'numbers', title: '序号', width: 80 },
                                        { field: 'deliberationPersonnel', title: '姓名' },
                                        { field: 'job', title: '职务' },
                                        {
                                            field: 'attendStatus', title: '参会状态',
                                            templet: function (rowData) {
                                                if (rowData['attendStatus'] && attendStatusMap[rowData['attendStatus']]) {
                                                    return attendStatusMap[rowData['attendStatus']]['sdName'];
                                                } else {
                                                    return '';
                                                }
                                            }
                                        }
                                        , { field: 'reason', title: '缺席原因' }
                                        , {
                                            field: 'deliberationResult1', title: '审议意见', templet: "#tableSelect"
                                            // templet: function (rowData) {
                                            //     if (rowData['deliberationResult'] && deliberationResultMap[rowData['deliberationResult']]) {
                                            //         if(rowData['deliberationResult'] == "同意"){
                                            //     return '<span class="green">同意</span>'
                                            // }else if(rowData['deliberationResult'] == "反对"){
                                            //     return '<span class="red">反对</span>'
                                            // }else{
                                            //     return '<span class="green3">弃权</span>'
                                            // };
                                            //     } else {
                                            //         return '';
                                            //     }
                                            // }
                                        }
                                        , { field: 'remark', title: '备注' },
                                        { field: '', title: '操作', toolbar: '#bjTableOper', fixed: 'right', align: "center" }
                                    ]];
                                }
                                var resData = [
                                    {
                                        deliberationId: "b9230db4c4134a018d1fecdbde99b105",
                                        meetingId: "81VK6MDM828FAN1DQ21JGIBIG4QM627S",
                                        subjectId: "OI3QG03TJ9L88GMLK3AVHR175O2AUO5A",
                                        deliberationResult: "弃权",
                                        deliberationPersonnel: "小东",
                                        ggCreateUser: null,
                                        ggCreateUid: null,
                                        ggCreateDatetime: null,
                                        ggCreateEname: null,
                                        ggCreateEid: null,
                                        ggSort: 140716,
                                        job: "总裁",
                                        attendStatus: "ABSENT",
                                        attendStatusName: "缺席",
                                        remark: null,
                                        reasonCode: null,
                                        reason: "出差",
                                        assignor: null,
                                        voteUser: null,
                                        voteNum: null,
                                        stockRatio: null,
                                        tails: {}
                                    },
                                    {
                                        deliberationId: "2f567a25d05f4363910095bcbc9bdcaf",
                                        meetingId: "81VK6MDM828FAN1DQ21JGIBIG4QM627S",
                                        subjectId: "OI3QG03TJ9L88GMLK3AVHR175O2AUO5A",
                                        deliberationResult: "同意",
                                        deliberationPersonnel: "小敏",
                                        ggCreateUser: null,
                                        ggCreateUid: null,
                                        ggCreateDatetime: null,
                                        ggCreateEname: null,
                                        ggCreateEid: null,
                                        ggSort: 140717,
                                        job: "总理",
                                        attendStatus: "ATTEND",
                                        attendStatusName: "出席",
                                        remark: null,
                                        reasonCode: null,
                                        reason: null,
                                        assignor: null,
                                        voteUser: null,
                                        voteNum: null,
                                        stockRatio: null,
                                        tails: {}
                                    }
                                ];
                                
                                table.render(common.tableInitParams({//表决情况表
                                    elem: $(obj.selector).find('#bjTable'),
                                    url: baseUrl + 'meetingmgr/tiolDeliberation/selectTiolDeliberationPage?subjectId=' + data.subjectId,
                                    // data: resData,
                                    where: {
                                        subjectId: data.subjectId
                                    },
                                    method: 'post',
                                    height: '300',
                                    //toolbar:'#deliberationToolBar',
                                    // height: false,
                                    page: false,
                                    // page:false,
                                    defaultToolbar: [],
                                    cols: cols,
                                    done: function (res, curr, count) {
                                        if (res.data.length > 0) {
                                            agree = 0;
                                            disagree = 0;
                                            notFill = 0;
                                            layui.each($('select[name=deliberationResult1]'), function (index, item) {
                                                var elem = $(item);
                                                elem.find('option[value= ' + res.data[index].deliberationResult + ']').attr('selected', true);
                                                // elem.val(resData[index].deliberationResult);// .parents('div.layui-table-cell').css('overflow','visible');
                                                if(res.data[index].deliberationResult == "同意"){
                                                    agree += 1;
                                                }else if(res.data[index].deliberationResult == "弃权"){
                                                    disagree += 1;
                                                }else if(res.data[index].deliberationResult == "反对"){
                                                    disagree += 1;
                                                }else if(res.data[index].deliberationResult == null){
                                                    notFill += 1;
                                                }1
                                            });
                                            form.render('select');
                                        }
                                        if(agree >0 && disagree == 0 && notFill == 0 && $("select[name=passFlag]").val() === "0"){
                                                layer.alert("表决情况中均为同意，请编辑表决情况的审议意见！");
                                            }else if (agree == 0 && disagree > 0 && notFill == 0 && $("select[name=passFlag]").val() === "1") {
                                                layer.alert("表决情况中均为非同意，请编辑表决情况的审议意见！");
                                            }

                                    }

                                }));
                                form.on('select(deliberationResult)', function (obj) {
                                    var layerLoader = common.layerLoader();
                                    var elem = $(obj.elem);
                                    var trElem = elem.parents('tr');
                                    var tableData = table.cache['bjTable'];
                                    // 更新到表格的缓存数据中，才能在获得选中行等等其他的方法中得到更新之后的值
                                    tableData[trElem.data('index')][elem.attr('name')] = obj.value;
                                    var params = {
                                        deliberationId: tableData[trElem.data('index')].deliberationId,
                                        deliberationResult: obj.value
                                    }
                                    common.fetchPost('meetingmgr/tiolDeliberation/saveTiolDeliberationInfo', params, function (res) {
                                        if (res.success) {
                                            layer.close(layerLoader);
                                            layer.alert("成功修改审议意见");
                                            table.reload("bjTable")
                                            eventHandle.shqkInit(tableData[trElem.data('index')].subjectId)
                                            // console.log($("select[name=passFlag]").val());
                                            
                                            
                                        } else {
                                            layer.close(layerLoader);
                                            layer.alert(res.resultMessage);
                                        }
                                    }, function (err) {
                                        layer.close(layerLoader);
                                        layer.alert(res.resultMessage);
                                    })
                                });

                                //table监听事件
                                table.on('toolbar(bjTable)', function (obj) {
                                    var checkStatus = table.checkStatus(obj.config.id);
                                    switch (obj.event) {
                                        case 'add':
                                            bj_index_edit = layer.open({
                                                offset: '10px',
                                                title: '<i class="iconfont icon-SZYD-xitongcaidanguanli"></i>新增表决表单',
                                                maxmin: false,
                                                type: 1,//页面层
                                                area: ['580px', '90%'],//高度自适应
                                                shadeClose: false,
                                                btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                                                btnAlign: 'c',
                                                yes: function () {
                                                    $("[lay-filter='deliberationAdd']").click();
                                                    return false;
                                                },
                                                btn2: function () {
                                                    layer.close(bj_index_edit);
                                                },
                                                content: $('.bjqk-edit').html(),//加载该区域的html
                                                success: function (obj) {
                                                    form.render();

                                                    common.selectDataSet({
                                                        elem: $('[name=deliberationResult]'),
                                                        loadData: deliberationResultList,
                                                        optionText: 'sdName',
                                                        optionValue: 'sdCode'
                                                    });
                                                    $(obj.selector).find('input[name=deliberationId]').val(data.deliberationId);
                                                    $(obj.selector).find('input[name=subjectId]').val(data.subjectId);
                                                    $(obj.selector).find('input[name=deliberationPersonnel]').val(data.deliberationPersonnel);
                                                    $(obj.selector).find('input[name=job]').val(data.job);
                                                    $(obj.selector).find('input[name=attendStatusName]').val(data.attendStatus);
                                                    $(obj.selector).find('input[name=assignor]').val(data.assignor);
                                                    $(obj.selector).find('textarea[name=reason]').val(data.reason);
                                                    $(obj.selector).find('select[name=deliberationResult]').val(data.deliberationResult);
                                                    $(obj.selector).find('textarea[name=remark]').val(data.remark);
                                                    form.render('select');
                                                }
                                            });
                                            break;
                                        case 'del':
                                            //点击删除按钮
                                            if (checkStatus.data.length > 0) {
                                                layer.confirm('确定删除选中列?', { icon: 3, title: '提示', offset: '150px' }, function (index) {
                                                    // layer.alert('演示 已删除');
                                                    // return false;
                                                    var deliberationIdArr = [];

                                                    for (var i = 0; i < checkStatus.data.length; i++) {
                                                        deliberationIdArr.push(checkStatus.data[i]['deliberationId']);
                                                    }
                                                    var subjectId = checkStatus.data[0].subjectId;
                                                    var layerLoader = common.layerLoader();
                                                    common.fetchPost('meetingmgr/tiolDeliberation/deleteTiolDeliberationByIds', { "deliberationIds": deliberationIdArr.join(',') }, function () {
                                                        layer.close(layerLoader);
                                                        eventHandle.shqkInit(subjectId);
                                                        table.reload('bjTable', {
                                                            page: {}
                                                            , where: {
                                                                subjectId: subjectId
                                                            }
                                                        });
                                                        layer.alert('删除成功');
                                                    }, function () {
                                                        layer.close(layerLoader);
                                                    });

                                                    layer.close(index);
                                                });
                                            } else {
                                                layer.alert('请选择删除列');
                                            }
                                            break;
                                    }
                                });
                                table.on('tool(bjTable)', function (obj) {
                                    var data = obj.data;
                                    switch (obj.event) {
                                        case 'edit'://编辑
                                            bj_index_edit = layer.open({
                                                offset: '10px',
                                                title: '<i class="iconfont icon-SZYD-xitongcaidanguanli"></i>编辑表决表单',
                                                maxmin: false,
                                                type: 1,//页面层
                                                area: ['580px', '90%'],//高度自适应
                                                shadeClose: false,
                                                btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                                                btnAlign: 'c',
                                                yes: function () {
                                                    $("[lay-filter='deliberationAdd']").click();
                                                    //layer.close(index_edit);
                                                    return false;
                                                },
                                                btn2: function () {
                                                    layer.close(bj_index_edit);
                                                },
                                                content: $('.bjqk-edit').html(),//加载该区域的html
                                                success: function (obj) {

                                                    form.render();
                                                    common.selectDataSet({
                                                        elem: $('[name=deliberationResult]'),
                                                        loadData: deliberationResultList,
                                                        optionText: 'sdName',
                                                        optionValue: 'sdCode'
                                                    });
                                                    $(obj.selector).find('input[name=deliberationId]').val(data.deliberationId);
                                                    $(obj.selector).find('input[name=subjectId]').val(data.subjectId);
                                                    $(obj.selector).find('input[name=deliberationPersonnel]').val(data.deliberationPersonnel);
                                                    $(obj.selector).find('input[name=job]').val(data.job);
                                                    $(obj.selector).find('input[name=attendStatusName]').val(attendStatusMap[data.attendStatus]['sdName']);
                                                    $(obj.selector).find('textarea[name=reason]').val(data.reason);
                                                    $(obj.selector).find('select[name=deliberationResult]').val(data.deliberationResult);
                                                    $(obj.selector).find('textarea[name=remark]').val(data.remark);
                                                    form.render('select');
                                                }
                                            });
                                    }
                                });

                                //---------------------议题附件列表star
                                table.render(common.tableInitParams({//议题附件列表
                                    elem: $(obj.selector).find('#subjectFileTable'),
                                    url: baseUrl + 'dfsmgr/file/getFileByResIdAndFileType?id=' + subjectIdForm + '&type=OTHER_SUBJECT',
                                    method: 'post',
                                    height: '300',
                                    height: false,
                                    page: false,
                                    toolbar: '#subjectFileToolBar',
                                    id: 'subjectFileTableReload',
                                    defaultToolbar: [],
                                    cols: [[
                                        { type: 'checkbox' },
                                        { type: 'numbers', title: '序号' },
                                        { field: 'fiOriginalName', title: '文件名称' },
                                        { field: '', title: '操作', toolbar: '#subjectFileTableOper', width: 100, fixed: 'right', align: "center" }
                                    ]],
                                    done: function () {
                                        // common.buttonLimit();
                                    }
                                    , page: true
                                }));

                                table.on('toolbar(subjectFileTable)', function (obj) {
                                    var checkStatus = table.checkStatus(obj.config.id);
                                    // var data = obj.data;
                                    var data = obj.config;
                                    switch (obj.event) {
                                        case 'add':
                                            var loadIndex;
                                            var index_add = layer.open({
                                                title: '<i class="iconfont icon-SZYD-xitongcaidanguanli"></i>新增议题资料',
                                                area: ['580px', '480px'],//高度自适应
                                                type: 1,//页面层
                                                content: $('#subject-add').html(),//加载该区域的html
                                                success: function (obj) {
                                                    var parent = $(obj.selector);
                                                    $(obj.selector).find('.btnClose').off().on('click', function () {
                                                        layer.close(index_add);
                                                    });
                                                    var fileUpload = upload.render({
                                                        elem: '#uploadSubjectFile',
                                                        url: baseUrl + 'zuul/dfsmgr/file/fileUpload',
                                                        auto: false,
                                                        bindAction: "#fileSubjectUpload",
                                                        accept: 'file',
                                                        data: {
                                                            fname: function () {
                                                                return parent.find("input[name=fileName]").val()
                                                            },
                                                            memo: function () {
                                                                return parent.find('[name=maRemarks]').val()
                                                            }
                                                        },
                                                        exts: 'pdf|ofd',
                                                        choose: function (obj) {
                                                            obj.preview(function (index, file, result) {
                                                                parent.find("#fileNameArea").show();
                                                                var arr = file.name.split('.');

                                                                if (file.name.split('.').length > 2) {
                                                                    var fileName = '';
                                                                    $.map(arr, function (item, index) {
                                                                        if (index !== (arr.length - 1)) {
                                                                            fileName += item;
                                                                        }
                                                                    });
                                                                    parent.find("input[name=fileName]").val(fileName);
                                                                } else {
                                                                    parent.find("input[name=fileName]").val(file.name.split('.')[0]);
                                                                }
                                                                parent.find("input[name=fileType]").val('.' + arr[arr.length - 1]);
                                                            });
                                                        },
                                                        before: function (obj) { //obj参数包含的信息，跟 choose回调完全一致，可参见上文。
                                                            //var fiFileType=$("select[name=fiFileType]").val();
                                                            this.data = {
                                                                resId: subjectIdForm,
                                                                fiFileType: "OTHER_SUBJECT",
                                                                fname: parent.find("input[name=fileName]").val(),
                                                                memo: parent.find('[name=maRemarks]').val()
                                                            };
                                                            loadIndex = layer.load();
                                                        },
                                                        done: function (res, index, upload) {
                                                            layer.close(loadIndex);
                                                            layer.close(index_add);
                                                            table.reload('subjectFileTableReload', {
                                                                page: {}
                                                                , where: {
                                                                    resId: subjectIdForm
                                                                }
                                                            });
                                                        }
                                                    });
                                                    form.render("select");

                                                }
                                            });
                                            break;
                                        case 'del':
                                            //点击删除按钮
                                            if (checkStatus.data.length > 0) {
                                                layer.confirm('确定删除选中列?', { icon: 3, title: '提示', offset: '150px' }, function (index) {
                                                    var fiIdArr = [];
                                                    for (var i = 0; i < checkStatus.data.length; i++) {
                                                        fiIdArr.push(checkStatus.data[i]['fiId'])
                                                    }
                                                    var layerLoader = common.layerLoader();
                                                    var id = fiIdArr.join(',');
                                                    common.fetchDelete('dfsmgr/file/deleteById?id=' + fiIdArr.join(','), function () {
                                                        table.reload('subjectFileTableReload', {
                                                            page: {}
                                                            , where: {
                                                                resId: subjectIdForm
                                                            }
                                                        });
                                                        layer.close(layerLoader);
                                                    }, function () {
                                                        layer.close(layerLoader);
                                                    });

                                                    layer.close(index);
                                                });
                                            } else {
                                                layer.alert('请选择删除列')
                                            }
                                            break;
                                        case 'up':
                                            if (checkStatus.data.length > 0) {
                                                if (checkStatus.data.length > 1) {
                                                    layer.alert("只能选择一条记录进行排序!");
                                                    return false;
                                                }
                                                var meetingId = checkStatus.data[0].meetingId;
                                                var subjectId = checkStatus.data[0].subjectId;
                                                var ggSort = checkStatus.data[0].ggSort;
                                                var layerLoader = common.layerLoader();
                                                common.fetchPost('meetingmgr/tiolSubject/updateSubjectSort', { "meetingId": meetingId, "subjectId": subjectId, "orderType": "UP", "ggSort": ggSort }, function () {
                                                    layer.alert("向上排序成功", function (index) {
                                                        //成功之后刷新tree 以及表格
                                                        table.reload('subjectFileTableReload', {
                                                            page: {}
                                                            , where: {
                                                                meetingId: meetingIdForm
                                                            }
                                                        });
                                                        layer.close(index);
                                                        layer.close(layerLoader);
                                                    })
                                                }, function () {
                                                    layer.close(layerLoader);
                                                });
                                            } else {
                                                layer.alert('请先选择向上排序的列')
                                            }
                                            break;
                                        case 'down':
                                            if (checkStatus.data.length > 0) {
                                                if (checkStatus.data.length > 1) {
                                                    layer.alert("只能选择一条记录进行排序!");
                                                    return false;
                                                }
                                                var meetingId = checkStatus.data[0].meetingId;
                                                var subjectId = checkStatus.data[0].subjectId;
                                                var ggSort = checkStatus.data[0].ggSort;
                                                var layerLoader = common.layerLoader();
                                                common.fetchPost('meetingmgr/tiolSubject/updateSubjectSort', { "meetingId": meetingId, "subjectId": subjectId, "orderType": "DOWN", "ggSort": ggSort }, function () {
                                                    layer.alert("向下排序成功", function (index) {
                                                        //成功之后刷新tree 以及表格1
                                                        table.reload('subjectFileTableReload', {
                                                            page: {}
                                                            , where: {
                                                                meetingId: meetingIdForm
                                                            }
                                                        });
                                                        layer.close(index);
                                                        layer.close(layerLoader);
                                                    })
                                                }, function () {
                                                    layer.close(layerLoader);
                                                });
                                            } else {
                                                layer.alert('请先选择向下排序的列');
                                            }
                                            break;
                                    }
                                });

                                table.on('tool(subjectFileTable)', function (obj) {
                                    var data = obj.data;
                                    switch (obj.event) {
                                        case 'load':
                                            // var sURL = baseUrl + "dfsmgr/file/filesDownload?fid=" + obj.data.fiId;
                                            // window.location.href = sURL;
                                            common.pdfPreview(data.fiId, data.fiSuffix);
                                            break;
                                    }
                                });
                                //---------------------议题附件列表end
                                $(obj.selector).find('#passFlag-btn').on('click', function () {
                                    layer.confirm('确定进行计算?', { icon: 3, title: '提示', offset: '150px' }, function (index) {
                                        var subjectFrom = $(obj.selector);
                                        var subjectId = subjectFrom.find('input[name=subjectId]').val();
                                        var layerLoader = common.layerLoader();
                                        common.fetchPost('meetingmgr/tiolDeliberation/selectTiolDeliberationJs?subjectId=' + subjectId, null, function (res) {
                                            $('select[name=passFlag]').val(res.object.passFlag);
                                            $('input[name=passFlagName]').val(res.object.passFlagName);
                                            form.render();
                                            if (res.object.resultMsg != '' && res.object.resultMsg != null) {
                                                layer.alert(res.object.resultMsg);
                                            } else {
                                                layer.alert('计算成功');
                                            }
                                            layer.close(layerLoader);
                                        }, function () {
                                            layer.close(layerLoader);
                                        });
                                        layer.close(index);
                                    });
                                    return false;
                                });
                                $(obj.selector).find('#attendances-btn').on('click', function () {
                                    var subjectFrom = $(obj.selector);
                                    var subjectId = subjectFrom.find('input[name=subjectId]').val();
                                    var index_lx = layer.open({
                                        offset: '10px',
                                        title: '<i class="iconfont icon-SZYD-xitongcaidanguanli"></i>列席人员选择',
                                        // maxmin: false,
                                        area: ['800px', '90%'],//高度自适应
                                        type: 1,//页面层
                                        shadeClose: false,
                                        btn: ['<i class="layui-icon">&#xe605;</i>确定'],
                                        btnAlign: 'c',
                                        yes: function () {
                                            common.fetchPost('meetingmgr/tiolAttendance/selectTiolAttendanceList', { subjectId: subjectId }, function (data) {
                                                if (data.success) {
                                                    subjectFrom.find('input[name=attendances]').val(data.object);
                                                    form.render();
                                                } else {
                                                    layer.alert("查询列席人员信息失败:" + data.resultMessage);
                                                }
                                            }, function () {
                                                layer.alert('查询列席人员信息失败');//失败后提示
                                            });
                                            layer.close(index_lx);
                                            return false;
                                        },
                                        content: $('.set-attendanceForm').html(),//加载该区域的html
                                        success: function (obj) {
                                            table.render(common.tableInitParams({
                                                elem: $(obj.selector).find('#attendanceTable'),
                                                id: "attendanceTableReload",
                                                url: baseUrl + 'meetingmgr/tiolAttendance/selectTiolAttendancePage?subjectId=' + subjectId,
                                                contentType: 'text/plain',
                                                method: 'get',
                                                toolbar: '#attendanceToolBar',
                                                cellMinWidth: 60,
                                                height: 'full-300',
                                                defaultToolbar: [],
                                                cols: [
                                                    [
                                                        { type: 'checkbox' },
                                                        { type: 'numbers', title: '序号' },
                                                        { field: 'attendanceName', title: '列席人' },
                                                        { field: 'positionName', title: '职位' }
                                                    ]
                                                ],
                                                done: function () {

                                                }
                                            }));
                                            table.on('toolbar(attendanceTable)', function (obj) {
                                                var checkStatus = table.checkStatus(obj.config.id);
                                                // var data = obj.data;
                                                var data = obj.config;
                                                switch (obj.event) {
                                                    case 'add':
                                                        var index_add = layer.open({
                                                            offset: '10px',
                                                            title: '<i class="iconfont icon-SZYD-xitongcaidanguanli"></i>新增列席人员',
                                                            maxmin: false,
                                                            area: ['580px', '380px'],//高度自适应
                                                            type: 1,//页面层
                                                            shadeClose: false,
                                                            btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                                                            btnAlign: 'c',
                                                            yes: function (index, obj) {
                                                                var objData = {};
                                                                var attendanceName = $(obj.selector).find('input[name=attendanceName]').val();
                                                                var position = $(obj.selector).find('input[name=position]').val();
                                                                var positionName = $(obj.selector).find('input[name=positionName]').val();
                                                                if (reg.test(attendanceName)) {
                                                                    layer.alert("列席人不能为空!");
                                                                    return;
                                                                }
                                                                if (positionName == "请选择") {
                                                                    positionName = '';
                                                                }
                                                                objData.attendanceName = attendanceName;
                                                                objData.position = position;
                                                                objData.positionName = positionName;
                                                                objData.subjectId = subjectId;
                                                                objData.meetingId = $("#meetingId").val();
                                                                common.fetchPost('meetingmgr/tiolAttendance/saveTiolAttendanceInfo', objData, function (data) {
                                                                    if (data.success) {
                                                                        layer.alert('保存列席人成功');
                                                                        table.reload('attendanceTableReload', {
                                                                            page: {}
                                                                            , where: {
                                                                                subjectId: subjectId
                                                                            }
                                                                        });
                                                                    } else {
                                                                        layer.alert("保存列席人失败:" + data.resultMessage);
                                                                    }
                                                                }, function () {
                                                                    layer.alert('保存列席人失败');//失败后提示
                                                                });
                                                                layer.close(index_add);
                                                                return false;
                                                            },
                                                            btn2: function () {
                                                                layer.close(index_add);
                                                            },
                                                            content: $('.setAdd-attendanceForm').html(),//加载该区域的html
                                                            success: function (obj) {
                                                                form.render();
                                                            }
                                                        });
                                                        break;
                                                    case 'del':
                                                        //点击删除按钮
                                                        if (checkStatus.data.length > 0) {
                                                            layer.confirm('确定删除选中列?', { icon: 3, title: '提示', offset: '150px' }, function (index) {
                                                                var attendanceIdArr = [];

                                                                for (var i = 0; i < checkStatus.data.length; i++) {
                                                                    attendanceIdArr.push(checkStatus.data[i]['attendanceId'])
                                                                }
                                                                var layerLoader = common.layerLoader();
                                                                common.fetchDelete('meetingmgr/tiolAttendance/deleteTiolAttendanceByIds?attendanceIds=' + attendanceIdArr.join(','), function () {
                                                                    layer.close(layerLoader);
                                                                    //成功之后刷新tree 以及表格
                                                                    table.reload('attendanceTableReload', {
                                                                        page: {}
                                                                        , where: {
                                                                            subjectId: subjectId
                                                                        }
                                                                    });
                                                                    layer.alert('删除列席人成功');
                                                                }, function () {
                                                                    layer.close(layerLoader);
                                                                });

                                                                layer.close(index);
                                                            });
                                                        } else {
                                                            layer.alert('请选择删除列');
                                                        }
                                                        break;
                                                }
                                            });
                                        }, cancel: function (index, layero) {

                                        }
                                    });

                                    return false;
                                });

                                form.render('select');
                            }
                        });
                        break;
                    case 'check'://查看
                        //进入议题详情
                        addLayer1 = layer.open({
                            title: ['议题详情'],
                            type: 2,
                            content: baseUrl + '/src/page/ys/yagl/yaListReportedView.html?motionId=' + data.subjectId,
                            maxmin: true,
                            area: ['100%', '95%'],
                            btn: ['<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>关闭'],
                            btnAlign: 'c',
                            yes: function () {
                                layer.close(addLayer1);
                            }
                        });

                        break;
                        layer.full(addLayer1);
                        layer.full(yt_index_edit);
                }
            });

            //table监听事件
            table.on('toolbar(meetingFile)', function (obj) {
                var checkStatus = table.checkStatus(obj.config.id);
                // var data = obj.data;
                var data = obj.config;
                switch (obj.event) {
                    case 'add':
                        var index_add = layer.open({
                            title: '<i class="iconfont icon-SZYD-xitongcaidanguanli"></i>新增会议资料',
                            area: ['580px', '40%'],//高度自适应
                            type: 1,//页面层
                            content: $('#hyzl-add').html(),//加载该区域的html
                            success: function (obj) {
                                var layerLoader
                                var parent = $(obj.selector);
                                eventHandle.initDict(['meetingFileType']);
                                laydate.render({
                                    elem: '[name=printTime]',
                                    type: 'date',
                                    trigger: 'click',
                                    done: function (value) {
                                        $('[name=releaseTime]').val(value);
                                    }
                                });
                                form.on('select(meetingFileType)', function (data) {
                                    if (data.value === 'SUMMARY') {
                                        parent.find('.printTimeArea').show()
                                    } else {
                                        parent.find('.printTimeArea').hide();
                                        $('[name=printTime]').val('');
                                        $('[name=releaseTime]').val('');
                                    }
                                });

                                $(obj.selector).find('.btnClose').off().on('click', function () {
                                    layer.close(index_add);
                                });



                                var fileUpload = upload.render({
                                    elem: '#uploadFile',
                                    url: baseUrl + 'zuul/dfsmgr/file/fileUpload',
                                    auto: false,
                                    bindAction: "#realUploadFile",
                                    accept: 'file',
                                    data: {
                                        fname: function () {
                                            return parent.find("input[name=fileName]").val()
                                        },
                                        memo: function () {
                                            return parent.find('[name=maRemarks]').val()
                                        },
                                        releaseTime: function () {
                                            return parent.find('[name=printTime]').val()
                                        }
                                    },
                                    exts: 'pdf|ofd',
                                    choose: function (obj) {
                                        var fiFileType = $("select[name=fiFileType]").val();
                                        if (!fiFileType) {
                                            layer.alert("资料类型不能为空", {
                                                icon: 5
                                            });
                                        } else {
                                            obj.preview(function (index, file, result) {
                                                parent.find("#fileNameArea").show();
                                                var arr = file.name.split('.');

                                                if (file.name.split('.').length > 2) {
                                                    var fileName = '';
                                                    $.map(arr, function (item, index) {
                                                        if (index !== (arr.length - 1)) {
                                                            fileName += item;
                                                        }
                                                    });
                                                    parent.find("input[name=fileName]").val(fileName);
                                                } else {
                                                    parent.find("input[name=fileName]").val(file.name.split('.')[0]);
                                                }

                                                parent.find("input[name=fileType]").val('.' + arr[arr.length - 1]);
                                            });
                                        }
                                    },

                                    before: function (obj) { //obj参数包含的信息，跟 choose回调完全一致，可参见上文。
                                        var fiFileType = $("select[name=fiFileType]").val();
                                        this.data = {
                                            resId: meetingIdForm,
                                            fiFileType: fiFileType,
                                            fname: parent.find("input[name=fileName]").val(),
                                            memo: parent.find('[name=maRemarks]').val(),
                                            releaseTime: parent.find('[name=printTime]').val()
                                        };
                                    },
                                    done: function (res, index, upload) {
                                        layer.close(layerLoader)
                                        layer.close(index_add);
                                        table.reload('meetingFileTableReload', {
                                            page: {}
                                            , where: {
                                                resId: meetingIdForm
                                            }
                                        });
                                    }
                                });
                                $('#fileUpload').on('click', function () {
                                    if (parent.find('.printTimeArea').css('display') == 'block' && parent.find('#printTimeArea').val() == '') {
                                        layer.alert('请选择印发日期')
                                        return false;
                                    } else {
                                        layerLoader = common.layerLoader()
                                        $("#realUploadFile").click()
                                    }
                                })
                                form.render("select");
                            },
                            btn: false
                        });
                        break;
                    case 'del':
                        //点击删除按钮
                        if (checkStatus.data.length > 0) {
                            layer.confirm('确定删除选中列?', { icon: 3, title: '提示', offset: '150px' }, function (index) {
                                var fiIdArr = [];
                                for (var i = 0; i < checkStatus.data.length; i++) {
                                    fiIdArr.push(checkStatus.data[i]['fiId'])
                                }
                                var layerLoader = common.layerLoader();
                                var id = fiIdArr.join(',');
                                common.fetchDelete('dfsmgr/file/deleteById?id=' + fiIdArr.join(','), function () {
                                    table.reload('meetingFileTableReload', {
                                        page: {}
                                        , where: {
                                            resId: meetingIdForm
                                        }
                                    });
                                    layer.close(layerLoader);
                                }, function () {
                                    layer.close(layerLoader);
                                });

                                layer.close(index);
                            });
                        } else {
                            layer.alert('请选择删除列')
                        }
                        break;
                    case "upFile":
                        if (checkStatus.data.length == 1) {
                            var data = checkStatus.data[0]
                            if (!fileSortData[common.arrayIndexOf(fileSortData, 'fiId', data.fiId) - 1]) {
                                layer.alert('无法上移');
                                return false;
                            }


                            var upFileLayer = layer.confirm("确定上移文件?", {
                                btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消']
                            }, function (index, layero) {
                                $.when(
                                    common.fetchPost("dfsmgr/file/updateFileInfo", {
                                        fiId: data.fiId,
                                        ggSort: data.ggSort - 1
                                    }),//当前条
                                    common.fetchPost("dfsmgr/file/updateFileInfo", {
                                        fiId: fileSortData[common.arrayIndexOf(fileSortData, 'fiId', data.fiId) - 1].fiId,
                                        ggSort: fileSortData[common.arrayIndexOf(fileSortData, 'fiId', data.fiId) - 1].ggSort + 1
                                    })//上一条
                                ).done(function (res1, res2) {
                                    if (res1.success && res2.success) {
                                        table.reload("meetingFileTableReload");
                                        layer.alert("上移成功");
                                        layer.close(upFileLayer);
                                    } else {
                                        layer.alert('上移失败');
                                    }
                                });
                            });
                        } else {
                            layer.alert('请选择一条数据')
                        }

                        break;
                    case "downFile":
                        if (checkStatus.data.length == 1) {
                            var data = checkStatus.data[0]
                            if (!fileSortData[common.arrayIndexOf(fileSortData, 'fiId', data.fiId) + 1]) {
                                layer.alert('无法下移');
                                return false;
                            }
                            var downFileLayer = layer.confirm("确定下移文件?", {
                                btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消']
                            }, function (index, layero) {
                                $.when(
                                    common.fetchPost("dfsmgr/file/updateFileInfo", {
                                        fiId: data.fiId,
                                        ggSort: data.ggSort + 1
                                    }),//当前条
                                    common.fetchPost("dfsmgr/file/updateFileInfo", {
                                        fiId: fileSortData[common.arrayIndexOf(fileSortData, 'fiId', data.fiId) + 1].fiId,
                                        ggSort: fileSortData[common.arrayIndexOf(fileSortData, 'fiId', data.fiId) + 1].ggSort - 1
                                    })//下一条
                                ).done(function (res1, res2) {
                                    if (res1.success && res2.success) {
                                        table.reload("meetingFileTableReload");
                                        layer.alert("下移成功");
                                        layer.close(downFileLayer);
                                    } else {
                                        layer.alert('下移失败');
                                    }
                                });
                            });
                        } else {
                            layer.alert('请选择一条数据')
                        }

                        break;
                }
            });
            table.on('tool(attendeeTable)', function (obj) {
                var data = obj.data;
                switch (obj.event) {
                    case 'edit':
                        var index_add = layer.open({
                            offset: '10px',
                            title: '<i class="iconfont icon-SZYD-xitongcaidanguanli"></i>编辑出席人员',
                            maxmin: false,
                            area: ['580px', '90%'],//高度自适应
                            type: 1,//页面层
                            shadeClose: false,
                            btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                            btnAlign: 'c',
                            yes: function () {
                                $("[lay-filter='formAttendeeAdd']").click();
                                layer.close(index_add);
                                return false;
                            },
                            btn2: function () {
                                layer.close(index_add);
                            },
                            content: $('.setAdd-attendeeForm').html(),//加载该区域的html
                            success: function (obj) {
                                $(obj.selector).find('input[name=attendeeId]').val(data.attendeeId);
                                $(obj.selector).find('input[name=attendeeName]').val(data.attendeeName);
                                $(obj.selector).find('input[name=attendeeJob]').val(data.attendeeJob);
                                $(obj.selector).find('textarea[name=remark]').val(data.remark);
                                form.render();
                            }
                        });
                        break;
                }
            });
            table.on('tool(absentTable)', function (obj) {
                var data = obj.data;
                switch (obj.event) {
                    case 'edit':
                        var index_add = layer.open({
                            offset: '10px',
                            title: '<i class="iconfont icon-SZYD-xitongcaidanguanli"></i>编辑缺席人员',
                            maxmin: false,
                            area: ['580px', '90%'],//高度自适应
                            type: 1,//页面层
                            shadeClose: false,
                            btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                            btnAlign: 'c',
                            yes: function () {
                                $("[lay-filter='formAbsentAdd']").click();
                                layer.close(index_add);
                                return false;
                            },
                            btn2: function () {
                                layer.close(index_add);
                            },
                            content: $('.setAdd-absentForm').html(),//加载该区域的html
                            success: function (obj) {
                                $(obj.selector).find('input[name=attendeeId]').val(data.attendeeId);
                                $(obj.selector).find('input[name=attendeeName]').val(data.attendeeName);
                                $(obj.selector).find('input[name=reason]').val(data.reason);
                                $(obj.selector).find('input[name=assignor]').val(data.assignor);
                                $(obj.selector).find('textarea[name=remark]').val(data.remark);
                                form.render();
                            }
                        });
                        break;
                }
            });
            table.on('tool(attenderTable)', function (obj) {
                var data = obj.data;
                switch (obj.event) {
                    case 'edit':
                        var index_add = layer.open({
                            offset: '10px',
                            title: '<i class="iconfont icon-SZYD-xitongcaidanguanli"></i>编辑常设人员',
                            maxmin: false,
                            area: ['580px', '90%'],//高度自适应
                            type: 1,//页面层
                            shadeClose: false,
                            btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消'],
                            btnAlign: 'c',
                            yes: function () {
                                $("[lay-filter='formAttenderAdd']").click();
                                layer.close(index_add);
                                return false;
                            },
                            btn2: function () {
                                layer.close(index_add);
                            },
                            content: $('.setAdd-attenderForm').html(),//加载该区域的html
                            success: function (obj) {
                                $(obj.selector).find('input[name=attenderId]').val(data.attenderId);
                                $(obj.selector).find('input[name=attenderSuName]').val(data.attenderSuName);
                                $(obj.selector).find('input[name=attenderJob]').val(data.attenderJob);
                                $(obj.selector).find('input[name=ggSort]').val(data.ggSort);
                                $(obj.selector).find('textarea[name=remark]').val(data.remark);
                                form.render();
                            }
                        });
                        break;
                }
            });
            table.on('tool(meetingFile)', function (obj) {
                var data = obj.data;
                switch (obj.event) {
                    case 'load':
                        common.pdfPreview(data.fiId, data.fiSuffix)
                        break;
                    case 'edit':
                        var fileInfoId = data.fiId;
                        var index_add = layer.open({
                            offset: '10px',
                            title: '<i class="iconfont icon-SZYD-xitongcaidanguanli"></i>编辑印发日期',
                            maxmin: false,
                            area: ['580px', '200px'],//高度自适应
                            type: 1,//页面层
                            shadeClose: false,
                            btnAlign: 'c',

                            content: $('#hyjyDate').html(),//加载该区域的html
                            success: function (obj) {
                                $(obj.selector).find('.btnClose').off().on('click', function () {
                                    layer.close(index_add);
                                });
                                form.val('formTest', {
                                    'printTime': data.releaseTime
                                })
                                // $("[name=printTime]").val(data.releaseTime);
                                laydate.render({
                                    elem: '[name=printTime]',
                                    type: 'date',
                                    trigger: 'click',
                                });

                                // =======================编辑会议纪要印发时间
                                form.on('submit(updateReleaseTime)', function (data) {
                                    data.field.fileInfoId = fileInfoId;
                                    var layerLoader = common.layerLoader();
                                    common.fetchPost('meetingmgr/tiolMeeting/updateSummaryFileInfo', data.field, function (res) {
                                        layer.close(layerLoader);
                                        if (res.success) {
                                            layer.alert("印发时间更新成功!");
                                            table.reload("meetingFileTableReload");
                                        } else {
                                            layer.alert(res.resultMessage);
                                        }
                                    }, function (err) {
                                        layer.close(layerLoader);
                                        layer.alert(err.resultMessage);
                                    })
                                    layer.close(index_add);
                                    return false; //阻止表单跳转。如果需要表单跳转，去掉这段即可。
                                });
                                // ===================================
                            }
                        });
                        break;
                    /*      case 'up':
                                  var meetingId=obj.data.resId;
                                  var fiId=obj.data.fiId;
                                  var ggSort=obj.data.ggSort;
                                  var layerLoader =common.layerLoader();
                                  common.fetchPost('meetingmgr/tiolMeeting/updateMeetingFileSort',
                                        {"meetingId":meetingId,"fiId":fiId,"orderType":"UP","ggSort":ggSort},
                                        function () {
                                          layer.alert("向上排序成功",function(index){
                                             //成功之后刷新tree 以及表格
                                                  table.reload('meetingFileTableReload', {
                                                      page: {}
                                                      , where: {
                                                          meetingId:meetingIdForm
                                                      }
                                                  });
                                                  layer.close(index);
                                                  layer.close(layerLoader);
                                           })
                                      },function () {
                                          layer.close(layerLoader);
                                   });
                              break;
                          case 'down':
                              var meetingId=obj.data.resId;
                              var fiId=obj.data.fiId;
                              var ggSort=obj.data.ggSort;
                              var layerLoader =common.layerLoader();
                              common.fetchPost('meetingmgr/tiolMeeting/updateMeetingFileSort',
                                    {"meetingId":meetingId,"fiId":fiId,"orderType":"DOWN","ggSort":ggSort},
                                    function () {
                                      layer.alert("向下排序成功",function(index){
                                         //成功之后刷新tree 以及表格
                                              table.reload('meetingFileTableReload', {
                                                  page: {}
                                                  , where: {
                                                      meetingId:meetingIdForm
                                                  }
                                              });
                                              layer.close(index);
                                              layer.close(layerLoader);
                                       })
                                  },function () {
                                      layer.close(layerLoader);
                               });
                              break;*/
                    case "upFile":

                        if (!fileSortData[common.arrayIndexOf(fileSortData, 'fiId', obj.data.fiId) - 1]) {
                            layer.alert('无法上移');
                            return false;
                        }


                        var upFileLayer = layer.confirm("确定上移文件?", {
                            btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消']
                        }, function (index, layero) {
                            $.when(
                                common.fetchPost("dfsmgr/file/updateFileInfo", {
                                    fiId: obj.data.fiId,
                                    ggSort: obj.data.ggSort - 1
                                }),//当前条
                                common.fetchPost("dfsmgr/file/updateFileInfo", {
                                    fiId: fileSortData[common.arrayIndexOf(fileSortData, 'fiId', obj.data.fiId) - 1].fiId,
                                    ggSort: fileSortData[common.arrayIndexOf(fileSortData, 'fiId', obj.data.fiId) - 1].ggSort + 1
                                })//上一条
                            ).done(function (res1, res2) {
                                if (res1.success && res2.success) {
                                    table.reload("meetingFileTableReload");
                                    layer.alert("上移成功");
                                    layer.close(upFileLayer);
                                } else {
                                    layer.alert('上移失败');
                                }
                            });
                        });
                        break;
                    case "downFile":
                        if (!fileSortData[common.arrayIndexOf(fileSortData, 'fiId', obj.data.fiId) + 1]) {
                            layer.alert('无法下移');
                            return false;
                        }
                        var downFileLayer = layer.confirm("确定下移文件?", {
                            btn: ['<i class="layui-icon">&#xe605;</i>确定', '<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>取消']
                        }, function (index, layero) {
                            $.when(
                                common.fetchPost("dfsmgr/file/updateFileInfo", {
                                    fiId: obj.data.fiId,
                                    ggSort: obj.data.ggSort + 1
                                }),//当前条
                                common.fetchPost("dfsmgr/file/updateFileInfo", {
                                    fiId: fileSortData[common.arrayIndexOf(fileSortData, 'fiId', obj.data.fiId) + 1].fiId,
                                    ggSort: fileSortData[common.arrayIndexOf(fileSortData, 'fiId', obj.data.fiId) + 1].ggSort - 1
                                })//下一条
                            ).done(function (res1, res2) {
                                if (res1.success && res2.success) {
                                    table.reload("meetingFileTableReload");
                                    layer.alert("下移成功");
                                    layer.close(downFileLayer);
                                } else {
                                    layer.alert('下移失败');
                                }
                            });
                        });
                        break;
                }
            });

            // common.buttonLimit();
        });


    </script>

    <!--[if lt IE 9]>
<script src="../../js/lib/html5.min.js"></script>
<script src="../../js/lib/respond.js"></script>
<![endif]-->
</body>

</html>