<!DOCTYPE html>
<html  class="iframe-h">
<head>
    <meta charset="UTF-8">
    <title>会议管理-新增</title>
    <meta content="webkit" name="renderer"/>
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link class="favicon" href="./../../../images/ico/favicon.ico" rel="shortcut icon" type="image/x-icon">
    <link class="favicon" href="./../../../images/ico/favicon.ico" rel="icon" type="image/x-icon">
    <link class="favicon" href="./../../../images/ico/favicon.ico" rel="bookmark" type="image/x-icon">
    <link rel="stylesheet" href="../../../js/layui/css/layui.css"/>
    <link href="../../../css/public.css?v1.01" rel="stylesheet" />
    <link href="../../../js/lib/font-awesome/css/font-awesome.css" rel="stylesheet"/>
    <script src="../../../js/lib/jquery.1.12.3.js"></script>
    <style>
        body{
            background:#f8f8f8;
        }
        .load-btn,.check-btn,.right-btn{
            position: absolute;
            top:0;
            right:0;
            border-radius: 3px;
        }
        .right70{
            right:70px;
        }
        .relative{
            position: relative;
        }
        .padRt64{
            padding-right: 64px;
        }
        li{
            cursor: pointer;
        }
        .zsBga{
            color:purple;
            vertical-align: 1px;
            opacity: 0.5;
        }
        .hytitle{
            font-size: 14px;
        }
        .hylabel{
            border: 1px solid transparent!important;
            background: transparent!important;
        }
        .hyinput{
            border: 1px solid transparent!important;
            border-bottom-color: red!important;
        }
        .layui-unselect {
            border-color: #f56c6c;
            border-top-style: none;
            border-right-style: none;
            border-left-style: none;
        }
        .layui-form-select .layui-edge{
            border-top-color: #f56c6c;
        }
        a.layui-layer-ico.layui-layer-max{
             display:none;
        }
        a.layui-layer-ico.layui-layer-max.layui-layer-maxmin{
            display:inline-block!important;
        }
        /* .editView{
            display: none;
        } */
    </style>

</head>

<!--列席人员设置-->
<div class="set-attendanceForm hide">
    <div class="layui-card-body">
        <table id="attendanceTable" lay-filter="attendanceTable"></table>
    </div>
</div>
<!--出席人员设置-->
<div class="set-attendeeForm hide">
    <div class="layui-card-body">
        <table id="attendeeTable" lay-filter="attendeeTable"></table>
    </div>
</div>
<!--缺席人员设置-->
<div class="set-absentForm hide">
    <div class="layui-card-body">
        <table id="absentTable" lay-filter="absentTable"></table>
    </div>
</div>

<!--常设列席设置-->
<div class="set-attenderForm hide">
    <div class="layui-card-body">
        <table id="attenderTable" lay-filter="attenderTable"></table>
    </div>
</div>

<!--审议情况-查看-->
<script type="text/html" id="edit-syForm">
<div  class="edit-syForm">
    <div class="layui-card-body">
            <form class="layui-form layui-form-pane" name="edit-syForm">
                    <div class="layui-card">
                        <div class="layui-card-header layui-card-header-custom">
                            <span><i></i>审议信息
                                <b class="zsBga"></b>
                            </span>
                        </div>
                        <div class="layui-card-body">
                            <div class="layui-row layui-col-space15">
                                <div class="layui-col-md12">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label hylabel"><b class="red">*</b>议题名称</label>
                                        <div class="layui-input-block">
                                            <input type="text" lay-verify="subjectName" name="subjectName" placeholder="请输入" autocomplete="off" class="layui-input hyinput" readonly>
                                        </div>
                                    </div>
                                </div>
                                <input type="hidden" name="subjectId">
                                <input type="hidden" readonly name="subjectCode" placeholder="请输入" autocomplete="off" class="layui-input hyinput">

                                <!-- <div class="layui-col-md6">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label hylabel"><b class="red">*</b>议题编码</label>
                                        <div class="layui-input-block">
                                            <input type="text" lay-verify="subjectCode" readonly name="subjectCode" placeholder="请输入" autocomplete="off" class="layui-input hyinput">
                                        </div>
                                    </div>
                                </div> -->
                                <!-- <div class="layui-col-md6">
                                        <div class="layui-form-item">
                                            <label class="layui-form-label hylabel">紧急程度</label>
                                            <div class="layui-input-block">
                                                <select name="exigence"  id="exigence" lay-filter="exigenceFilter">
                                                    <option name="" value=""></option>
                                                </select>
                                            </div>
                                        </div>
                                    </div> -->
                            </div>
                            <div class="layui-row layui-col-space15">
                                <input type="hidden" name="exigenceName">
                                <div class="layui-col-md6">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label hylabel">议题类型</label>
                                        <div class="layui-input-block">
                                            <select name="subjectType"  id="subjectType" lay-filter="subjectTypeFilter">
                                                <option name="" value=""></option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <input type="hidden" name="subjectTypeName">
                                <div class="layui-col-md6">
                                        <div class="layui-form-item">
                                            <label class="layui-form-label hylabel">决议类别</label>
                                            <div class="layui-input-block">
                                                <select name="resultType"  id="resultType" lay-filter="resultTypeFilter">
                                                    <option name="" value=""></option>
                                                </select>
                                            </div>
                                        </div>
                                </div>
                                <input type="hidden" name="resultTypeName">
                           <!--      <div class="layui-col-md12">
                                        <div class="layui-form-item">
                                            <label class="layui-form-label hylabel"><b class="red">*</b>是否上报国资委</label>
                                            <div class="layui-input-block">
                                                <select name="approvalFlag"  id="approvalFlag" lay-verify="approvalFlag" lay-filter="approvalFlagFilter">
                                                    <option name="" value=""></option>
                                                </select>
                                            </div>
                                        </div>
                                </div>
                                <input type="hidden" name="approvalFlagName"> -->
                            </div>
                            <div class="layui-row layui-col-space15">
                                <div class="layui-col-md12">
                                        <div class="layui-form-item">
                                            <label class="layui-form-label hylabel">汇报人</label>
                                            <div class="layui-input-block">
                                                <input type="text" name="reporter" placeholder="请输入" autocomplete="off" class="layui-input hyinput"
                                                value="">
                                            </div>
                                        </div>
                                </div>
                            </div>
                            <div class="layui-row layui-col-space15">
                                <div class="layui-col-md12">
                                    <div class="layui-form-item relative">
                                        <label class="layui-form-label hylabel">列席人员</label>
                                        <div class="layui-input-block">
                                            <input type="text" readonly id="attendances" name="attendances" placeholder="请输入" autocomplete="off" class="layui-input padRt64 hyinput"
                                            value="" lay-verify="attendances">
                                            <button class="layui-btn layui-btn-radius right-btn" id="attendances-btn">编辑</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="layui-row layui-col-space15">
                                <div class="layui-col-md12">
                                    <div class="layui-form-item">
                                        <label class="layui-form-label hylabel"><b class="red">*</b>审议结果</label>
                                        <div class="layui-input-block">
                                            <select name="passFlag" id="passFlag" lay-filter="passFlagFilter" lay-verify="passFlag">
                                                <option name="" value=""></option>
                                            </select>
                                            <button class="layui-btn layui-btn-radius right-btn" id="passFlag-btn">计算</button>
                                        </div>
                                    </div>
                                    <input type="hidden" name="passFlagName">
                                </div>
                                <div class="layui-row layui-col-space15">
                                    <div class="layui-col-md12">
                                        <div class="layui-form-item">
                                            <div class="layui-form-item">
                                                    <label class="layui-form-label hylabel"><b class="red">*</b>审议结论</label>
                                                    <div class="layui-input-block">
                                                        <textarea name="subjectResult" lay-verify="subjectResult" placeholder="请输入" class="layui-textarea hyinput"></textarea>
                                                    </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                         </div>
                    </div>
                    <div class="layui-card">
                        <div class="layui-card-header layui-card-header-custom">
                            <span><i></i>表决详情
                                <b class="zsBga"></b>
                            </span>
                        </div>
                        <div class="layui-card-body">
                                <div class="layui-row layui-col-space15">
                                        <div class="layui-col-md12">
                                            <div class="layui-form-item">
                                                <label class="layui-form-label hylabel">表决情况</label>
                                                <div class="layui-input-block">
                                                    <input type="text" readonly name="bjqk" placeholder="根据下方列表自动生成" autocomplete="off" class="layui-input hyinput">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                            <div class="layui-row layui-col-space15">
                                <div class="layui-col-md12">
                                    <table id="bjTable" lay-filter="bjTable"></table>
                                </div>
                            </div>
                        </div>
                    </div>
                        <div class="layui-card">
                            <div class="layui-card-header layui-card-header-custom">
                                <span><i></i>议题资料
                                    <b class="zsBga"></b>
                                </span>
                            </div>
                            <div class="layui-card-body">
                                <div class="layui-row layui-col-space15">
                                    <div class="layui-col-md12">
                                        <table id="subjectFileTable" lay-filter="subjectFileTable"></table>

                                    </div>
                                </div>
                            </div>
                        </div>
                        <div style="display: none">
                            <div class="layui-card" style="margin-top: 10px">
                                <div class="layui-card-body">
                                    <div class="layui-form-item" style="text-align: center;">
                                        <button class="layui-btn" lay-submit lay-filter="formSubjectEdit"> <i class="layui-icon">&#x1005;</i>保存</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                </form>
    </div>
</div>
</script>
<!--列席人员查看-添加-->
<div class="setAdd-attendanceForm hide">
    <div class="layui-card-body">
        <form class="layui-form layui-form-pane" name="setAdd-attendanceForm">
                <div class="layui-row layui-col-space15">
                    <div class="layui-col-md12">
                        <div class="layui-form-item">
                            <label class="layui-form-label hylabel">列席人</label>
                            <div class="layui-input-block">
                                <input type="text" id="attendanceName" lay-verify="required" name="attendanceName" placeholder="请输入" autocomplete="off" class="layui-input hyinput">
                            </div>
                        </div>
                    </div>
                    <div class="layui-col-md12">
                        <div class="layui-form-item">
                            <label class="layui-form-label hylabel">职位</label>
                            <div class="layui-input-block">
                                <select name="position" id="position" lay-filter="positionFilter">
                                    <option name="" value=""></option>
                                </select>
                            </div>
                        </div>
                        <input type="hidden" name="positionName">
                    </div>
                </div>
        </form>
    </div>
</div>
<!--出席人员查看-添加-->
<div class="setAdd-attendeeForm hide">
    <div class="layui-card-body">
        <form class="layui-form layui-form-pane" name="setAdd-attendeeForm">
                <div class="layui-row layui-col-space15">
                    <div class="layui-col-md12">
                        <div class="layui-form-item">
                            <label class="layui-form-label hylabel">出席人</label>
                            <div class="layui-input-block">
                                <input type="text" id="attendeeName" name="attendeeName" placeholder="请输入" autocomplete="off" class="layui-input hyinput">
                            </div>
                        </div>
                    </div>
                    <div class="layui-col-md12">
                        <div class="layui-form-item">
                            <label class="layui-form-label hylabel">备注</label>
                            <div class="layui-input-block">
                                <textarea name="remark" id="remark" placeholder="请输入" class="layui-textarea hyinput"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
        </form>
    </div>
</div>

<!--缺席人员查看-添加-->
<div class="setAdd-absentForm hide">
    <div class="layui-card-body">
        <form class="layui-form layui-form-pane" name="setAdd-absentForm">
                <div class="layui-row layui-col-space15">
                    <div class="layui-col-md12">
                        <div class="layui-form-item">
                            <label class="layui-form-label hylabel">缺席人</label>
                            <div class="layui-input-block">
                                <input type="text" name="attendeeName" placeholder="请输入" autocomplete="off" class="layui-input hyinput">
                            </div>
                        </div>
                    </div>
                    <div class="layui-col-md12">
                        <div class="layui-form-item">
                            <label class="layui-form-label hylabel">缺席原因</label>
                            <div class="layui-input-block">
                                <input type="text" name="reason" placeholder="请输入" autocomplete="off" class="layui-input hyinput">
                            </div>
                        </div>
                    </div>
                    <div class="layui-col-md12">
                        <div class="layui-form-item">
                            <label class="layui-form-label hylabel">委托人</label>
                            <div class="layui-input-block">
                                <input type="text" name="assignor" placeholder="请输入" autocomplete="off" class="layui-input hyinput">
                            </div>
                        </div>
                    </div>
                    <div class="layui-col-md12">
                        <div class="layui-form-item">
                            <label class="layui-form-label hylabel">备注</label>
                            <div class="layui-input-block">
                                <textarea name="remark" placeholder="请输入" class="layui-textarea hyinput"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
        </form>
    </div>
</div>

<!--常设列席查看-添加-->
<div class="setAdd-attenderForm hide">
    <div class="layui-card-body">
        <form class="layui-form layui-form-pane" name="setAdd-attenderForm">
                <div class="layui-row layui-col-space15">
                    <div class="layui-col-md12">
                        <div class="layui-form-item">
                            <label class="layui-form-label hylabel">出席人</label>
                            <div class="layui-input-block">
                                <input type="text" id="attenderSuName" name="attenderSuName" placeholder="请输入" autocomplete="off" class="layui-input hyinput">
                            </div>
                        </div>
                    </div>
                </div>
        </form>
    </div>
</div>

<div class="memberTable hide">
    <div class="layui-card-body">
        <table id="memberTable" lay-filter="memberTable"></table>
    </div>
</div>

<!--待上会议题清单-->
<div class="dshyt hide">
        <div class="layui-card-body">
            <table id="dshyt" lay-filter="dshyt"></table>
        </div>
</div>
<!--待上议题-添加-->
<!--表决清单-查看-->
<script type="text/html" class="bjqk-edit hide">
    <div class="layui-card-body">
        <form class="layui-form layui-form-pane" name="dshyt-add" id="bjqkForm">
                <div class="layui-row layui-col-space15">
                    <input type="hidden" id="deliberationId" name="deliberationId" class="layui-input hyinput">
                    <input type="hidden" id="subjectId" name="subjectId" class="layui-input hyinput">
                    <div class="layui-col-md12">
                        <div class="layui-form-item">
                            <label class="layui-form-label hylabel"><b class="red">*</b>姓名</label>
                            <div class="layui-input-block">
                                <input type="text" id="deliberationPersonnel" lay-verify="deliberationPersonnel" name="deliberationPersonnel" placeholder="请输入" autocomplete="off" class="layui-input hyinput">
                            </div>
                        </div>
                    </div>
                    <div class="layui-col-md12">
                        <div class="layui-form-item">
                            <label class="layui-form-label hylabel">职务</label>
                            <div class="layui-input-block">
                                <input type="text" id="job" name="job" placeholder="请输入" autocomplete="off" class="layui-input hyinput">
                            </div>
                        </div>
                    </div>
                    <div class="layui-col-md12">
                        <div class="layui-form-item">
                            <label class="layui-form-label hylabel"><b class="red">*</b>参会状态</label>
                            <div class="layui-input-block">
                                <select id="attendStatus" name="attendStatus" lay-verify="attendStatus">
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="layui-col-md12">
                        <div class="layui-form-item">
                            <label class="layui-form-label hylabel">缺席原因</label>
                            <div class="layui-input-block">
                                <select id="reasonCode" name="reasonCode">
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="layui-col-md12">
                        <div class="layui-form-item">
                            <label class="layui-form-label hylabel"><b class="red">*</b>审议结果</label>
                            <div class="layui-input-block">
                                <select id="deliberationResult" name="deliberationResult" lay-verify="deliberationResult">
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="layui-col-md12">
                        <div class="layui-form-item">
                            <label class="layui-form-label hylabel">备注</label>
                            <div class="layui-input-block">
                                <textarea id="remark" name="remark" placeholder="请输入" class="layui-textarea hyinput"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
        </form>
    </div>
</script>
<script type="text/html" id="subjectFileTableOper">
    <a class="layui-btn layui-btn-xs"  lay-event="load">下载</a>
</script>
<script type="text/html" id="bjTableOper">
    <a class="layui-btn layui-btn-xs"  lay-event="edit">查看</a>
</script>
<body class="iframe-h">

<div class="content-wrap" style="padding: 10px;">
    <div class="layui-row layui-col-space15">
        <div class="layui-col-xs12 layui-col-sm12 layui-col-md12">
            <!-- 基本信息 -->
            <form class="layui-form layui-form-pane" name="meetingLayer" lay-filter="meetingForm">
                <div class="layui-card">
                        <div class="layui-card-header layui-card-header-custom">
                            <span><i></i>会议信息
                                <b class="zsBga"></b>
                            </span>
                        </div>
                        <input type="hidden" name="curSeId" id="curSeId">
                        <input type="hidden" name="meetingId" id="meetingId">
                        <input type="hidden" name="formOperType" id="formOperType">
                        <div class="layui-card-body">
                                <div class="layui-row layui-col-space15">
                                    <div class="layui-col-md12">
                                        <div class="layui-form-item">
                                            <label class="layui-form-label hylabel"><b class="red">*</b>会议名称:</label>
                                            <div class="layui-input-block">
                                                <input type="text" lay-verify="meetingName" name="meetingName" id="meetingName" placeholder="请输入" autocomplete="off" class="layui-input hyinput"
                                                    value="">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-row layui-col-space15">
                                	<div class="layui-col-md6">
                                        <div class="layui-form-item">
                                            <label class="layui-form-label hylabel"><b class="red">*</b>会议日期:</label>
                                            <div class="layui-input-block">
                                                <input type="text" readonly lay-verify="meetingTime" class="layui-input hyinput" id="meetingTime" name="meetingTime" placeholder="请选择日期">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="layui-col-md6">
                                        <div class="layui-form-item">
                                            <label class="layui-form-label hylabel"><b class="red">*</b>会议地点:</label>
                                            <div class="layui-input-block">
                                                <input type="text" name="meetingAddr" lay-verify="meetingAddr" id="meetingAddr" placeholder="请输入" autocomplete="off" class="layui-input hyinput"
                                                value="">
                                            </div>
                                        </div>
                                    </div>
                                   <!--  <div class="layui-col-md6">
                                        <div class="layui-form-item">
                                            <label class="layui-form-label hylabel"><b class="red">*</b>会议类型:</label>
                                            <div class="layui-input-block">
                                                <select name="meetingType" lay-verify="required" id="meetingType" lay-filter="meetingTypeFilter">
                                                    <option name="" value=""></option>
                                                </select>
                                            </div>
                                        </div>
                                    </div> -->
                                    <input type="hidden" name="meetingTypeId" id="meetingTypeId">
                                    <input type="hidden" name="meetingTypeCode" id="meetingTypeCode">
                                    <input type="hidden" name="meetingTypeName" id="meetingTypeName">
                                    <div class="layui-row layui-col-space15">
                                        <div class="layui-col-md12">
                                            <div class="layui-form-item">
                                                <label class="layui-form-label hylabel"><b class="red">*</b>会议编码:</label>
                                                <div class="layui-input-block">
                                                    <input type="text" lay-verify="meetingCode" name="meetingCode" id="meetingCode" placeholder="请输入" autocomplete="off" class="layui-input hyinput"
                                                        value="">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="layui-row layui-col-space15">
                                        <div class="layui-col-md6">
                                            <div class="layui-form-item">
                                                <label class="layui-form-label hylabel"><b class="red">*</b>年份:</label>
                                                <div class="layui-input-block">
                                                    <input type="text" lay-verify="meetingYear" name="meetingYear" id="meetingCode" placeholder="请输入" autocomplete="off" class="layui-input hyinput"
                                                        value="">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="layui-col-md6">
                                            <div class="layui-form-item">
                                                <label class="layui-form-label hylabel"><b class="red">*</b>流水号:</label>
                                                <div class="layui-input-block">
                                                    <input type="text" lay-verify="serialNumber" name="serialNumber" id="meetingCode" placeholder="请输入" autocomplete="off" class="layui-input hyinput"
                                                        value="">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-row layui-col-space15">
                                    <div class="layui-col-md6">
                                        <div class="layui-form-item">
                                            <label class="layui-form-label hylabel"><b class="red">*</b>会议形式:</label>
                                            <div class="layui-input-block">
                                                    <select name="meetingMode" id="meetingMode" lay-filter="meetingModeFilter" lay-verify="meetingMode">
                                                        <option name="" value=""></option>
                                                    </select>

                                            </div>
                                        </div>
                                    </div>
                                    <input type="hidden" name="meetingModeName" id="meetingModeName">
                                    <div class="layui-col-md6">
                                        <div class="layui-form-item">
                                            <label class="layui-form-label hylabel"><b class="red">*</b>审议形式:</label>
                                            <div class="layui-input-block">
                                                <select name="deliberationMode" lay-verify="deliberationMode" id="deliberationMode" lay-filter="deliberationModeFilter">
                                                    <option name="" value=""></option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <input type="hidden" name="deliberationName" id="deliberationName">
                                </div>
                                <!-- <div class="layui-row layui-col-space15">
                                    <div class="layui-col-md6">
                                            <div class="layui-form-item">
                                                <label class="layui-form-label hylabel"><b class="red">*</b>纪要印发时间:</label>
                                                <div class="layui-input-block">
                                                    <input type="text" lay-verify="required" readonly class="layui-input hyinput" id="releaseTime" name="releaseTime" placeholder="请选择日期">
                                                </div>
                                            </div>
                                    </div>
                                </div> -->
                        </div>
                </div>
               <!--  <input type="hidden"  readonly name="meetingCode" id="meetingCode" placeholder="请输入" autocomplete="off" class="layui-input hyinput" value="">
                <input type="hidden" readonly id="meetingYear" class="layui-input hyinput" name="meetingYear" id="meetingYear" placeholder="请输入年份">
                <input type="hidden" id="serialNumber" readonly name="serialNumber" placeholder="请输入" autocomplete="off" class="layui-input hyinput" value="">
 -->
            <div class="layui-collapse white-bg editView" style="margin-top: 10px;background-color: white;">
                    <div class="layui-colla-item">
                        <h2 class="layui-colla-title white-bg" style="background-color: white;">参会人员 <b class="zsBga"></b></h2>
                        <div class="layui-colla-content layui-show">
                            <!-- 参会人员 -->
                            <div class="layui-card" >

                                    <div class="layui-card-body">
                                                <div class="layui-row layui-col-space15">
                                                    <div class="layui-col-md6">
                                                        <div class="layui-form-item">
                                                            <label class="layui-form-label hylabel"><b class="red">*</b>召集人:</label>
                                                            <div class="layui-input-block">
                                                                <input type="text" name="convenor" lay-verify="convenor" id="convenor" placeholder="请输入" autocomplete="off" class="layui-input hyinput"
                                                                value="">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="layui-col-md6">
                                                        <div class="layui-form-item">
                                                            <label class="layui-form-label hylabel"><b class="red">*</b>主持人:</label>
                                                            <div class="layui-input-block">
                                                                <input type="text" name="moderatorName" lay-verify="moderatorName"  id="moderatorName" placeholder="请输入" autocomplete="off" class="layui-input hyinput"
                                                                value="">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="layui-row layui-col-space15">
                                                    <div class="layui-col-md12">
                                                        <div class="layui-form-item">
                                                            <label class="layui-form-label hylabel"><b class="red">*</b>出席人员:</label>
                                                            <div class="layui-input-block">
                                                                <input type="text" readonly lay-verify="attendeeNames" name="attendeeNames" id="attendeeNames" placeholder="请输入" autocomplete="off" class="layui-input hyinput"
                                                                value="">
                                                                <button class="layui-btn layui-btn-radius right-btn" id="attendee-setting">查看</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="layui-row layui-col-space15">
                                                    <div class="layui-col-md12">
                                                        <div class="layui-form-item relative">
                                                            <label class="layui-form-label hylabel">缺席人员:</label>
                                                            <div class="layui-input-block">
                                                                <input type="text" readonly name="absentNames" id="absentNames" placeholder="请输入" autocomplete="off" class="layui-input padRt64 hyinput"
                                                                value="">
                                                                <button class="layui-btn layui-btn-radius right-btn" id="absent-setting">查看</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="layui-row layui-col-space15">
                                                    <div class="layui-col-md12">
                                                        <div class="layui-form-item">
                                                            <label class="layui-form-label hylabel">常设列席:</label>
                                                            <div class="layui-input-block">
                                                                <input type="text" readonly name="attenders" id="attenders" placeholder="请输入" autocomplete="off" class="layui-input hyinput"
                                                                value="">
                                                                <button class="layui-btn layui-btn-radius right-btn" id="attender-setting">查看</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                            </div>
                                    </div>
                            </div>
                        </div>
                    </div>

                    </form>
            </div>
            <div class="layui-collapse white-bg editView" style="margin-top: 10px;background-color: white;">
                    <div class="layui-colla-item">
                        <h2 class="layui-colla-title white-bg" style="background-color: white;">会议资料 <b class="zsBga"></b></h2>
                        <div class="layui-colla-content">
                             <!-- 会议资料 -->
                            <div class="layui-card" >
                                    <!-- <div class="layui-card-header">
                                            <i class="iconfont icon-SZYD-xtsjzdgl"></i>
                                            <span class="hytitle">会议资料</span>
                                            <i class="layui-icon layui-icon-right"></i>
                                            <span class="zsBga">【由会议管理部门添加】</span>
                                    </div> -->

                                <div class="layui-card-body">
                                            <table id="meetingFile" lay-filter="meetingFile"></table>

                                            <script type="text/html" id="meetingFileOper">
                                                <!-- <a class="layui-btn layui-btn-xs" lay-event="check">查看</a> -->
                                                <a class="layui-btn layui-btn-xs" lay-event="load">下载</a>
                                                <!-- <a class="layui-btn layui-btn-xs edit1" lay-event="edit">查看</a> -->
                                            </script>
                                    </div>
                            </div>
                        </div>
                    </div>
            </div>
            <div class="layui-collapse white-bg editView" style="margin-top: 10px;background-color: white;">
                    <div class="layui-colla-item">
                        <h2 class="layui-colla-title white-bg" style="background-color: white;">议题清单<b class="zsBga"></b></h2>
                        <div class="layui-colla-content">
                            <!-- 议题清单 -->
                            <div class="layui-card" >
                                    <div class="layui-card-body">
                                        <table id="ytList" lay-filter="ytList"></table>

                                        <script type="text/html" id="ytListOper">
                                            <a class="layui-btn layui-btn-xs edit2" lay-event="edit">查看</a>
                                           <!--  <a class="layui-btn layui-btn-xs edit2" lay-event="check">查看议题</a>         -->                                </script>
                                    </div>
                            </div>
                        </div>
                    </div>
            </div>
        </div>
    </div>
</div>
<div style="position: fixed;width: 100%;bottom: 0px;">
    <div class="layui-card" style="margin-top: 10px">
        <div class="layui-card-body">
            <div class="layui-form-item" style="text-align: center;">
                <button class="layui-btn" id="formMeetingClose"><i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>关闭</button>
            </div>
        </div>
    </div>
</div>
<!--脚垫-->
<div style="height: 80px;"> </div>
<script src="./../../../js/layui/layui.js"></script>
<script>

    layui.config({
        base: '../../../../src/js/',
        version: new Date().getTime()
    }).use(['eleTree','layer','table','form','laytpl','common','element','laydate','upload'],function () {
        var table=layui.table;
        var form=layui.form;
        var tree=layui.eleTree;
        var common=layui.common;
        var element = layui.element;
        var laydate = layui.laydate;
        var upload = layui.upload;
        var util = layui.util;
        element.init();
        var baseUrl='../../../../';
        common.themeSet();
        //获取url传参
        (function ($) {
                $.getUrlParam = function (name) {
                    var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
                    var r = window.location.search.substr(1).match(reg);
                    if (r != null) return decodeURIComponent(r[2]); return null;
                }
        })(jQuery);
        var initFormObj={};
        var meetingTypeId=$.getUrlParam('meetingTypeId');
        var meetingTypeCode=$.getUrlParam('meetingTypeCode');
        var meetingTypeName=$.getUrlParam('meetingTypeName');
        var meetingIdForm = parent.dataObj||common.uuid();
        //操作类型，add:新增；edit：查看
        var formOperType=parent.formOperType;
        $("#meetingTypeId").val(meetingTypeId);
        $("#meetingTypeCode").val(meetingTypeCode);
        $("#meetingTypeName").val(meetingTypeName);
        $("#meetingId").val(meetingIdForm);
        $("#formOperType").val(formOperType);
        var reasonCodeMap = {};
        var reasonCodeList = [];
        var approvalFlagMap = {};
        var approvalFlagList = [];
        var passFlagMap = {};
        var attendStatusMap = {};
        var attendStatusList = [];
        var deliberationResultMap = {};
        var deliberationResultList = [];
        //表决弹窗
        var bj_index_edit;
        //议题弹窗
        var yt_index_edit;
        var formMeetingCloseIndex = window.parent.layer.index;
        // --------------------------------下拉框-----------------------------------
        //会议类型获取URL
        var meetingTypeUrl = baseUrl + "meetingmgr/tiolMeetingType/getTiolMeetingTypeSelect";
        //审议形式获取URL
        var deliberationModeUrl = baseUrl + "meetingmgr/tiolMeetingFormAlias/getTiolMeetingFormList";
        //字典获取URL
        var dictUrl = baseUrl + "sysmgr/dicts/selectDictListByPcode";

        var keyValueTypeMap = {
            "meetingType": {
                "url": meetingTypeUrl,
                "key": "meetingType",
                "value": "meetingTypeName"
            },
            "deliberationMode":{
                "url": deliberationModeUrl,
                "key": "meetingFormId",
                "value": "meetingFormName"
            },
            "dict": {
                "url": dictUrl,
                "key": "sdCode",
                "value": "sdName"
            }
        };

        var selectDictMap = {
            "deliberationResult":{
                "kvType": keyValueTypeMap.dict,
                "param": {
                    "dictPCode": "DELIBERATIONRESULT"
                }
            },
            "attendStatus":{
                "kvType": keyValueTypeMap.dict,
                "param": {
                    "dictPCode": "attendStatus"
                }
            },
            "reasonCode":{
                "kvType": keyValueTypeMap.dict,
                "param": {
                    "dictPCode": "reasonCode"
                }
            },
            "meetingType": {
                "kvType": keyValueTypeMap.meetingType
            },
            "deliberationMode": {
                "kvType": keyValueTypeMap.deliberationMode
            },
            "meetingMode": {
                "kvType": keyValueTypeMap.dict,
                "param": {
                    "dictPCode": "MEETING_REVIEW_MODE"
                }
            },
            "exigence":{
                "kvType": keyValueTypeMap.dict,
                "param": {
                    "dictPCode": "msRank"
                }
            },
            "passFlag":{
                "kvType": keyValueTypeMap.dict,
                "param": {
                    "dictPCode": "PASSFLAG"
                }
            },
            "subjectType":{
                "kvType": keyValueTypeMap.dict,
                "param": {
                    "dictPCode": "subjectType"
                }
            },
            "resultType":{
                "kvType": keyValueTypeMap.dict,
                "param": {
                    "dictPCode": "resultType"
                }
            },
            "position":{
                "kvType": keyValueTypeMap.dict,
                "param": {
                    "dictPCode": "POSITION_TYPE"
                }
            },
            "meetingFileType":{
                "kvType": keyValueTypeMap.dict,
                "param": {
                    "dictPCode": "materialType"
                }
            },
            "subjectFileType":{
                "kvType": keyValueTypeMap.dict,
                "param": {
                    "dictPCode": "subjectMaterialType"
                }
            },
        }

       /*  form.on('select(meetingTypeFilter)', function(data){
            var meetingTypeInfo=data.value.split("_");
			var meetingTypeId=meetingTypeInfo[0];
            var meetingTypeCode=meetingTypeInfo[1];
            var curMeetingTypeName=data.elem[data.elem.selectedIndex].text;
			$("#meetingTypeId").val(meetingTypeId);
			$("#meetingTypeCode").val(meetingTypeCode);
            $("#meetingTypeName").val(curMeetingTypeName);
            //生成会议编码
            createMeetingCode();
        }); */
        form.on('select(meetingModeFilter)', function(data){
            $("[name='meetingModeName']").val($(data.elem).find("[value='" + data.value + "']").text());
            $("#deliberationMode").empty();
            common.selectDataSet({
                elem: $('[name=deliberationMode]'),
                url: deliberationModeUrl+"?meetingTypeId="+$("#meetingTypeId").val()+"&meetingMode="+data.value,
                responseList: 'list',
                method: 'get',//默认为get
                optionText: 'meetingFormName',
                optionValue: 'meetingFormAliasId',
                success: function (data) {
                	form.render('select');
                }
            });
        });
        form.on('select(deliberationModeFilter)', function(data){
        	var meetingMode=$("#meetingMode").val();
        	if(meetingMode==''){
        		alert("请先选择会议形式");
        		return ;
        	}
            $("[name='deliberationName']").val($(data.elem).find("[value='" + data.value + "']").text());
        });
        form.on('select(exigenceFilter)', function(data){
            $("[name='exigenceName']").val($(data.elem).find("[value='" + data.value + "']").text());
        });
        form.on('select(subjectTypeFilter)', function(data){
            $("[name='subjectTypeName']").val($(data.elem).find("[value='" + data.value + "']").text());
        });
        form.on('select(resultTypeFilter)', function(data){
            $("[name='resultTypeName']").val($(data.elem).find("[value='" + data.value + "']").text());
        });
        form.on('select(passFlagFilter)', function(data){
            $("[name='passFlagName']").val($(data.elem).find("[value='" + data.value + "']").text());
        });
        form.on('select(approvalFlagFilter)', function(data){
            $("[name='approvalFlagName']").val($(data.elem).find("[value='" + data.value + "']").text());
        });
        form.on('select(positionFilter)', function(data){
            $("[name='positionName']").val($(data.elem).find("[value='" + data.value + "']").text());
        });

        common.selectDataSet({
            elem: $('[name=passFlag]'),
            url: 'sysmgr/dicts/selectDictListByPcode?dictPCode=PASSFLAG',
            responseList: 'list',
            method: 'get',//默认为get
            optionText: 'sdName',
            optionValue: 'sdCode',
            success: function (data) {
                if (data && data.list && data.list.length > 0) {
                    $.map(data.list, function (item) {
                        passFlagMap[item.sdCode] = item;
                    });
                }
                form.render('select');
            }
        });

        // --------------------------------下拉框END--------------------------------
        // --------------------------------初始化--------------------------------


        var eventHandle={
            initDict:function(array,parent,where,json,callback){
                $.map(array,function(value){
                    var dictId = value;
                    var dictConfigInfo = selectDictMap[dictId];
                    if(!dictConfigInfo) return false;
                    var queryParam = '?';
                    $.map(dictConfigInfo.param,function(value,key){
                        queryParam += key + '=' + value + '&';
                    });
                    if(where && dictConfigInfo.where ){
                        queryParam += "&where=" + where;
                    }
                    var option = {
                        elem: $('#'+dictId),
                        url: dictConfigInfo.kvType.url + queryParam,
                        method: 'get',
                        responseList: 'list',
                        optionText: dictConfigInfo.kvType.value,
                        optionValue: dictConfigInfo.kvType.key,
                        success: function(obj) {
                            form.render("select");
                            if(typeof(callback) == "function"){
                                callback();
                            }
                        }
                    }
                    if(json){
                        var selectData = [];
                        $.each(json,function(i){
                            $.map(json[i],function(value,key){
                                var data = {};
                                data[dictConfigInfo.kvType.key] = key;
                                data[dictConfigInfo.kvType.value] = value;
                                selectData.push(data);
                            })
                        })
                        option.loadData = selectData;
                        option.loadSuccess = function(obj){

                            if(obj && obj.length == 1){
                                this.elem.val(obj[0][this.optionValue]);
                                form.render();
                            }
                        }
                    }
                    common.selectDataSet(option);
                });
            },
            shqkInit:function (subjectId) {
                common.fetchPost('meetingmgr/tiolDeliberation/selectTiolDeliberationTj?subjectId='+subjectId,null,function (res) {
                    $('input[name=bjqk]').eq(1).val(res.object);
                    form.render();
                },function () {});
            },
            subjectPageInit:function (meetingId) {
                //if(meetingId!=null&&meetingId!=undefined&&meetingId!=''){
                    table.render(common.tableInitParams({//议题清单
                        elem: '#ytList',
                        url: baseUrl+'meetingmgr/tiolSubject/selectTiolSubjectPageByMeetingId',
                        // data:resData,
                        where:{"meetingId":meetingId},
                        id:'subjectTableReload',
                        method:'post',
                        defaultToolbar:[],
                        height: 'full-200',
                        cols: [
                            [
                                {type:'checkbox'},
                                {type: 'numbers', title: '序号'},
                                {field: 'motionName', title: '议案名称',sort:true},
                                {field: 'subjectName', title: '议题名称',sort:true},
                                {field: 'motionCreateTime', title: '提出时间', sort:true},
                                {field: 'soName', title: '提出部门', sort:true,},
                                {field: 'passFlag', title: '审议情况',align:"center", sort:true,
                                    templet:function (rowData) {
                                        if (rowData['passFlag']&&passFlagMap[rowData['passFlag']]) {
                                            if(rowData['passFlag'] == 1){
                                                return '<span class="green">'+passFlagMap[rowData['passFlag']]['sdName'] +'</span>'
                                            }else if(rowData['passFlag'] == 0){
                                                return '<span class="red">'+passFlagMap[rowData['passFlag']]['sdName'] +'</span>'
                                            }else{
                                                return '<span class="green3">'+passFlagMap[rowData['passFlag']]['sdName'] +'</span>'
                                            }
                                        } else {
                                            return ''
                                        }
                                    }
                                }, {field: '', title: '操作', width: 150, toolbar:'#ytListOper',fixed: 'right'}
                            ]
                        ]
                    }));
                    table.render(common.tableInitParams({//会议资料
                        elem: '#meetingFile',
                        id:'meetingFileTableReload',
                        url: baseUrl+'dfsmgr/file/getFileByResId?id='+meetingId,
                        // data:meetingFile,
                        method:'post',
                        defaultToolbar:[],
                        height: 'full-200',
                        cols: [
                            [
                                {type:'checkbox'},
                                {type: 'numbers', title: '序号'},
                                // {field: 'ggSort', title: '序号',width:80,align:'center', sort: true},
                                {field: 'fiFileType', title: '资料类型',sort:true,templet:function (rowData) {
                                    var html='';
                                    switch(rowData['fiFileType']){ // 0 会议通知 1 会议纪要 2 会议记录
                                        case "NOTICE":html='会议通知';break;
                                        case "SUMMARY":html='会议纪要';break;
                                        case "RECORD":html='会议记录';break;
                                        case "RESOLUTION":html='会议决议';break;
                                        default:html='其他';break;
                                    }
                                    return html;
                                }},
                                {field: 'fiName', title: '文件名称',sort:true},
                                {field: 'fiName', title: '附件名称',sort:true},
                                {field: 'fiUploadTime', title: '上传时间',sort:true},
                               /*  {field: 'fiUploadTime', title: '上传时间',sort:true
                                    ,templet:function (rowData) {return util.toDateString(rowData.effectTime, 'yyyy-MM-dd');
                                    }}, */
                        {field: 'ggMemo', title: '备注'},
                                {field: '', title: '排序', toolbar:'#meetingFileOper',fixed: 'right'},
                            ]
                        ]
                    }));
               // }
            }
        }

        // 日期时间选择器
        laydate.render({
            elem: '#meetingTime',
            type: 'date',
            range: true,
            trigger: 'click',
            change: function(value, date, endDate){
                $('#meetingYear')[0].value = value.split("-")[0];
            	createMeetingCode();
            }
        });
        /* laydate.render({
            elem: '#releaseTime',
            type: 'date',
            range: false
        }); */
        // 版本号
       /*  laydate.render({
            elem: '#meetingYear',
            type: 'year',
            value:new Date(),
            done: function (value, date, endDate) {
                $('#meetingYear')[0].value = value;
                createMeetingCode();
            }
        }); */

        //eventHandle.initDict(['meetingType','deliberationMode','meetingMode','exigence','passFlag','subjectType','resultType','position']);
        eventHandle.initDict(['meetingType','meetingMode','passFlag','subjectType','resultType','position']);
        if (meetingIdForm&&formOperType=="edit") {
            common.fetchPost('meetingmgr/tiolMeeting/selectTiolMeetingById', {meetingId:meetingIdForm}, function (data) {
                if(data.success){
                	loadDeliberationMode(data.object.meetingTypeId,data.object.meetingMode);
                    loadFormValue(data);
                    //$("#meetingType").attr("disabled", "true");
                    form.render();
                }else{
                    layer.msg("查询会议信息失败:"+data.resultMessage);
                }
            }, function () {
                layer.msg('查询会议信息失败');//失败后提示
            });
        }else{
            /* var userInfo = JSON.parse(common.getCookie('userInfo'));
            var seComeCode = userInfo.currEnterpriseVo.seComcode;
            $("#seComcode").val(seComeCode); */
        }
        eventHandle.subjectPageInit(meetingIdForm);
        var userInfo = JSON.parse(common.getCookie('userInfo'));
        var curSeId = userInfo.currEnterpriseVo.seId;
        var seComeCode = userInfo.currEnterpriseVo.seComcode;
        $("#seComcode").val(seComeCode);
        $("#curSeId").val(curSeId);
        $('#formMeetingClose').unbind('click').bind('click',function (e) {
            window.parent.layer.close(formMeetingCloseIndex);
            return false;
        });
        function loadFormValue(data) {
            data.object.meetingType=data.object.meetingTypeId+"_"+data.object.meetingTypeCode;
            data.object.meetingTime=data.object.meetingTime+" - "+data.object.meetingTimeEnd;
            data.object.formOperType='edit';
            form.val("meetingForm", data.object);
            meetingIdForm=data.object.meetingId;
            meetingTypeId=data.object.meetingTypeId
            meetingTypeCode=data.object.meetingTypeCode
            meetingTypeName=data.object.meetingTypeName
        }
        function initFormValue(data){
        	form.val("meetingForm", data.object);
        }
        function loadDeliberationMode(meetingTypeId,meetingMode){
        	common.selectDataSet({
                elem: $('[name=deliberationMode]'),
                url: deliberationModeUrl+"?meetingTypeId="+meetingTypeId+"&meetingMode="+meetingMode,
                responseList: 'list',
                method: 'get',//默认为get
                optionText: 'meetingFormName',
                optionValue: 'meetingFormAliasId',
                success: function (data) {
                	form.render('select');
                }
            });
        }
        // --------------------------------初始化END--------------------------------

        //出席人员查看
        $('#attendee-setting').on('click',function(){
            var index_qx=layer.open({
                offset: '10px',
                title:'<i class="iconfont icon-SZYD-xitongcaidanguanli"></i>出席人员查看',
                // maxmin: false,
                area: ['800px','600px'],//高度自适应
                type: 1,//页面层
                shadeClose: false,
                btn:['<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>关闭'],
                btnAlign:'c',
                yes:function(){
                    layer.close(index_qx);
                    return false;
                },
                content: $('.set-attendeeForm').html(),//加载该区域的html
                success:function(obj) {
                    table.render(common.tableInitParams({
                        elem: $(obj.selector).find('#attendeeTable'),
                        id:"attendeeTableReload",
                        url: baseUrl+'meetingmgr/tiolAttendee/selectTiolAttendeePage?meetingId='+meetingIdForm+'&participantsType=ATTENDEE',
                        contentType:'text/plain',
                        method:'get',
                        // request:null,
                        // data:qxryData,
                        cellMinWidth: 60,
                        height:'full-300',
                        defaultToolbar:[],
                        cols: [
                            [
                                {type:'checkbox'},
                                {type: 'numbers', title: '序号'},
                                {field: 'attendeeName', title: '出席人',sort:true},
                                {field: 'remark', title: '备注',sort:true}
                            ]
                        ],
                        done:function(){

                        }
                    }));
                }, cancel: function (index, layero) {

                }
            });
            return false;
        })
        //缺席人员查看
        $('#absent-setting').on('click',function(){
            var index_qx=layer.open({
                offset: '10px',
                title:'<i class="iconfont icon-SZYD-xitongcaidanguanli"></i>缺席人员查看',
                // maxmin: false,
                area: ['800px','600px'],//高度自适应
                type: 1,//页面层
                shadeClose: false,
                btn:['<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>关闭'],
                btnAlign:'c',
                yes:function(){
                    layer.close(index_qx);
                    return false;
                },
                content: $('.set-absentForm').html(),//加载该区域的html
                success:function(obj) {
                    table.render(common.tableInitParams({
                        elem: $(obj.selector).find('#absentTable'),
                        id:"absentTableReload",
                        url: baseUrl+'meetingmgr/tiolAttendee/selectTiolAttendeePage?meetingId='+meetingIdForm+'&participantsType=ABSENT',
                        contentType:'text/plain',
                        method:'get',
                        // request:null,
                        // data:qxryData,
                        cellMinWidth: 60,
                        height:'full-300',
                        defaultToolbar:[],
                        cols: [
                            [
                                {type:'checkbox'},
                                {type: 'numbers', title: '序号'},
                                {field: 'attendeeName', title: '缺席人',sort:true},
                                {field: 'reason', title: '缺席原因',sort:true},
                                {field: 'assignor', title: '委托人', sort:true},
                                {field: 'remark', title: '备注',sort:true}
                            ]
                        ],
                        done:function(){

                        }
                    }));
                }
                , cancel: function (index, layero) {

                }
            });
            return false;
        })

        //常设列席查看
        $('#attender-setting').on('click',function(){
            var index_qx=layer.open({
                offset: '10px',
                title:'<i class="iconfont icon-SZYD-xitongcaidanguanli"></i>常设列席查看',
                // maxmin: false,
                area: ['800px','600px'],//高度自适应
                type: 1,//页面层
                shadeClose: false,
                btn:['<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>关闭'],
                btnAlign:'c',
                yes:function(){
                    layer.close(index_qx);
                    return false;
                },
                content: $('.set-attenderForm').html(),//加载该区域的html
                success:function(obj) {
                    table.render(common.tableInitParams({
                        elem: $(obj.selector).find('#attenderTable'),
                        id:"attenderTableReload",
                        url: baseUrl+'meetingmgr/tiolAttender/selectTiolAttenderPage?meetingId='+meetingIdForm,
                        contentType:'text/plain',
                        method:'get',
                        // request:null,
                        // data:qxryData,
                        cellMinWidth: 60,
                        height:'full-300',
                        defaultToolbar:[],
                        cols: [
                            [
                                {type:'checkbox'},
                                {type: 'numbers', title: '序号'},
                                {field: 'attenderSuName', title: '常设列席',sort:true}
                            ]
                        ],
                        done:function(){

                        }
                    }));
                }
            });
            return false;
        })

        table.on('tool(ytList)', function(obj){
            var data = obj.data;
            switch(obj.event){
                case 'edit'://查看
                    yt_index_edit=layer.open({
                        offset: '10px',
                        title:'审议情况',
                        maxmin: false,
                        type: 1,//页面层
                        area: ['100%','600px'],//高度自适应
                        // area: ['580px'],//高度自适应
                        shadeClose: false,
                        btn:['<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>关闭'],
                        btnAlign:'c',
                        yes:function(){
                            layer.close(yt_index_edit);
                        },
                        content: $('#edit-syForm').html(),//加载该区域的html
                        success:function (obj) {
                            form.render();
                            eventHandle.initDict(['exigence','passFlag','subjectType','resultType','position']);
                            var subjectIdForm=data.subjectId;
                            /* common.fetchGet('sysmgr/dicts/selectDictListByPcode?dictPCode=APPROVALFLAG', function (data) {
                            	if (data && data.list && data.list.length > 0) {
                            		gzwFlagList=data.list;
                                      $.map(data.list, function (item) {
                                    	  gzwFlagMap[item.sdCode] = item;
                                      });
                                }
                            }); */
                            /* common.selectDataSet({
                                elem: $('[name=approvalFlag]'),
                                url: 'sysmgr/dicts/selectDictListByPcode?dictPCode=APPROVALFLAG',
                                responseList: 'list',
                                method: 'get',//默认为get
                                optionText: 'sdName',
                                optionValue: 'sdCode',
                                success: function (data) {
                                    if (data && data.list && data.list.length > 0) {
                                        $.map(data.list, function (item) {
                                        	approvalFlagMap[item.sdCode] = item;
                                        });
                                    }
                                    form.render('select');
                                }
                            }); */
                            common.fetchGet('sysmgr/dicts/selectDictListByPcode?dictPCode=attendStatus', function (data) {
                            	if (data && data.list && data.list.length > 0) {
                            		  attendStatusList=data.list;
                                      $.map(data.list, function (item) {
                                          attendStatusMap[item.sdCode] = item;
                                      });
                                }
                            });
                            common.fetchGet('sysmgr/dicts/selectDictListByPcode?dictPCode=DELIBERATIONRESULT', function (data) {
                            	if (data && data.list && data.list.length > 0) {
                            		 deliberationResultList =data.list;
                            		 $.map(data.list, function (item) {
                                    	  deliberationResultMap[item.sdCode] = item;
                                      });
                                }
                            });
                            common.fetchGet('sysmgr/dicts/selectDictListByPcode?dictPCode=reasonCode', function (data) {
                            	if (data && data.list && data.list.length > 0) {
                            		 reasonCodeList =data.list;
                            		 $.map(data.list, function (item) {
                            			 reasonCodeMap[item.sdCode] = item;
                                      });
                                }
                            });
                            common.fetchPost('meetingmgr/tiolSubject/selectTiolSubjectById', {subjectId:data.subjectId}, function (data) {
                                if(data.success){
                                    $(obj.selector).find('input[name=subjectId]').val(data.object.subjectId);
                                    $(obj.selector).find('input[name=subjectName]').val(data.object.subjectName);
                                    $(obj.selector).find('input[name=subjectCode]').val(data.object.subjectCode);
                                    $(obj.selector).find('select[name=exigence]').val(data.object.exigence);
                                    $(obj.selector).find('input[name=exigenceName]').val(data.object.exigenceName);
                                    $(obj.selector).find('select[name=subjectType]').val(data.object.subjectType);
                                    $(obj.selector).find('input[name=subjectTypeName]').val(data.object.subjectTypeName);
                                    $(obj.selector).find('select[name=resultType]').val(data.object.resultType);
                                    $(obj.selector).find('input[name=resultTypeName]').val(data.object.resultTypeName);
                                    // $(obj.selector).find('input[name=approvalFlagName]').val(data.object.approvalFlagName);
                                    $(obj.selector).find('input[name=reporter]').val(data.object.reporter);
                                    $(obj.selector).find('input[name=attendances]').val(data.object.attendances);
                                    $(obj.selector).find('select[name=passFlag]').val(data.object.passFlag);
                                    $(obj.selector).find('textarea[name=subjectResult]').val(data.object.subjectResult);
                                    $(obj.selector).find('input[name=bjqk]').val(data.object.bjqk);
                                    // $(obj.selector).find('select[name=approvalFlag]').val(data.object.approvalFlag);
                                    form.render();
                                }else{
                                    layer.msg("查询会议信息失败:"+data.resultMessage);
                                }
                            }, function () {
                                layer.msg('查询会议信息失败');//失败后提示
                            });
                            table.render(common.tableInitParams({//表决情况表
                                elem:  $(obj.selector).find('#bjTable'),
                                url: baseUrl+'meetingmgr/tiolDeliberation/selectTiolDeliberationPage?subjectId='+data.subjectId,
                                // data:bjTableData,
                                where:{
                                    subjectId:data.subjectId
                                },
                                method:'post',
                                height: 'full-400',
                                defaultToolbar:[],
                                cols: [[
                                {type:'checkbox'},
                                {type: 'numbers', title: '序号',width:80},
                                // {field:'ggSort', title:'序号',width:80},
                                {field:'deliberationPersonnel', title:'姓名'},
                                {field:'job', title:'职务'},
                                {field: 'attendStatus', title: '参会状态',
                                    templet:function (rowData) {
                                        if (rowData['attendStatus']&&attendStatusMap[rowData['attendStatus']]) {
                                            return attendStatusMap[rowData['attendStatus']]['sdName']
                                        } else {
                                            return ''
                                        }
                                    }
                                }
                                ,{field:'reasonCode', title:'缺席原因',
                                    templet:function (rowData) {
                                        if (rowData['reasonCode']&&reasonCodeMap[rowData['reasonCode']]) {
                                            return reasonCodeMap[rowData['reasonCode']]['sdName']
                                        } else {
                                            return ''
                                        }
                                    }
                                }
                                ,{field:'deliberationResult', title:'审议结果',
                                    templet:function (rowData) {
                                        debugger
                                        if (rowData['deliberationResult']&&deliberationResultMap[rowData['deliberationResult']]) {
                                            if(rowData['deliberationResult'] == "同意"){
                                                return '<span class="green">同意</span>'
                                            }else if(rowData['deliberationResult'] == "反对"){
                                                return '<span class="red">反对</span>'
                                            }else{
                                                return '<span class="green3">弃权</span>'
                                            }
                                        } else {
                                            return ''
                                        }
                                    }
                                }
                                ,{field:'remark', title:'备注'},
                                {field: '', title: '操作',toolbar:'#bjTableOper',fixed: 'right'}
                                ]]
                                ,page: true
                            }));

                            table.on('tool(bjTable)', function(obj){
                                var data = obj.data;
                                switch(obj.event){
                                    case 'edit'://查看
                                        bj_index_edit=layer.open({
                                            offset: '10px',
                                            title:'<i class="iconfont icon-SZYD-xitongcaidanguanli"></i>查看表决表单',
                                            maxmin: false,
                                            type: 1,//页面层
                                            area: ['580px'],//高度自适应
                                            shadeClose: false,
                                            btn:['<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>关闭'],
                                            btnAlign:'c',
                                            yes:function(){
                                                layer.close(bj_index_edit);
                                            },
                                            content:$('.bjqk-edit').html(),//加载该区域的html
                                            success:function (obj) {
                                                form.render();
                                                common.selectDataSet({
                                                    elem: $('[name=attendStatus]'),
                                                    loadData: attendStatusList,
                                                    optionText: 'sdName',
                                                    optionValue: 'sdCode'
                                                });
                                                common.selectDataSet({
                                                    elem: $('[name=deliberationResult]'),
                                                    loadData:deliberationResultList,
                                                    optionText: 'sdName',
                                                    optionValue: 'sdCode'
                                                });
                                                common.selectDataSet({
                                                    elem: $('[name=reasonCode]'),
                                                    loadData:reasonCodeList,
                                                    optionText: 'sdName',
                                                    optionValue: 'sdCode'
                                                });
                                                $(obj.selector).find('input[name=deliberationId]').val(data.deliberationId);
                                                $(obj.selector).find('input[name=subjectId]').val(data.subjectId);
                                                $(obj.selector).find('input[name=deliberationPersonnel]').val(data.deliberationPersonnel);
                                                $(obj.selector).find('input[name=job]').val(data.job);
                                                $(obj.selector).find('select[name=attendStatus]').val(data.attendStatus);
                                                $(obj.selector).find('select[name=reasonCode]').val(data.reasonCode);
                                                $(obj.selector).find('select[name=deliberationResult]').val(data.deliberationResult);
                                                $(obj.selector).find('textarea[name=remark]').val(data.remark);
                                                form.render('select');
                                            }
                                        });
                                }
                            });

                            //---------------------议题附件列表star
                            table.render(common.tableInitParams({//议题附件列表
                                elem:  $(obj.selector).find('#subjectFileTable'),
                                url: baseUrl+'dfsmgr/file/getFileByResId?id='+subjectIdForm,
                                method:'post',
                                height: 'full-400',
                                id:'subjectFileTableReload',
                                defaultToolbar:[],
                                cols: [[
                                    {type:'checkbox'},
                                    {type: 'numbers', title: '序号'},
                                    {field: 'fiFileType', title: '资料类型',sort:true,templet:function (rowData) {
                                            var html='';
                                            switch (rowData['fiFileType']) {
                                                case "SUBJECT":html='议题材料';break;
                                                case "OPINION":html='听取意见情况';break;
                                                default:break;
                                            }
                                            return html;
                                    }},
                                    {
                                        field: 'fiName',
                                        title: '文件名称',
                                        minWidth: 150,
                                        sort: true,
                                        templet: function (rowData) {
                                            return rowData.fiName + '.' + rowData.fiSuffix;
                                        }
                                    },
                                    {field: 'fiUploadTime', title: '上传时间',sort:true
                                            ,templet:function (rowData) {return util.toDateString(rowData.effectTime, 'yyyy-MM-dd');
                                    }},
                                    {field: 'ggMemo', title: '备注'},
                                    {field: '', title: '排序', toolbar:'#subjectFileTableOper',fixed: 'right'}
                                ]]
                                ,page: true
                            }));

                            table.on('tool(subjectFileTable)', function(obj){
                                var data = obj.data;
                                switch(obj.event){
                                    case 'load':
                                        var sURL = baseUrl + "dfsmgr/file/filesDownload?fid=" + obj.data.fiId;
                                        window.location.href = sURL;
                                        break;
                                }
                            });
                            //---------------------议题附件列表end
                            $(obj.selector).find('#attendances-btn').on('click',function(){
                                var subjectFrom =$(obj.selector);
                                var subjectId=subjectFrom.find('input[name=subjectId]').val();
                                var index_lx=layer.open({
                                    offset: '10px',
                                    title:'<i class="iconfont icon-SZYD-xitongcaidanguanli"></i>列席人员查看',
                                    // maxmin: false,
                                    area: ['800px','600px'],//高度自适应
                                    type: 1,//页面层
                                    shadeClose: false,
                                    btn:['<i class="icon iconfont icon-button-cha-2" style="margin-right: 3px"></i>关闭'],
                                    btnAlign:'c',
                                    yes:function(){
                                        layer.close(index_lx);
                                        return false;
                                    },
                                    content: $('.set-attendanceForm').html(),//加载该区域的html
                                    success:function(obj) {
                                        table.render(common.tableInitParams({
                                            elem: $(obj.selector).find('#attendanceTable'),
                                            id:"attendanceTableReload",
                                            url: baseUrl+'meetingmgr/tiolAttendance/selectTiolAttendancePage?subjectId='+subjectId,
                                            contentType:'text/plain',
                                            method:'get',
                                            cellMinWidth: 60,
                                            height:'full-300',
                                            defaultToolbar:[],
                                            cols: [
                                                [
                                                    {type:'checkbox'},
                                                    {type: 'numbers', title: '序号'},
                                                    {field: 'attendanceName', title: '列席人',sort:true},
                                                    {field: 'positionName', title: '职位',sort:true}
                                                ]
                                            ],
                                            done:function(){

                                            }
                                        }));
                                    }, cancel: function (index, layero) {

                                    }
                                });

                                return false;
                            });

                            form.render('select');
                        }
                    });
            }
        });

        table.on('tool(meetingFile)', function(obj){
            var data = obj.data;
            switch(obj.event){
                case 'load':
                    var sURL = baseUrl + "dfsmgr/file/filesDownload?fid=" + obj.data.fiId;
                    window.location.href = sURL;
                    break;
            }
        });

        common.buttonLimit($("#currentMenuSmId",window.parent.document).val(),function (res) {
            //输入所有可操作的按钮集合
            var list=res['list']?res['list']:[];

        });
    });

</script>

<!--[if lt IE 9]>
<script src="../../../../js/lib/html5.min.js"></script>
<script src="../../../../js/lib/respond.js"></script>
<![endif]-->
</body>
</html>
